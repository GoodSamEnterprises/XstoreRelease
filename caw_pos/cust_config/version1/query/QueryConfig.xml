<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * CONFIDENTIAL AND PROPRIETARY SOURCE CODE. 
 * 
 * Use and distribution of this code is subject to applicable 
 * licenses and the permission of the code owner.  This notice 
 * does not indicate the actual or intended publication of 
 * this source code.
 * 
 * Portions developed for Camping World by BTM Global Consulting
 * LLC and are the property of Camping World.
 * 
 * ===== BTM Modification ===========================================
 * Req/Bug ID#          ddMMyy    Description
 * INT-020              120417    EMV
 * INT-92               260817    Customer Integration
 * BZ23367              160917    Club# doesn't display on Account tab when searching the customer has memberships number
 * BZ23607              031017    CWS Receipts Requires Printing of Regular and Club Pricing for Items
 * BZ23958              251017    Xstore needs to prompt for membership # when customer joins
 * BZ24381              071117    "Credit card tender is required" prompt is trigger unexpectedly although completing tender by Manual Credit incase choosing "Auto-renew"
 * BZ24498              161117    Club price is not applied to transaction after selling GSC Join in EBS offline
 * BZ24351              201117    Non Good Sam Club members are receiving CLUB pricing incorrectly
 * BZ24651              061217    Membership info under Customer section should be displayed <status> instead of <benefit name>
 * BZ24601              221217    Price of customer is changed from RETL to CLUB unexpectedly when sending catalyst=1 request
 * BZ24937              291217    [Prod Support] Disable line item displaying on pinpad
 * BZ25318              300118    Missing Club information on top banner when sale/return transaction in offlined case.
 * BZ25640              052518    New Requirement - Used Firearm System Process Redesign
 * BZ26453              050618    [Internal] Membership Info of customer does not display at customer search prompt when searching the customer in offline status.
 * BZ26398              070618    Club pricing is displayed on top banner once adding RA join item for transaction in offline case.
 * BZ26270              290618    New Requirement - Display UPC on both Xstore screens and on receipts
 * BZ26207              190718    New Requirement - Enable Work Order Functionality
 * BZ26289              240718    New Requirement - Enable A/R Payment Functionality in Xstore
 * BZ28198              112418    [Oracle patch] xstore freezes for a while on selecting 'add discount' button when discount exclusions exist (Patch 28734729)
 * BZ29625              080419    [New Requirement] - Auto-Renewal Item Specific Receipts
 * BZ31717              240719	  [Prod] Cancelled transactions are successfully proceed in Order Service.
 * BZ33926              260220    [PROD] AR Account was cleaned when search wholesale customer
 * BZ38009              100720    [INTERNAL] Order Cancel must follow existing CW Refund tender Matrix
 * BZ38355              121020    [Internal] Pickup Order - The receipts are printed incorrectly when executing Pickup partial Order
 * BZ38598              301020    [PROD] Membership Activation Issues
 * BZ46879              102720    Xstore Patch 16 Receipt Issues
 * BZ63225              230424    Issue with refunds from Work Order Completes
 *===================================================================
 */ 
-->

<QuerySet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="QueryConfig.xsd">

    <Query name="CRM_CUSTOMER_EBS_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerEBSQueryResult</ResultClass>
        <ResultField name="OrganizationId" type="long" />
        <ResultField name="PartyId" type="Long" />
        <ResultField name="AlternateIdOwner" type="String" />

        <SQL>
            <Statement dtype="String"><![CDATA[
        SELECT p.ORGANIZATION_ID, 
            p.PARTY_ID,
            p.ALTERNATE_ID_OWNER
          FROM CRM_PARTY_ID_XREF p
          WHERE p.ALTERNATE_ID = ?
      ]]></Statement>
            <Parameter name="argAccountNumber" />
        </SQL>
    </Query>
    
    <!-- Start BZ 25318 -->
    <Query name="CUSTOMER_PARTY_ID_XREF_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerPartyIdXrefQueryResult</ResultClass>
        <ResultField name="StringValue" type="String" />
        <SQL>
            <Statement dtype="String"><![CDATA[
        SELECT STRING_VALUE 
        FROM CRM_PARTY_ID_XREF_P
        WHERE ORGANIZATION_ID = ?
           AND PARTY_ID = ?
           AND PROPERTY_CODE = 'PRICING'
      ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argPartyId" />
        </SQL>
    </Query>
    <!-- End BZ 25318 -->
    
    <Query name="CRM_CUSTOMER_LOOKUP_PRIMARY" pmType="CUSTOMER_CRM">
      <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
      <ResultClass dtype="String">dtv.xst.crm.impl.cust.lookup.resp.CustomerQueryResult</ResultClass>
      <ResultField name="OrganizationId" type="long" />
      <ResultField name="Id" type="Long" />
      <ResultField name="CustomerId" type="String" />
      <ResultField name="FirstName" type="String" />
      <ResultField name="LastName" type="String" />
      <ResultField name="Address" type="String" />
      <ResultField name="City" type="String" />
      <ResultField name="State" type="String" />
      <ResultField name="PostalCode" type="String" />
      <ResultField name="County" type="String" />
      <ResultField name="Neighborhood" type="String" />
      <ResultField name="Country" type="String" />
      <ResultField name="OrganizationName" type="String" />
      <ResultField name="Telephone1" type="String" />
      <ResultField name="EmailAddress" type="String" />
     <SQL>
      <Statement dtype="String"><![CDATA[
        SELECT p.organization_id, 
            p.party_id,
            p.cust_id,
            p.first_name,
            p.last_name,
            addr.address1,
            addr.city,
            addr.state,
            addr.postal_code, 
            addr.county, 
            addr.neighborhood,
            addr.country,
            p.organization_name,
            tel.telephone_number,
            eaddr.email_address
          FROM crm_party p
            LEFT OUTER JOIN crm_party_locale_information addr
                 ON p.party_id = addr.party_id
                AND p.organization_id = addr.organization_id
                AND addr.primary_flag = ?
            LEFT OUTER JOIN crm_party_telephone tel
                 ON p.party_id = tel.party_id
                AND p.organization_id = tel.organization_id
                AND tel.primary_flag = 1
            LEFT OUTER JOIN crm_party_email eaddr
                 ON p.party_id = eaddr.party_id
                AND p.organization_id = eaddr.organization_id
                AND eaddr.primary_flag = 1
          WHERE p.organization_id = ?
            AND (p.void_flag IS NULL OR p.void_flag = ?)
            AND (/*UPPER*/ p.party_typcode = 'EMPLOYEE' OR /*UPPER*/ p.party_typcode = 'CUSTOMER')
      ]]></Statement>
      <Parameter name="argPrimaryAddress" />
      <Parameter name="argOrganizationId" />
      <Parameter name="argVoidFlag" />
      <Expression trigger="argAccountNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct acct
             Where acct.organization_id = p.organization_id
               And acct.party_id = p.party_id
               And acct.cust_acct_code = 'ACCOUNTS_RECEIVABLE'
               And acct.cust_acct_id = ?)]]>
      </Expression>
      <Expression trigger="argLoyaltyNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct_card card
             Where card.organization_id = p.organization_id
               And card.party_id = p.party_id
               And card.cust_acct_card_nbr = ?)]]>
      </Expression>
      <Expression trigger="argCustomerId"><![CDATA[EXISTS
          (Select 1 From crm_party_id_xref ix
             Where ix.organization_id = p.organization_id
               And ix.party_id = p.party_id
               And ix.alternate_id = ?)]]>
      </Expression>
      <Expression trigger="argEmployeeId"><![CDATA[/*UPPER*/ p.employee_id = ?]]></Expression>
      <Expression trigger="argStoreNumber"><![CDATA[p.allegiance_rtl_loc_id = ?]]></Expression>
      <Expression parameters="argFirstName%" trigger="argFirstName"><![CDATA[/*UPPER*/ p.first_name like ?]]></Expression>
      <Expression parameters="argLastName%" trigger="argLastName"><![CDATA[/*UPPER*/ p.last_name like ?]]></Expression>
      <Expression parameters="argOrganizationName%" trigger="argOrganizationName"><![CDATA[/*UPPER*/ p.organization_name like ?]]></Expression>
      <Expression parameters="argCity%" trigger="argCity"><![CDATA[/*UPPER*/ addr.city like ?]]></Expression>
      <Expression parameters="argState%" trigger="argState"><![CDATA[/*UPPER*/ addr.state like ?]]></Expression>
      <Expression parameters="argCounty%" trigger="argCounty"><![CDATA[/*UPPER*/ addr.county like ?]]></Expression>
      <Expression parameters="argNeighborhood%" trigger="argNeighborhood"><![CDATA[/*UPPER*/ addr.neighborhood like ?]]></Expression>
      <Expression parameters="argCountry%" trigger="argCountry"><![CDATA[/*UPPER*/ addr.country like ?]]></Expression>
      <Expression parameters="argPostalCode%" trigger="argPostalCode"><![CDATA[/*UPPER*/ addr.postal_code like ?]]></Expression>
      <Expression trigger="argTelephone"><![CDATA[EXISTS
          (Select * From crm_party_telephone ph
             Where ph.organization_id = p.organization_id
               And ph.party_id = p.party_id
               And /*UPPER*/ ph.telephone_number = ?)
      ]]></Expression>
      <Expression parameters="argEmailAddress%" trigger="argEmailAddress"><![CDATA[EXISTS
          (Select * From crm_party_email em
             Where em.organization_id = p.organization_id
               And em.party_id = p.party_id
               And /*UPPER*/ em.email_address like ?)
      ]]></Expression>
      <Expression parameters="argAddress1%" trigger="argAddress1"><![CDATA[EXISTS
          (Select * From crm_party_locale_information pli
             Where pli.organization_id = p.organization_id
               And pli.party_id = p.party_id
               And /*UPPER*/ pli.address1 like ?)
      ]]></Expression>
    </SQL>
    <Property key="ClassName" value="dtv.xst.dao.crm.IParty" />
    <Property key="MaxRows" value="50" />
    <Suffix dtype="String"><![CDATA[ORDER BY p.last_name, p.first_name]]></Suffix>
  </Query>
  <Query name="CRM_CUSTOMER_LOOKUP" pmType="CUSTOMER_CRM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">dtv.xst.crm.impl.cust.lookup.resp.CustomerQueryResult</ResultClass>
    <ResultField name="OrganizationId" type="long" />
    <ResultField name="Id" type="Long" />
    <ResultField name="CustomerId" type="String" />
    <ResultField name="FirstName" type="String" />
    <ResultField name="LastName" type="String" />
    <ResultField name="Address" type="String" />
    <ResultField name="City" type="String" />
    <ResultField name="State" type="String" />
    <ResultField name="PostalCode" type="String" />
    <ResultField name="County" type="String" />
    <ResultField name="Neighborhood" type="String" />
    <ResultField name="Country" type="String" />
    <ResultField name="OrganizationName" type="String" />
    <ResultField name="Telephone1" type="String" />
    <ResultField name="EmailAddress" type="String" />
    <ResultField name="PostalCode" type="String" />
    <ResultField name="Address2" type="String" />
    <ResultField name="Apartment" type="String" />
    <SQL>
      <Statement dtype="String"><![CDATA[
        SELECT p.organization_id, 
            p.party_id,
            p.cust_id,
            p.first_name,
            p.last_name,
            addr.address1,
            addr.city,
            addr.state,
            addr.postal_code, 
            addr.county, 
            addr.neighborhood,
            addr.country,
            p.organization_name,
            tel.telephone_number,
            eaddr.email_address,
            addr.postal_code,
            addr.address2,
            addr.apartment
          FROM crm_party p
            LEFT OUTER JOIN crm_party_locale_information addr
                 ON p.party_id = addr.party_id
                AND p.organization_id = addr.organization_id
            LEFT OUTER JOIN crm_party_telephone tel
                 ON p.party_id = tel.party_id
                AND p.organization_id = tel.organization_id
                AND tel.primary_flag = 1
            LEFT OUTER JOIN crm_party_email eaddr
                 ON p.party_id = eaddr.party_id
                AND p.organization_id = eaddr.organization_id
                AND eaddr.primary_flag = 1
          WHERE p.organization_id = ?
            AND (p.void_flag IS NULL OR p.void_flag = ?)
            AND (/*UPPER*/ p.party_typcode = 'EMPLOYEE' OR /*UPPER*/ p.party_typcode = 'CUSTOMER')
      ]]></Statement>
      <Parameter name="argOrganizationId" />
      <Parameter name="argVoidFlag" />
      <Expression trigger="argAccountNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct acct
             Where acct.organization_id = p.organization_id
               And acct.party_id = p.party_id
               And acct.cust_acct_code = 'ACCOUNTS_RECEIVABLE'
               And acct.cust_acct_id = ?)]]>
      </Expression>
      <Expression trigger="argLoyaltyNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct_card card
             Where card.organization_id = p.organization_id
               And card.party_id = p.party_id
               And card.cust_acct_card_nbr = ?)]]>
      </Expression>
      <Expression trigger="argCustomerId"><![CDATA[EXISTS
          (Select 1 From crm_party_id_xref ix
             Where ix.organization_id = p.organization_id
               And ix.party_id = p.party_id
               And ix.alternate_id = ?)]]>
      </Expression>
      <Expression trigger="argEmployeeId"><![CDATA[/*UPPER*/ p.employee_id = ?]]></Expression>
      <Expression trigger="argStoreNumber"><![CDATA[p.allegiance_rtl_loc_id = ?]]></Expression>
      <Expression parameters="argFirstName%" trigger="argFirstName"><![CDATA[/*UPPER*/ p.first_name like ?]]></Expression>
      <Expression parameters="argLastName%" trigger="argLastName"><![CDATA[/*UPPER*/ p.last_name like ?]]></Expression>
      <Expression parameters="argOrganizationName%" trigger="argOrganizationName"><![CDATA[/*UPPER*/ p.organization_name like ?]]></Expression>
      <Expression parameters="argCity%" trigger="argCity"><![CDATA[/*UPPER*/ addr.city like ?]]></Expression>
      <Expression parameters="argState%" trigger="argState"><![CDATA[/*UPPER*/ addr.state like ?]]></Expression>
      <Expression parameters="argCounty%" trigger="argCounty"><![CDATA[/*UPPER*/ addr.county like ?]]></Expression>
      <Expression parameters="argNeighborhood%" trigger="argNeighborhood"><![CDATA[/*UPPER*/ addr.neighborhood like ?]]></Expression>
      <Expression parameters="argCountry%" trigger="argCountry"><![CDATA[/*UPPER*/ addr.country like ?]]></Expression>
      <Expression parameters="argPostalCode%" trigger="argPostalCode"><![CDATA[/*UPPER*/ addr.postal_code like ?]]></Expression>
      <Expression trigger="argTelephone"><![CDATA[EXISTS
          (Select * From crm_party_telephone ph
             Where ph.organization_id = p.organization_id
               And ph.party_id = p.party_id
               And /*UPPER*/ ph.telephone_number = ?)
      ]]></Expression>
      <Expression parameters="argEmailAddress%" trigger="argEmailAddress"><![CDATA[EXISTS
          (Select * From crm_party_email em
             Where em.organization_id = p.organization_id
               And em.party_id = p.party_id
               And /*UPPER*/ em.email_address like ?)
      ]]></Expression>
      <Expression parameters="argAddress1%" trigger="argAddress1"><![CDATA[EXISTS
          (Select * From crm_party_locale_information pli
             Where pli.organization_id = p.organization_id
               And pli.party_id = p.party_id
               And /*UPPER*/ pli.address1 like ?)
      ]]></Expression>
    </SQL>
    <Property key="ClassName" value="dtv.xst.dao.crm.IParty" />
    <Property key="MaxRows" value="50" />
    <Suffix dtype="String"><![CDATA[ORDER BY p.last_name, p.first_name]]></Suffix>
  </Query>
  <!-- Beign BZ23367 - BZ23958 -->
  <Query name="CRM_CUSTOMER_LOYALTY_EBS_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerLoyaltyQueryResult</ResultClass>
        <ResultField name="OrganizationId" type="long" />
        <ResultField name="PartyId" type="Long" />
        <ResultField name="CustAcctCode" type="String" />
        <ResultField name="CustAcctId" type="String" />
        <ResultField name="CustCardNbr" type="String" />
        <ResultField name="ExpireDate" type="Date" />
        <ResultField name="ProgramName" type="String" />
        <ResultField name="ProgramLevelName" type="String" />
        
        <SQL>
            <Statement dtype="String"><![CDATA[
              SELECT CAT.ORGANIZATION_ID, CAT.PARTY_ID, CAT.CUST_ACCT_CODE, CAT.CUST_ACCT_ID, LOYA.CUST_CARD_NBR, LOYA.EXPIRATION_DATE, LOYA.LOYALTY_PROGRAM_NAME, LOYA.LOYALTY_PROGRAM_LEVEL_NAME
              FROM CAT_CUST_ACCT CAT INNER JOIN CAT_CUST_LOYALTY_ACCT LOYA ON LOYA.CUST_ACCT_ID = CAT.CUST_ACCT_ID
              WHERE CAT.PARTY_ID = ? AND LOYA.CUST_CARD_NBR=?
            ]]></Statement>
            <Parameter name="argPartyId" />
            <Parameter name="argCustCardNumber" />
        </SQL>
    </Query>
  <!-- End BZ23367 - BZ23958-->
    <!-- End BZ23367 - BZ23958-->
    <!-- Begin BZ23958 -->
    <Query name="CRM_CUSTOMER_CARD_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerCardQueryResult</ResultClass>
        <ResultField name="OrganizationId" type="long" />
        <ResultField name="PartyId" type="Long" />
        <ResultField name="CustCardNumber" type="String" />
        <ResultField name="ExpireDate" type="Date" />
        
        <SQL>
            <Statement dtype="String"><![CDATA[
              SELECT ORGANIZATION_ID, PARTY_ID, CUST_ACCT_CARD_NBR, EXPR_DATE
              FROM CAT_CUST_ACCT_CARD
              WHERE ORGANIZATION_ID = ? AND PARTY_ID=?
            ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argPartyId" />
        </SQL>
    </Query>
    <!-- Begin BZ23958 -->
    
    <!-- Beign BZ23607 -->
    <Query name="CRM_GROUP_DESCRIPTION_LOOKUP" pmType="CODES">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">dtv.xst.crm.impl.task.TaskTypeResult</ResultClass>
        <ResultField name="TypeCode" type="String" />
        <ResultField name="TypeCodeDescription" type="String" />
        <ResultField name="SortOrder" type="int" />
        <SQL>
          <Statement dtype="String"><![CDATA[
            SELECT code,
              description,
              sort_order
            FROM com_code_value
            WHERE organization_id = ?
            AND code = ?
          ]]></Statement>
          <Parameter name="argOrganizationId" />
          <Parameter name="argCode" />
        </SQL>
        <Suffix dtype="String"><![CDATA[ORDER BY sort_order ASC]]></Suffix>
    </Query>
    <!-- End BZ23607 -->
    <!-- Begin BZ24381 -->
    <Query name="CAW_CREDIT_DEBIT_TENDER_TYPE" pmType="TRANSACTION">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.advance.prompting.CawCreditDebitCardTenderTypeResults</ResultClass>
        <ResultField name="Tnd_type" type="String" />
        <SQL>
            <Statement dtype="String"><![CDATA[
            SELECT TNDR_ID
             FROM TND_TNDR
             WHERE organization_id = ?
             AND TNDR_TYPCODE = ? 
        ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argCredit" />
        </SQL>
    </Query>
    <!-- End BZ24381 -->
    <!-- Begin BZ24498 -->
    <Query name="CRM_CUSTOMER_CARD_MEMBER_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerCardQueryResult</ResultClass>
        <SQL>
            <Statement dtype="String"><![CDATA[
              SELECT *
              FROM CAT_CUST_ACCT_CARD
              WHERE ORGANIZATION_ID = ? AND CUST_ACCT_CARD_NBR=? AND PARTY_ID=?
            ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argCustAcctCardNbr" />
            <Parameter name="argPartyId" />
        </SQL>
    </Query>
    <!-- End BZ24498 -->
    <!-- Begin BZ24351 -->
    <Query name="CAW_CUSTOMER_GROUP_REMOVE" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <SQL>
          <Statement dtype="String"><![CDATA[
            DELETE from CRM_CUSTOMER_AFFILIATION
            WHERE  PARTY_ID = ?
            ]]></Statement>
          <Parameter name="argPartyId" />
        </SQL>
    </Query>
    <!-- End BZ24351 -->
    <!-- Begin BZ24651 -->
    <Query name="CAW_CAT_CUST_LOYALTY_ACCT_P" pmType="TRANSACTION">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.advance.prompting.CawCatCustLoyalAcctPResults</ResultClass>
        <ResultField name="statusDescription" type="String" />
        <SQL>
            <Statement dtype="String"><![CDATA[
            SELECT STRING_VALUE
             FROM CAT_CUST_LOYALTY_ACCT_P
             WHERE organization_id = ?
             AND CUST_CARD_NBR = ? 
             AND CUST_ACCT_ID = ?
             AND PROPERTY_CODE ='STATUSDESCRIPTION'
        ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argCardNbr" />
            <Parameter name="argCustAcct" />
        </SQL>
    </Query>
    <!-- End BZ24651 -->
    
    <!-- Begin BZ24601 -->
    <Query name="CAW_CAT_CUST_LOYALTY_ACCT_REMOVE" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <SQL>
          <Statement dtype="String"><![CDATA[
            DELETE from CAT_CUST_LOYALTY_ACCT
            WHERE ORGANIZATION_ID = ? AND CUST_CARD_NBR = ?
            ]]></Statement>
          <Parameter name="argOrganizationId" />
          <Parameter name="argCardNumber" />
        </SQL>
    </Query>
    
    <Query name="CAW_CAT_CUST_LOYALTY_ACCT_P_REMOVE" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <SQL>
          <Statement dtype="String"><![CDATA[
            DELETE from CAT_CUST_LOYALTY_ACCT_P
            WHERE ORGANIZATION_ID = ? AND CUST_CARD_NBR = ?
            ]]></Statement>
          <Parameter name="argOrganizationId" />
          <Parameter name="argCardNumber" />
        </SQL>
    </Query>
    
    <Query name="CAW_CAT_CUST_CARD_ACCT_REMOVE" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <SQL>
          <Statement dtype="String"><![CDATA[
            DELETE from CAT_CUST_ACCT_CARD
            WHERE ORGANIZATION_ID = ? AND PARTY_ID = ?
            ]]></Statement>
          <Parameter name="argOrganizationId" />
          <Parameter name="argPartyId" />
        </SQL>
    </Query>
    
    <!-- BEGIN BZ26207,BZ26289, BZ33926: only delete 'LOYALTY' -->
    <Query name="CAW_CAT_CUST_ACCT_REMOVE" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <SQL>
          <Statement dtype="String"><![CDATA[
            DELETE from CAT_CUST_ACCT
            WHERE ORGANIZATION_ID = ? 
              AND PARTY_ID = ? 
              AND CUST_ACCT_CODE IN ('LOYALTY')
            ]]></Statement>
          <Parameter name="argOrganizationId" />
          <Parameter name="argPartyId" />
        </SQL>
    </Query>
    <!-- END BZ26207,BZ26289, BZ33926: only delete 'LOYALTY'-->
    <Query name="CRM_CUSTOMER_LOYALTY_LOOKUP" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawCustomerLoyaltyQueryResult</ResultClass>
        <ResultField name="OrganizationId" type="long" />
        <ResultField name="PartyId" type="Long" />
        <ResultField name="CustAcctCode" type="String" />
        <ResultField name="CustAcctId" type="String" />
        <SQL>
            <Statement dtype="String"><![CDATA[
              select cat.organization_id, cat.party_id, cat.cust_acct_code, cat.cust_acct_id
              from cat_cust_acct cat 
              where cat.party_id = ? AND CUST_ACCT_CODE NOT IN ('WORK_ORDER','HOUSE_ACCOUNT')
            ]]></Statement>
            <Parameter name="argPartyId" />
        </SQL>
    </Query>
    
    <Query name="CAW_CUSTOMER_GROUP_PRICE_LOOKUP" pmType="CUSTOMER_CRM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">caw.pos.customer.CawCustomerGroupQueryResult</ResultClass>
    <SQL>
        <Statement dtype="String"><![CDATA[
          select aff.organization_id, aff.party_id, aff.cust_group_id
          from crm_customer_affiliation aff 
          where aff.organization_id =? and aff.party_id = ?
        ]]></Statement>
        <Parameter name="argOrganizationId" />
        <Parameter name="argPartyId" />
    </SQL>
  </Query>
    <!-- End BZ24601 -->
    
    <!-- Start BZ 24937 -->
    <Query name="ALLOW_DISPLAY_LINEITM_PP_QUERY" pmType="CODES">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">dtv.xst.crm.impl.task.TaskTypeResult</ResultClass>
        <ResultField name="TypeCode" type="String" />
        <ResultField name="TypeCodeDescription" type="String" />
        <ResultField name="SortOrder" type="int" />
        <SQL>
          <Statement dtype="String"><![CDATA[
            SELECT code,
              description,
              sort_order
            FROM com_code_value
            WHERE organization_id = ?
            AND category = 'ALLOW_DISPL_LINEITM_PP'
          ]]></Statement>
          <Parameter name="argOrganizationId" />
        </SQL>
        <Suffix dtype="String"><![CDATA[ORDER BY sort_order ASC]]></Suffix>
    </Query>
    <!-- End BZ 24937 -->
    <Query name="REDEEMED_AWARDS_DISCOUNT">
        <QueryHandler dtype="Class">dtv.data2.access.query.DtxQueryHandler</QueryHandler>
        <ResultClass dtype="String">dtv.xst.dao.dsc.DiscountId</ResultClass>
        <SQL>
          <WhereClause dtype="String"><![CDATA[        
              WHERE organization_id = ?
                AND /*UPPER*/ typcode = ?
                AND /*UPPER*/ app_mthd_code = 'TRANSACTION'        
           ]]></WhereClause>
           <Parameter name="argOrganizationId" />
           <Parameter name="argTypeCode" />
           <Expression trigger="argEffectiveDate"><![CDATA[(effective_datetime IS NULL OR effective_datetime <= ?)]]></Expression>
           <Expression trigger="argExpirationDate"><![CDATA[(expr_datetime IS NULL OR expr_datetime >= ?)]]></Expression>
        </SQL>
        <Suffix dtype="String"><![CDATA[ORDER BY effective_datetime DESC, expr_datetime DESC]]></Suffix>
      </Query>
      
    <!-- Begin BZ25640 -->
    <Query name="SQL_MERCH_HIERARCHY_DESC"  pmType="CODES">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.register.ufa.CawUFAQueryResult</ResultClass>
        <ResultField name="DESCRIPTION" type="String" />
        <SQL>
            <Statement dtype="String"><![CDATA[
        SELECT DESCRIPTION
        FROM ITM_MERCH_HIERARCHY
        WHERE ORGANIZATION_ID = ?
           AND HIERARCHY_ID = ?
      ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argHierId" />
        </SQL>
    </Query>
    <Query name="SQL_UFA_PAID_OUT_TRAN"  pmType="CODES">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.register.ufa.CawUFAQueryResult</ResultClass>
        <ResultField name="VALUE" type="Long" />
        <SQL>
            <Statement dtype="String"><![CDATA[
                SELECT 1 FROM TSN_TNDR_CONTROL_TRANS TNC 
                INNER JOIN TRL_RTRANS_LINEITM_P P ON 
                TNC.TRANS_SEQ = P.TRANS_SEQ AND
                    TNC.RTL_LOC_ID = P.RTL_LOC_ID AND
                    TNC.WKSTN_ID = P.WKSTN_ID AND
                    TNC.BUSINESS_DATE = P.BUSINESS_DATE
                WHERE TNC.TYPCODE='PAID_OUT' 
                AND TNC.REASCODE=? AND TNC.ORGANIZATION_ID=? AND TNC.RTL_LOC_ID=?
                AND ( (P.PROPERTY_CODE='ETRACK_ID' AND P.STRING_VALUE=?)  
                      OR (P.PROPERTY_CODE='EBS_ITEM_CODE' AND P.STRING_VALUE=?) )
      ]]></Statement>
            <Parameter name="argReasonCode" />
            <Parameter name="argOrganizationId" />
            <Parameter name="argStoreId" />
            <Parameter name="argEtrackId" />
            <Parameter name="argEBSItemCode" />
        </SQL>
    </Query>
    
    
    <!-- End BZ25640 -->
    
    <!-- Begin BZ-26453 -->
    <Query name="CAW_CRM_CUSTOMER_LOOKUP_PRIMARY" pmType="CUSTOMER_CRM">
      <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
      <ResultClass dtype="String">caw.pos.customer.CawCustomerQueryResult</ResultClass>
      <ResultField name="OrganizationId" type="long" />
      <ResultField name="Id" type="Long" />
      <ResultField name="CustomerId" type="String" />
      <ResultField name="FirstName" type="String" />
      <ResultField name="LastName" type="String" />
      <ResultField name="Address" type="String" />
      <ResultField name="City" type="String" />
      <ResultField name="State" type="String" />
      <ResultField name="PostalCode" type="String" />
      <ResultField name="County" type="String" />
      <ResultField name="Neighborhood" type="String" />
      <ResultField name="Country" type="String" />
      <ResultField name="OrganizationName" type="String" />
      <ResultField name="Telephone1" type="String" />
      <ResultField name="EmailAddress" type="String" />
      <ResultField name="AccountNumber" type="String" />
      <ResultField name="MembershipStringValue" type="String" />
     <SQL>
      <Statement dtype="String"><![CDATA[
        SELECT p.organization_id, 
            p.party_id,
            p.cust_id,
            p.first_name,
            p.last_name,
            addr.address1,
            addr.city,
            addr.state,
            addr.postal_code, 
            addr.county, 
            addr.neighborhood,
            addr.country,
            p.organization_name,
            tel.telephone_number,
            eaddr.email_address,
            xref.alternate_id as account_number,
            xrefp.string_value as membership_string_value
          FROM crm_party p
            LEFT OUTER JOIN crm_party_locale_information addr
                 ON p.party_id = addr.party_id
                AND p.organization_id = addr.organization_id
                AND addr.primary_flag = ?
            LEFT OUTER JOIN crm_party_telephone tel
                 ON p.party_id = tel.party_id
                AND p.organization_id = tel.organization_id
                AND tel.primary_flag = 1
            LEFT OUTER JOIN crm_party_email eaddr
                 ON p.party_id = eaddr.party_id
                AND p.organization_id = eaddr.organization_id
                AND eaddr.primary_flag = 1
            LEFT OUTER JOIN crm_party_id_xref xref
                ON p.party_id = xref.party_id
                AND p.organization_id = xref.organization_id
                AND xref.alternate_id_owner = 'EBS'
            LEFT OUTER JOIN crm_party_id_xref_p xrefp
                ON p.party_id = xrefp.party_id
                AND p.organization_id = xrefp.organization_id
                AND xrefp.alternate_id_owner = 'EBS'
                AND xrefp.property_code='MEMBERSHIPS'
          WHERE p.organization_id = ?
            AND (p.void_flag IS NULL OR p.void_flag = ?)
            AND (/*UPPER*/ p.party_typcode = 'EMPLOYEE' OR /*UPPER*/ p.party_typcode = 'CUSTOMER')
      ]]></Statement>
      <Parameter name="argPrimaryAddress" />
      <Parameter name="argOrganizationId" />
      <Parameter name="argVoidFlag" />
      <Expression trigger="argAccountNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct acct
             Where acct.organization_id = p.organization_id
               And acct.party_id = p.party_id
               And acct.cust_acct_code = 'ACCOUNTS_RECEIVABLE'
               And acct.cust_acct_id = ?)]]>
      </Expression>
      <Expression trigger="argLoyaltyNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct_card card
             Where card.organization_id = p.organization_id
               And card.party_id = p.party_id
               And card.cust_acct_card_nbr = ?)]]>
      </Expression>
      <Expression trigger="argCustomerId"><![CDATA[EXISTS
          (Select 1 From crm_party_id_xref ix
             Where ix.organization_id = p.organization_id
               And ix.party_id = p.party_id
               And ix.alternate_id = ?)]]>
      </Expression>
      <Expression trigger="argEmployeeId"><![CDATA[/*UPPER*/ p.employee_id = ?]]></Expression>
      <Expression trigger="argStoreNumber"><![CDATA[p.allegiance_rtl_loc_id = ?]]></Expression>
      <Expression parameters="argFirstName%" trigger="argFirstName"><![CDATA[/*UPPER*/ p.first_name like ?]]></Expression>
      <Expression parameters="argLastName%" trigger="argLastName"><![CDATA[/*UPPER*/ p.last_name like ?]]></Expression>
      <Expression parameters="argOrganizationName%" trigger="argOrganizationName"><![CDATA[/*UPPER*/ p.organization_name like ?]]></Expression>
      <Expression parameters="argCity%" trigger="argCity"><![CDATA[/*UPPER*/ addr.city like ?]]></Expression>
      <Expression parameters="argState%" trigger="argState"><![CDATA[/*UPPER*/ addr.state like ?]]></Expression>
      <Expression parameters="argCounty%" trigger="argCounty"><![CDATA[/*UPPER*/ addr.county like ?]]></Expression>
      <Expression parameters="argNeighborhood%" trigger="argNeighborhood"><![CDATA[/*UPPER*/ addr.neighborhood like ?]]></Expression>
      <Expression parameters="argCountry%" trigger="argCountry"><![CDATA[/*UPPER*/ addr.country like ?]]></Expression>
      <Expression parameters="argPostalCode%" trigger="argPostalCode"><![CDATA[/*UPPER*/ addr.postal_code like ?]]></Expression>
      <Expression trigger="argTelephone"><![CDATA[EXISTS
          (Select * From crm_party_telephone ph
             Where ph.organization_id = p.organization_id
               And ph.party_id = p.party_id
               And /*UPPER*/ ph.telephone_number = ?)
      ]]></Expression>
      <Expression parameters="argEmailAddress%" trigger="argEmailAddress"><![CDATA[EXISTS
          (Select * From crm_party_email em
             Where em.organization_id = p.organization_id
               And em.party_id = p.party_id
               And /*UPPER*/ em.email_address like ?)
      ]]></Expression>
      <Expression parameters="argAddress1%" trigger="argAddress1"><![CDATA[EXISTS
          (Select * From crm_party_locale_information pli
             Where pli.organization_id = p.organization_id
               And pli.party_id = p.party_id
               And /*UPPER*/ pli.address1 like ?)
      ]]></Expression>
    </SQL>
    <Property key="ClassName" value="dtv.xst.dao.crm.IParty" />
    <Property key="MaxRows" value="50" />
    <Suffix dtype="String"><![CDATA[ORDER BY p.last_name, p.first_name]]></Suffix>
    </Query>
    
    <Query name="CAW_CRM_CUSTOMER_LOOKUP" pmType="CUSTOMER_CRM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">caw.pos.customer.CawCustomerQueryResult</ResultClass>
    <ResultField name="OrganizationId" type="long" />
    <ResultField name="Id" type="Long" />
    <ResultField name="CustomerId" type="String" />
    <ResultField name="FirstName" type="String" />
    <ResultField name="LastName" type="String" />
    <ResultField name="Address" type="String" />
    <ResultField name="City" type="String" />
    <ResultField name="State" type="String" />
    <ResultField name="PostalCode" type="String" />
    <ResultField name="County" type="String" />
    <ResultField name="Neighborhood" type="String" />
    <ResultField name="Country" type="String" />
    <ResultField name="OrganizationName" type="String" />
    <ResultField name="Telephone1" type="String" />
    <ResultField name="EmailAddress" type="String" />
    <ResultField name="PostalCode" type="String" />
    <ResultField name="Address2" type="String" />
    <ResultField name="Apartment" type="String" />
    <ResultField name="AccountNumber" type="String" />
    <ResultField name="MembershipStringValue" type="String" />
    <SQL>
      <Statement dtype="String"><![CDATA[
        SELECT p.organization_id, 
            p.party_id,
            p.cust_id,
            p.first_name,
            p.last_name,
            addr.address1,
            addr.city,
            addr.state,
            addr.postal_code, 
            addr.county, 
            addr.neighborhood,
            addr.country,
            p.organization_name,
            tel.telephone_number,
            eaddr.email_address,
            addr.postal_code,
            addr.address2,
            addr.apartment,
            xref.alternate_id as account_number,
            xrefp.string_value as membership_string_value
          FROM crm_party p
            LEFT OUTER JOIN crm_party_locale_information addr
                 ON p.party_id = addr.party_id
                AND p.organization_id = addr.organization_id
            LEFT OUTER JOIN crm_party_telephone tel
                 ON p.party_id = tel.party_id
                AND p.organization_id = tel.organization_id
                AND tel.primary_flag = 1
            LEFT OUTER JOIN crm_party_email eaddr
                 ON p.party_id = eaddr.party_id
                AND p.organization_id = eaddr.organization_id
                AND eaddr.primary_flag = 1
            LEFT OUTER JOIN crm_party_id_xref xref
                ON p.party_id = xref.party_id
                AND p.organization_id = xref.organization_id
                AND xref.alternate_id_owner = 'EBS'
            LEFT OUTER JOIN crm_party_id_xref_p xrefp
                ON p.party_id = xrefp.party_id
                AND p.organization_id = xrefp.organization_id
                AND xrefp.alternate_id_owner = 'EBS'
                AND xrefp.property_code='MEMBERSHIPS'
          WHERE p.organization_id = ?
            AND (p.void_flag IS NULL OR p.void_flag = ?)
            AND (/*UPPER*/ p.party_typcode = 'EMPLOYEE' OR /*UPPER*/ p.party_typcode = 'CUSTOMER')
      ]]></Statement>
      <Parameter name="argOrganizationId" />
      <Parameter name="argVoidFlag" />
      <Expression trigger="argAccountNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct acct
             Where acct.organization_id = p.organization_id
               And acct.party_id = p.party_id
               And acct.cust_acct_code = 'ACCOUNTS_RECEIVABLE'
               And acct.cust_acct_id = ?)]]>
      </Expression>
      <Expression trigger="argLoyaltyNumber"><![CDATA[EXISTS
          (Select * From cat_cust_acct_card card
             Where card.organization_id = p.organization_id
               And card.party_id = p.party_id
               And card.cust_acct_card_nbr = ?)]]>
      </Expression>
      <Expression trigger="argCustomerId"><![CDATA[EXISTS
          (Select 1 From crm_party_id_xref ix
             Where ix.organization_id = p.organization_id
               And ix.party_id = p.party_id
               And ix.alternate_id = ?)]]>
      </Expression>
      <Expression trigger="argEmployeeId"><![CDATA[/*UPPER*/ p.employee_id = ?]]></Expression>
      <Expression trigger="argStoreNumber"><![CDATA[p.allegiance_rtl_loc_id = ?]]></Expression>
      <Expression parameters="argFirstName%" trigger="argFirstName"><![CDATA[/*UPPER*/ p.first_name like ?]]></Expression>
      <Expression parameters="argLastName%" trigger="argLastName"><![CDATA[/*UPPER*/ p.last_name like ?]]></Expression>
      <Expression parameters="argOrganizationName%" trigger="argOrganizationName"><![CDATA[/*UPPER*/ p.organization_name like ?]]></Expression>
      <Expression parameters="argCity%" trigger="argCity"><![CDATA[/*UPPER*/ addr.city like ?]]></Expression>
      <Expression parameters="argState%" trigger="argState"><![CDATA[/*UPPER*/ addr.state like ?]]></Expression>
      <Expression parameters="argCounty%" trigger="argCounty"><![CDATA[/*UPPER*/ addr.county like ?]]></Expression>
      <Expression parameters="argNeighborhood%" trigger="argNeighborhood"><![CDATA[/*UPPER*/ addr.neighborhood like ?]]></Expression>
      <Expression parameters="argCountry%" trigger="argCountry"><![CDATA[/*UPPER*/ addr.country like ?]]></Expression>
      <Expression parameters="argPostalCode%" trigger="argPostalCode"><![CDATA[/*UPPER*/ addr.postal_code like ?]]></Expression>
      <Expression trigger="argTelephone"><![CDATA[EXISTS
          (Select * From crm_party_telephone ph
             Where ph.organization_id = p.organization_id
               And ph.party_id = p.party_id
               And /*UPPER*/ ph.telephone_number = ?)
      ]]></Expression>
      <Expression parameters="argEmailAddress%" trigger="argEmailAddress"><![CDATA[EXISTS
          (Select * From crm_party_email em
             Where em.organization_id = p.organization_id
               And em.party_id = p.party_id
               And /*UPPER*/ em.email_address like ?)
      ]]></Expression>
      <Expression parameters="argAddress1%" trigger="argAddress1"><![CDATA[EXISTS
          (Select * From crm_party_locale_information pli
             Where pli.organization_id = p.organization_id
               And pli.party_id = p.party_id
               And /*UPPER*/ pli.address1 like ?)
      ]]></Expression>
    </SQL>
    <Property key="ClassName" value="dtv.xst.dao.crm.IParty" />
    <Property key="MaxRows" value="50" />
    <Suffix dtype="String"><![CDATA[ORDER BY p.last_name, p.first_name]]></Suffix>
    </Query>
     <!-- End BZ-26453 -->
     
     <!-- Begin BZ26398 -->
     <Query name="CAW_CUSTOMER_PARTY_ID_XREF" pmType="CUSTOMER_CRM">
        <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
        <ResultClass dtype="String">caw.pos.customer.CawPartyIdXrefQueryResult</ResultClass>
         <ResultField name="OrganizationId" type="long" />
        <ResultField name="PartyId" type="Long" />
        <ResultField name="AlternateIdOwner" type="String" />
        <ResultField name="PropertyCode" type="String" />
        <ResultField name="Type" type="String" />
        <ResultField name="StringValue" type="String" />
        <ResultField name="DateValue" type="Date" />
        <ResultField name="DecimalValue" type="BigDecimal" />
        <SQL>
            <Statement dtype="String"><![CDATA[
                SELECT organization_id, party_id, alternate_id_owner, property_code
                , type, string_value, date_value, decimal_value 
                FROM crm_party_id_xref_p
                WHERE organization_id = ?
                   and party_id = ?
                   and alternate_id_owner = 'EBS'
            ]]></Statement>
            <Parameter name="argOrganizationId" />
            <Parameter name="argPartyId" />
        </SQL>
    </Query>
     <!-- End BZ26398 -->

    <!-- Begin BZ26270 -->
   <Query name="SQL_MANUFACTURERS_UPC" pmType="ITEM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">dtv.data2.access.DefaultQueryResult</ResultClass>
    <ResultField name="UPC" type="String" />
    <SQL>
      <Statement dtype="String"><![CDATA[
          select manufacturer_upc from itm_item_cross_reference 
          where (organization_id=? and /*UPPER*/ item_id= ? )
          order by primary_flag desc, update_date desc 
        ]]></Statement>
      <Parameter name="argOrganizationId" />
      <Parameter name="argItemId" />
    </SQL>
  </Query>
  <!-- End BZ26270 -->
  
  <!-- Start BZ28198 -->
  <Query name="DISCOUNT_ITEM_INCLUSION_LIST">
    <QueryHandler dtype="Class">dtv.data2.access.query.DtxQueryHandler</QueryHandler>
    <ResultClass dtype="String">dtv.xst.dao.dsc.DiscountItemInclusionsId</ResultClass>
    <SQL>
      <WhereClause dtype="String"><![CDATA[
        WHERE t.organization_id = ? AND /*UPPER*/ t.discount_code = ?
      ]]></WhereClause>
      <Parameter name="argOrganizationId" />
      <Parameter name="argDiscountCode" />
    </SQL>
  </Query>

    <Query name="DISCOUNT_ITEM_EXCLUSION_LIST">
    <QueryHandler dtype="Class">dtv.data2.access.query.DtxQueryHandler</QueryHandler>
    <ResultClass dtype="String">dtv.xst.dao.dsc.DiscountItemExclusionsId</ResultClass>
    <SQL>
      <WhereClause dtype="String"><![CDATA[
        WHERE t.organization_id = ? AND /*UPPER*/ t.discount_code = ?
      ]]></WhereClause>
      <Parameter name="argOrganizationId" />
      <Parameter name="argDiscountCode" />
    </SQL>
  </Query>
  <!-- End BZ28198 -->

  <!-- BEGIN BZ29625 -->
  <Query name="CAW_ITEM_MESSAGES">
   <QueryHandler dtype="Class">dtv.data2.access.query.DtxQueryHandler</QueryHandler>
    <ResultClass dtype="String">dtv.xst.dao.itm.ItemMessageId</ResultClass>
    <SQL>
      <WhereClause dtype="String"><![CDATA[, itm_item_msg_cross_reference cr
          WHERE
            t.organization_id = cr.organization_id AND 
            t.msg_id = cr.msg_id AND 
            t.msg_key = ? AND
            t.organization_id = ? AND 
            t.effective_datetime <= ? AND 
            (t.expr_datetime is null OR t.expr_datetime >= ?) AND 
            (cr.item_id = ?)
      ]]></WhereClause>
      <Parameter name="argMessageKey" />
      <Parameter name="argOrganizationId" />
      <Parameter name="argDate" />
      <Parameter name="argDate" />
      <Parameter name="argItemId" />
    </SQL>
    <Suffix dtype="String"><![CDATA[ORDER BY effective_datetime desc]]></Suffix>
  </Query>
  <!-- END BZ29625 -->

  <!-- BEGIN BZ31717 -->
  
  <Query name="CAT_CUST_CONSUMER_CHARGE_ACCT_REMOVE" pmType="CUSTOMER_CRM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <SQL>
      <Statement dtype="String"><![CDATA[
        DELETE FROM cat_cust_consumer_charge_acct
          WHERE organization_id = ? AND cust_acct_id = ?
      ]]></Statement>
      <Parameter name="argOrganizationId" />
      <Parameter name="argCustAcctId" />
    </SQL>
  </Query>
  <!-- END BZ31717 -->
  
  <!-- BEGIN BZ38355, BZ38009 -->
  <Query name="QUERY_ORDER_MOD" pmType="XCENTER_STANDARD">
	<QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler
	</QueryHandler>
	<ResultClass dtype="String">caw.xst.query.result.CawOrderModQueryResult</ResultClass>
	<ResultField name="OrgId" type="long" />
	<ResultField name="RtlId" type="String" />
	<ResultField name="BDate" type="Date" />
	<ResultField name="WstId" type="String" />
	<ResultField name="TransSeq" type="Long" />
	<ResultField name="TransLineItmSeq" type="Long" />
	<ResultField name="DetailSeq" type="Long" /><!-- BZ46879 -->
	<ResultField name="ItemType" type="String" />
	<SQL>
	  <Statement dtype="String"><![CDATA[  
				  select ORGANIZATION_ID, RTL_LOC_ID, BUSINESS_DATE, WKSTN_ID, TRANS_SEQ, RTRANS_LINEITM_SEQ, DETAIL_SEQ, DETAIL_TYPE from xom_order_mod       
         where ORGANIZATION_ID = ? AND ORDER_ID = ? 
      ]]></Statement>
	  <Parameter name="argOrganizationId" />
	  <Parameter name="argOrderId" />
	  <Expression trigger="argTranslineItmSeq"><![CDATA[RTRANS_LINEITM_SEQ = ?]]></Expression>
    </SQL>
      <Suffix dtype="String"><![CDATA[ORDER BY TRANS_SEQ ASC]]></Suffix>
  </Query>
  <!-- END BZ38009 -->
  
  <Query name="QUERY_ORDERLINE_TAX_ID" pmType="XCENTER_STANDARD">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">caw.xst.query.result.CawOrderlineTaxGroupIdResult</ResultClass>
    <ResultField name="TaxGroupId" type="String" />
    <SQL>
      <Statement dtype="String"><![CDATA[
            select TAX_GROUP_ID from TRL_SALE_LINEITM where ORGANIZATION_ID = ? AND RTL_LOC_ID = ?  AND BUSINESS_DATE = ? AND WKSTN_ID = ? AND TRANS_SEQ = ? AND RTRANS_LINEITM_SEQ = ?
      ]]></Statement>
      <Parameter name="argOrgId" />
      <Parameter name="argRtlId" />
      <Parameter name="argBDate" />
      <Parameter name="argWstId" />
      <Parameter name="argTransSeq" />
      <Parameter name="argTransLineItmSeq" />
    </SQL>
  </Query>
  <!-- END BZ38355 -->

  <!-- Start BZ-38598 -->
  <Query name="PARTY_PROPERTY_REMOVE" pmType="CUSTOMER_CRM">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <SQL>
      <Statement dtype="String"><![CDATA[
        DELETE FROM crm_party_p
          WHERE organization_id = ? AND party_id = ? and PROPERTY_CODE = ?
      ]]></Statement>
      <Parameter name="argOrganizationId" />
      <Parameter name="argPartyId" />
      <Parameter name="argPropertyCode" />
    </SQL>
  </Query>
  <!-- End BZ-38598 -->
  
  <!-- Start BZ63225 -->
  <Query name="QUERY_CHECK_WO_DEPOSIT_TRANS" pmType="XCENTER_STANDARD">
    <QueryHandler dtype="Class">dtv.data2.access.query.SqlQueryHandler</QueryHandler>
    <ResultClass dtype="String">caw.pos.OrderModQueryResult</ResultClass>
	<ResultField name="OrgId" type="long" />
	<ResultField name="RtlId" type="String" />
	<ResultField name="WstId" type="String" />
	<ResultField name="TransSeq" type="Long" />
	<ResultField name="BDate" type="Date" />
    <SQL>
      <Statement dtype="String"><![CDATA[
	SELECT organization_id, rtl_loc_id, wkstn_id, trans_seq, business_date FROM trn_trans_p 
		WHERE property_code = ( SELECT cust_acct_id FROM cat_cust_item_acct_activity 
		WHERE organization_id = ? AND rtl_loc_id = ? AND wkstn_id = ? AND trans_seq = ? and business_date = ? GROUP BY cust_acct_id ) 
		AND string_value IN ( 'DEPOSIT' )
      ]]></Statement>
      <Parameter name="argOrgId" />
      <Parameter name="argRtlId" />
      <Parameter name="argWstId" />
      <Parameter name="argTransSeq" />
      <Parameter name="argBDate" />
    </SQL>
  </Query>
  <!-- End BZ63225  -->

</QuerySet>