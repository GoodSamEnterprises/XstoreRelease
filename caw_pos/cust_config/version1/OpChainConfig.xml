<?xml version="1.0" encoding="UTF-8"?>
<!-- 
/**
 * CONFIDENTIAL AND PROPRIETARY SOURCE CODE. 
 * 
 * Use and distribution of this code is subject to applicable 
 * licenses and the permission of the code owner.  This notice 
 * does not indicate the actual or intended publication of 
 * this source code.
 * 
 * Portions developed for Camping World by BTM Global Consulting
 * LLC and are the property of Camping World.
 * 
 * ===== BTM Modification ===========================================
 * Req/Bug ID#          ddMMyy    Description
 * INT-92               260817    Customer Integration
 * BZ23149              310817    Clock in screen still displays after changing 
 *                                password for Employee on Xstore
 * PAYMENT              070917    Payment-Item Display
 * BZ23147              070917    Implement Serialized coupon
 * BZ23300              11092017  Commissioned Associate screen should be 
 *                                displayed after selecting 'change associate' button
 * EMV                  080917    EMV -Inital.
 * BZ23052              120917    Implement Advanced Prompting
 * BZ23302              130917    Displayed message to inform for customer the maximum of Coupon amount
 * BZ23265              200917    Implement issue "Create Good Sam Visa" card function
 * BZ23469              210917    Remove CREDIT/DEBIT CARD screen after completing a transaction tendered with credit, debit card
 * BZ23458              210917    [DEV] Create a custom flow for "purchase used firearm" that is 
 *                                largely the same as the non-receipted return flow
 * BZ23564              240917    Prompting Engine - Catalyst 1 - Loops indefinitely
 * BZ23339              210917    [DEV] Implement Gift card authorization
 * BZ23359              270917    Gift cards can't be swiped at screen
 * BZ23585              270917    Xstore stuck in a loop when authorization service is offline
 * BZ23541              270917    No request is sent to EBS again when choosing any items associated IsCallbackRequired= true with catalyst =4
 * BZ23615              280917    [Payments] Gift Card Tender Exchange Requirements
 * BZ23263              250917    Implement House Account
 * BZ23406              290917    Implement tender by "Create Good Sam Visa" card function
 * BZ23265              290917    Implement issue "Create Good Sam Visa" card function
 * BZ23646              021017    [prompting advance]The message 'you cannot sell item' should be displayed after pressing 'Y' on Item not on file screen
 * BZ23506              021017    Xstore flashes 2 times in previous screen before going to Tender Options screen
 * BZ23670              021017    should be removed "Purchase of used Firearm" option out of Reason code screen when performing return with receipt transaction
 * BZ23359              021017    Gift cards can't be swiped at screen
 * BZ23356              011017    CWS Will Require a Printed Decline Receipt for EMV Tenders
 * BZ23672              021017    No action when pressing 'Cancel' button on Purchases Used Firearm screen.
 * BZ23657              021017    Processing a Return Prompts for Renewal of GSC However Renewal Item Not Added to Transaction.
 * BZ23535              021017    Not displayed "Enter Merchandise Certificate number" screen when performing sale transaction by Merchandise Certificate tender
 * BZ23576              021017    Manual enter credit card number
 * BZ23356              011017    CWS Will Require a Printed Decline Receipt for EMV Tenders
 * BZ23710              041017    Should remove "purchase of used firearm" option out of reason code screen 
 *                                when performing a return no receipt transaction
 * BZ23603              041017    Allow refund to original Credit and Debit card for Receipt Return transactions
 * BZ23758              051017    "AR account" tender is enable unexpectedly from Tender option list after removing associated customer
 * BZ23725              051017    [Payment] Missing shopping pass authorization information on the sale receipt
 * BZ23359              091017    Gift cards can't be swiped at screen
 * BZ23693              091017    Can't scan Check on device when performing transaction by split tender Cash and Check
 * BZ23563              101017    [Payments] Xstore needs to confirm selected 
 *                                customer before sending command to pin pad for instant credit
 * BZ23933              101017    Missing Credit card number/Authorization/Entry method and signature 
 *                                on receipt when competing transaction with tender new good Sam visa
 * BZ23676              101017    [Tender] The New Good Sam VISA tender option button should only be available on the transaction that the application was approved for.
 * BZ23581              111017    Disable auth calls for Check tenders
 * BZ23943              111017    [Certification] Made Offer should take precedence over all other prompts
 * BZ23982              121017    Registers are constantly frozen and required rebooting
 * BZ23982              131017    Registers are constantly frozen and required rebooting
 * BZ23892              161017    Missing Auth# in receipt when performing return no receipt a reload gift card transaction
 * BZ24029              161017    Please Load Sigcap Images on MX925
 * BZ23951              171017    Customer Search Screen Needs to Include Membership#, Expiration Date
 * BZ23991              171017    Decline receipt is not printed decline receipt when performing a sale transaction and tender by GS Visa Shopping pass is incorrect
 * BZ24051              171017    price of reload GC is displayed incorrectly at return screen when performing return no receipt a Reload GC
 * BZ24105              191017    Should be distinguish Good Sam Visa card and Shopping Pass tender in DB
 * BZ23993              191017    Should be removed coupon discount amount out of transaction when void line tender new good Sam visa
 * BZ24048              181017    "Processing.."bar displays unexpectedly each logging register
 * BZ24072              201017    Gray background Dashboard when selecting View "Third-party" customer
 * BZ24158              231017    Recall the code changed for loading the image to pinpad as the images are loaded from the Eigen portal
 * BZ24153              231017    Error message should be displayed on 'Enter Shopping Pass Number' & Expired date field when pressing 'Next' to by pass GS visa information
 * BZ24098              191017    Missing club pricing/regular price/return price for item when performing transaction 
 *                                with cash tender which total transaction is over $10000.00
 * BZ24173              241017    "Credit card is required" prompt is looping unexpectedly when backing from "Tender option" list
 * BZ24150              251017    [DEV] Serialized Merchandise certificate (coupon) applied to transaction subtotal
 * BZ23958              251017    Xstore needs to prompt for membership # when customer joins 
 * BZ24134              251017    Customer Has Club Pricing Even After Cancelling Order for Membership
 * BZ24217              261017    Receipt should be printed after selecting 'Cancel' on Insert franking instead of displayed Franking error screen.
 * BZ24187              261017    HDE is displayed when pressing "GS Visa Apply Now" button
 * BZ24177              271017    [Tenders] BAD CARD READ displayed when you swipe on Monitor Card Reader for Tender Exchange
 * BZ24219              011117    Club pricing is not applied for customer when assigning to sale screen from Dashboard
 * BZ24324              021117    Membership validation prompt should be distinguish when joining in GS club and GS RS (Roadside assistance)
 * BZ24326              021117    "Credit Card tender is required" prompt should be trigger after fee selected "Auto-renew" joining in GS RA added into sale screen
 * BZ24356              031117    [Advance Prompting] Xstore needs to return to Membership Info prompt after a failed membership validation response
 * BZ24257              061117    [UAT] Register allows the price to be changed - Need to configure this to be turned off - Price overrides are not allowed by CW
 * BZ24385              081117    "Join RA membership#" is not displayed under customer section on receipt after validation this membership successfully
 * BZ24354              081117    [Advance Prompting] Add membership info validation API to all membership types when manually entered in POS
 * BZ24410              091117    [Advance Prompting] POS Sale screen does not display membership number, exp date and pricing for new member joins
 * BZ24414              091117    When Adding New Customer for Warranty Item New 'Logoff' Button Appears
 * BZ24264              091117    Membership info of previous transaction is kept unexpected when doing a new transaction with new customer
 * BZ24463              131117    'HDE' screen is displayed when pressing Sell Gift Card button on Sell-Non Merch screen
 * BZ24402              141117    Can't complete the transaction with Third-party tender.
 * BZ24275              151117    unable to scan sale receipts on scan screen.
 * BZ24537              171117    [Payment] Gift cards do not partial auth, auto decline if there is not enough balance on the card
 * BZ24253              171117    [Returns] Items tendered with a AR or Third Party tender need to be able to return the money to that tender type
 * BZ24605              301117    'HDE' is displayed when doing return unverified transaction.
 * BZ24854              151217    [PROD] Return to GSVS transaction failed in order service with error "Tender.authorization is required for Credit tenders."
 * BZ24594              221217    [Advanced Prompting] Transactions without a customer should prompt with "will save".
 * BZ24877              221217    When Selling Memberships, Store Associates Are Not Prompted for Membership#
 * BZ24945              281217    AR tender is disable on Return tender option screen when performing return transaction by scanning trans on Sell item screen
 * BZ24937              120118    [Prod Support] Disable line item displaying on pinpad
 * BZ23405              160118    [QAS] There are problem when integrate Xstore with QAS service of Camping World
 * BZ25068              220118    New Requirement to Process Web Order Returns
 * BZ25206              240118    "Enter price" prompt displays unexpectedly when returning an item from original transaction after backing from Return Web Order screen
 * BZ25207              240118    Return Tender Options displays incorrectly tender types when refunding Web Order items.
 * BZ25068              220118    New Requirement to Process Web Order Returns
 * BZ25262              261017    Tender types of Return Web Order display incorrectly when pressing Back to access to sale screen.
 * BZ25280              290118    [Xstore] Enter Price prompt is displayed twice for 0600 item for Web Order Returns
 * BZ25488              220218    [PROD][OrderService]Missing Tax Code in Order Service for Membership Items
 * BZ25972              180418    Blank Screen appears when logging off from Serial Exchange function
 * BZ25590              200318    New Requirement - Default price if club pricing does not exist
 * BZ25115              180418    New Requirement - Add a Member Price Override Function to the POS Sale screen
 * BZ25992              180418    [25115] Item voided line is still showed on Sale/Return screen although it removed as before when pressing 'Membership Price Override' button
 * BZ25306              090518    [PROD][OrderService] Orders Have No Line Items
 * BZ25927              140518    [1.4.0] Confirm the added privileges for the EVERYONE ROLE
 * BZ26313              210518    [QAS] Undo change button should be an Esc button.
 * BZ25640              052518    New Requirement - Used Firearm System Process Redesign
 * BZ26432              010618    Should go to Customer Maintenance and accounts screen instead of display error message when pressing 'Back' on Customer search screen in BO
 * BZ26431              040618    [25590] Should be displayed indicating item cannot sold due to no price instead of pulling ($0.01) after removing membership customer
 * BZ26396              050618    Info of customer attached into transaction is changed to new customer info on top panel also receipt when creating a new customer during transaction
 * BZ26500              060618    Xstore allows to complete trans with Third-party tender which customer has belong club pricing once EBS is offline
 * BZ26314              120618    [BZ25115]Member Price Override function is disabled incorrectly in offline mode when same customer is attached for subsequent transaction
 * BZ26575              140618    [QAS] Update address verification flow to reduce the number of click in the QAS process
 * BZ26699              260618    Missing associate name on Sale Item screen when completing Purchase Used Firearm transaction
 * BZ26270              060718    New Requirement - Display UPC on both Xstore screens and on receipts
 * BZ25674              040718    New Requirement - Add security override for employee/crew member sales
 * BZ25958              100718    New Requirement - Remove Gift Card transactions from the Pin Pad
 * BZ26837              160718    System goes to back Register Login instead of Sale screen when pressing ESC at customer Search.
 * BZ25435              160718    New Requirement - Xstore changes to call the CardServices API instead of the Prompting Engine
 * BZ26847              170718    [1.6.0][25958] Reload/Issue Gift card info prints on receipt incorrectly
 * BZ26289              120718    New Requirement - Enable A/R Payment Functionality in Xstore
 * BZ26207              190718    New Requirement - Enable Work Order Functionality
 * BZ26896              260718    [New Requirement] Add security override for Paid Out transaction greater than the configured max
 * BZ26879              310718    [New Requirement] Add reference to Original item on Order Service
 * BZ26629              310718    [New Requirement] Add a prompt to capture discount code when the Retail Coupon discount reason is selected
 * BZ26984              010818    [1.6.2][26289] Cannot make a House Account payment if available balance is 0
 * BZ26972              010818    [1.6.2] Missing item UPC on gift receipt when doing reissues Gift receipt transaction
 * BZ26971              310718    [26289] House account payment transaction is not eligible to be suspended transaction when backing to Sale screen from Tender Option list
 * BZ27005              020818    [1.6.2] Should be displayed deposit amount screen instead of WO Options when selecting 'OK' on Overtender screen
 * BZ27068              080818    [1.6.4] Cannot complete Work Order Refund for the selected Work Order with status: OPEN
 * BZ26978              060818    Gift Card Receipt not printing for activation/reload
 * BZ27146              100818    [WO] The function when clicking on RETRY/ESC at Work Order Missing Items prompt is not correct when lookup the WO has not line items.
 * BZ26851              090818    [PROD] Register displayed an error when trying to print receipt
 * BZ27193              140818    [Updated Requirement] Work Order Complete button must be enabled for both new and deposit work orders from S&I
 * BZ27177              140818    Account# attached into item#98920 displays sometimes incorrectly into House Account screen after entering valid payment amount.
 * BZ27192              150818    WO Obtain the item details (price, tax, description,...) and work order total from Neuron
 * BZ27243              170818    Work Order Deposit shows double the deposit amount when the first tender is declined
 * BZ27245              170818    Work Order Refund must be exclusive and not combined with any other items.
 * BZ27258              200818    [WO][1.6.9] Deposit/Payment and Balance due display incorrectly on receipt when doing WORK ORDER COMPLETE with the WO: OPEN.
 * BZ27256              200818    Extend price doesn't show on WO refund UI as well as receipt.
 * BZ27287              210818    [1.6.11] WO Redirect the WO refund to tender option screen to prevent adding the new items
 * BZ27286              210818    Work Order Deposit - Discount for Elite Customer not coming from S&I
 * BZ27248              210818    Warranty Items from S&I are not associated with the items covered
 * BZ27294              220818    'Issue Store credit' is displayed as refund tender when performing WO complete then remove a line item from WO transaction
 * BZ27264              240818    Work Order Complete Performance Issue
 * BZ27378              280818    [1.6.15] WO Complete the deposited WO doesn't look up the work order from S&I
 * BZ26419              050918    [PROD] Cannot return warranty when the covered item is returned
 * BZ26715              110918    [PROD] Tax Codes not flowing to Oracle
 * BZ27260              130918    [WO]Content of Info tab does not reset as default after exiting WO Search result.
 * BZ27586              170918    [Prod] Transaction Error- Order Service Flow
 * BZ27627              180818    [Xstore] Xstore displays "Please Wait" for about 12 seconds before displaying prompt to enter or swipe gift card
 * BZ27670              210918    [Prod] Options to auto unlock users/Display actual reason for failed log in attempts in Xstore
 * BZ27629              210918    [PROD] Update Order Service to send Gift Card item as GC RELOAD in Tender Exchange
 * BZ26873              011018    [New Requirement] Enable manually entry of Credit Card when doing a return transaction.
 * BZ27339              031018    [New Requirement] Display Membership Information on Xstore POS Information tab
 * BZ27757              100918    [UAT] Selling a gift card from the Non-Merch menu is significantly slow
 * BZ27712              261018    [New Requirement] Order Service is not sending item attributes for Work Orders
 * BZ27344              301018    Pin Pad Performance is slow when item price is updated by a deal/promo or a manual price adjustment
 * BZ26395              211118    Items and buttons are overload on PIN PAD when doing void line New Good Sam Visa tender.
 * BZ28265              261118    New Requirement - Migrate Prompting Engine Catalyst calls to the new PE Services for Xstore 2.1
 * BZ28501              041218    [Internal][2.9.5] Assign&Continue is not enable also changed address is not updated after QAS validation successfully
 * BZ25761              121018    New Requirement - Acquisition of Private Label Credit Card integration in Xstore
 * BZ25762              141218    New Requirement - Credit Account Look up integration in Xstore
 * BZ28902              311218    [Internal] 'Blank error' screen is displayed once doing tender exchange trans in BO
 * BZ29124              280119    [New Requirement] Update Xstore to allow only one PO tender per transaction
 * BZ29157              280119    [Internal]Bundle the fixed issue BZ29138 /BZ29139 on 2.1 into release 3.0: Xstore issue related Work Order
 * BZ29134              290119    [Internal] The Account Lookup flow should be aborted after three failed attempts look up a customer hasn't found in system.
 * BZ27973              140119    New Requirement - PLCC Account Payment
 * BZ28986              130219    [PROD] Deal is not applied to the transaction with a new customer
 * BZ29333              150219    [Internal][PLCC] Edit customer background is kept under Sale Screen after cancel customer verification during doing PLCC
 * BZ29351              150219    [Requirement] PLCC Acquisition - Pin Pad Photo ID Form Placement
 * BZ29372              150219    [Requirement] PLCC Account Lookup - ID Verification Screen new request
 * BZ29302              140219    [Internal] Auto apply discount when first time tender using the new Good Sam Visa
 * BZ29406              180219    [New Requirement] Xstore must send TC70 Payment Request to Eigen for the account payment transaction
 * BZ29383              190219    [Internal] GS Account Inquiry form on the PinPad does not go away after selecting Back/Esc.
 * BZ29443              200219    [Internal][Account Payment]GS Account Payment amount should be validated incase inputting invalid amount.
 * BZ29302              210219    [Internal] Auto apply discount when first time tender using the new Good Sam Visa.
 * BZ29514              220219    Updated Requirement] ADS Feedback: Instant Credit API â€“ the phone number is not being sent. This is a required field.
 * BZ29574              270219    [Internal] Authorized token not used into previous transaction is kept unexpectedly for next transaction.
 * BZ29590              010319    [Internal] PLCC/CO-BRAND-Good Sam Visa should be displayed on receipt instead of Credit/Card when using authorized token tender of Credit application to tender.
 * BZ29683              080319    [INTERNAL] [4.0.1] Review/Evaluate $20 GSVS on the current build
 * BZ29288              250319    [PROD] [2.1] Missing Tax for Product Protection Plan in Order Service
 * BZ29743              260319    [Internal] Modify Tender screen is prompted when there is no tenders to modify.
 * BZ29879              270319    [Prod] Work Order Issues- missing warranty items
 * BZ29884              270319    [Prod] Work Order Issues- warranty item price was changed after import into xstore
 * BZ30084              220419    [Internal] Failed to send /pe/catalyst request due to 'salesPerson' invalid format
 * BZ30314              220419    [Port BZ30262 to Release 4.2.0] OS transaction failed due to token is missing when tender exchange GiftCard with Credit Card
 * BZ29625              180419    [New Requirement] - Auto-Renewal Item Specific Receipts
 * BZ30267              180419    [New_Requirement] CW wants to limit perform Manual Credit entry from Lead to higher roles up.
 * BZ29291              130519    [Internal] Able to bypass manage override for cashier during a sale for a crew member.
 * BZ28271              130519    [3.0] Work Orders with Warranty items show on Flash Sales report after a deposit is made.
 * BZ30269              280519    [New-Requirement] For returns of warranty merchandise, add in the warranty override to this change - prompt for manager override
 * BZ28014              310519    [New Requirement] Xstore needs to allow stackability for/Allow multiple Merchant Certificates in a transaction
 * BZ30154              190619    [New Requirement] Xstore capture the Work Order line items' sale associate from S&I and forward it to Order Service as part of item attribute
 * BZ30922              210619    [New Requirement] Price Check and Inventory Lookup
 * BZ31525              250619    [Port BZ29685 to 5.0]  Associate and Map Coupon Codes to Oracle Order
 * BZ31521              250619    [Port BZ31174 to 5.0] Work Order Tender Screen Flickering
 * BZ31568              250619    [Port BZ31110 to 5.0] [Prod] Xstore charged full WO total amount to the new approved PLCC
 * BZ31759              050719    Inventory Lookup Error Prompt Change
 * BZ27535              090519    [New Requirement] Tax Exempt Wholesale Customer status not recognized at different stores
 * BZ31813              100719    [INTERNAL] Xstore did not displayed as the html code in prompting engines when ESB responded as message
 * BZ32142              250719    [Xstore] Warranty items not pricing correctly when customer added
 * BZ32239              290719    [INTERNAL] Response message return error when return transactin that have serialized coupons
 * BZ32436              090819    [Prod] Order Service send Work Order Refund as Sale Transaction
 * BZ32710              030919    [Prod] Issue with Sales tax on a Return with WO Complete
 * BZ33305              171019    [New Requirement] Need changing about formatting, color, displaying on Current Warranty Plans Screen
 * BZ33231              241019    [New Requirement] Change to "Will Save" prompting method to use Prompting Engine
 * BZ32517              251019    [New Requirement] SKU prompt required prior to swipe gift cards for the refund activation to track inventory.
 * BZ33588              291019    [PROD] Pinpad display does not reset when register auto logs off
 * BZ33586              291019    [New Requirement] Remove customer warranty prompt
 * BZ33894              031219    [New Requirement] Capturing email at end of transaction while assigned customer into transaction
 * BZ34370              201219    [Internal] Unable to scan serial numbers of serialized coupon
 * BZ34226              271219    [New Requirement] Add Warning beeps for any prompt requiring action
 * BZ35053              170220    [Porting the fix from patch 8 to Xstore 6.0] [PROD] Difficulty determining which gift card option to pick without associated item number
 * BZ35513              120320    [NEW REQ] Need option for "No Receipt" as a Receipt Method on Sales Complete screen
 * BZ35326              120320    [PROD] [NEW REQ] Non-credited Wholesale using Credit / AR and 3rd Party Credit mapped to same Tender Type/Trans Code
 * BZ35549              130320    [Defect 35513] No receipt is printed when reprinting the last receipt
 * BZ36405              030620    Issue with Credit Customer placed on credit hold
 * BZ36993              280720    New Requirement-Property Lines for Age Verification From POS
 * BZ37061              280720    Customer Integration between Xstore Order and EBS
 * BZ37110              050820    Modify Xstore to calls Promotion API in Order Transactions
 * BZ37058              120820    [TASK] Enable Order Reject feature for all Xstore roles
 * BZ37179              140820    Remove non-physical items (Deposit, Payment, Shipping Fee) in Order Transactions
 * BZ37340              170820    [INTERNAL] Remove Club Registration screen
 * BZ37467              210820    [INTERNAL] Cancel Order issue in Xstore
 * BZ37109              240820    [Task] Call QAS integration in Delivery Order to verify customer shipping address
 * BZ37023              120820    [Task] Modify Xstore to call ShippingAPI to calculate shipping rate for the Delivery Order
 * BZ37382              270820    [Requirement] Signature capturing for Order Creation/Pickup transactio
 * BZ37305              260820    [New Requirement] Prompting Engine call before customer information gets displayed on the PinPad.
 * BZ37548              100920    [Task] Integrate Order function to Prompting Engine API
 * BZ37750              110920    Cannot close the message box informed Order Management System Offline when selecting Printing Pick List
 * BZ37792              110920    [Internal] Help desk error occurs after selecting Shipping Fee Item to add for Delivery Order
 * BZ37702              110920    [Task] Handling Shipping method/Rate incase Neuron API is down when doing a Delivery-customer
 * BZ37753              160920    [Internal] - HDE screen displays when adding 2nd address for customer
 * BZ38070              240920    UPC needs to print on Order Transaction Receipts per existing CW Functionality
 * BZ37912              021020    Shipping Fee is being applied to the line item vs transaction level
 * BZ37396              051020    Tax value calculation issue in Order transactions
 * BZ38291              061020    [Internal] Disable email triggered by Xstore for order customer notifications outside of transaction receipts.
 * BZ38158              071020    [Task] Need to require email address on orders for Customer Notification
 * BZ38378              121020    [Internal] Create Order - The customer's information did NOT update when executing change it in progress create Order transaction
 * BZ38384              121020    [Internal] Xstore does not make a call Shipping API at Exit Order button when mixing order items firstly then Sale items types.
 * BZ38471              141020    [Internal] Xstore does not call TAX API to calculate again during creating Order Delivery in case mixed order items firstly then Sale items when hit Exit Order button.
 * BZ38980              041120    [TASK] Prompt Engine - Add Item & Price
 * BZ39699              191120    [Task] Porting these fixes of xstore 6.0 patch 10.0/11.0 into Xstore 7.0 patch 1.0
 * BZ38845              271120    [PROD] GSVisa Prescreen Issue
 * BZ40776              290121    [UAT] Duplicate and Missed Order service Messages on order status change in Xstore
 * BZ41379              022221    Requirement - Disabled Mixed Order Transactions in Xstore
 * BZ33319              260221    Good Sam Visa Promo Plan - Phase 2/Deferred Financing
 * BZ41809              110321    Xstore allowed mixed a Verified Return for items purchased on a deferred financing plan with an Unverified Return.
 * BZ41810              110321    Xstore allowed mixed a Verified Return for items purchased on a deferred financing plan with a Blind Return.
 * BZ41382              310321    [Production] Order Service Tender Token Errors
 * BZ42889              110521    [Prod] Order cancellation with pricing turned on, tries to force a return with a refund. The refund should be happening in Oracle.
 * BZ44528              130821    Electric World & Mobile POS Implementation (Phase 1)
 * BZ45962              260821    [Internal] Phase 1 Electric World - Xstore should not send the Product Availability request to OB when changing qty for a kiosk order item
 * BZ46111              111021    [UAT] Electric World Phase 1 Mixed Transaction Return Error
 * BZ44917              110921    [New Requirement] IDS Payment Integration with Xstore
 * BZ42307              200921    [Requirement] Add ability to reject at the item level for BOPIS
 * BZ46798              151021    [Internal] Performing partial reject back to back will force the user to restart Xstore
 * BZ45995              141021    [New requirement] Email capture when good sam membership is sold
 * BZ46879              221021    Xstore Patch 16 Receipt Issues
 * BZ42019              171121    Replace QAS with EAVS2
 * BZ48120              170122    Pinpad shows Thank You message on top of line items after assigning customer during a sale transaction
 * BZ48179              170122    [Requirement] Add ability to reject at the item level for BOPIS
 * BZ48096              190122    [PROD] Order Service Exchange Issue
 * BZ46743              050122    Vehicle Identification Number (VIN) Capture for Xstore
 * BZ47550              050122    [PROD] - OS Error: Coupon code too long
 * BZ47123              050122    [PROD] Order Service Token Error
 * BZ54208              261222    [BTM-280] Production Issue | Applying funds onto gift card without charging
 * BZ57844              030823    Bug 57844 - [Task] Loyalty Phase 2.
 * BZ58779				090723    [Internal][Loyalty] Xstore does not follow the existing process to enroll to GS membership when a free GS membership SKU is auto added.
 * BZ58886              130923    [Internal] Cannot do verify return Sale completed Transaction applied for GS Membership offer.
 * BZ59069              220923    HDE occurs after approval for GS Visa
 * BZ59418              181023    Free Tier Opt In Loyalty SKU customization 
 * BZ59669              301023    [FreeTier short term] Update the membership resend [Catalyst=] call to a membership valdiation call
 * BZ61330              290124    Update tender options for Verified return, Unverified return, web orders and Tender Exchange
 * BZ63225              230424    Issue with refunds from Work Order Completes
 * BZ64483              090924    [PROD] - 502 Error in Xstore log
 * BZ48401              210222    [Task] Apply Reward to Redeem in Sales Transaction
 * BZ61159              190224    [New Requirement] - Xstore AGIS Replacement 
 * BZ62147 				020324    [Internal] - Xstore flashes many times when adding membership items on the Pitches form to transaction.
 * BZ62142              020324    [Internal]- The price of membership item shows incorrectly on the Pitches form and Sale screen.
 * BZ62148				040324    [Internal] - Appear strikethrough on the membership item when voiding.
 * BZ62036              040324    [Task] - Suspend and Resume transaction.
 * BZ62216              030324    [Internal] Information on the Customer Tab is not remove when doing remove item membership
 * BZ62924              020424    [Internal] The verbiage on the Banner Save Story is not updated when doing a Suspended transaction
 * BZ62987              040424    [Internal] The Banner customer and LOGO are displayed incorrectly when assigning a customer has GS Expired
*===================================================================
 */
-->
<OpChainSet xmlns="http://micros.com/xstore/config/opchain"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://com.micros-retail/common OpChainConfig.xsd">

    <OpChain name="CUST_ASSOCIATION" signal="TransactionModified">
        <Op class="caw.pos.customer.CawCustomerSearchOp" required="true" breakpoint="true"> <!-- BZ24048 -->
            <!-- the CustomerSearchOp MUST be the first in the CUST_ASSOCIATION chain
            so that it can see card swipe events that trigger this chain  -->
            <Parameter name="RESULTS_PROMPT" value="CAW.CUSTOMER_LIST_REGISTER" /> <!-- BZ23951 -->
            <Parameter name="PrimaryOnly" value="true" />
            <Parameter name="AddCustomerChain" value="ADD_NEW_CUST_ASSOC" />
            <Parameter name="EditCustomerChain" value="CUST_ASSOCIATION_EDIT" />
        </Op>
        <!-- BEGIN PATCH 18: Comment out the OpChainRoute -->
        <!-- Begin BZ26575 -->
        <!-- 
        <OpChainRoute>
            <Choice chainKey="CAW_ADDRESS_VALIDATION" condition="caw.pos.address.search.CawAddressValidationCondition" />
        </OpChainRoute>
         -->
        <!-- End  BZ26575 -->
        <!-- BEGIN PATCH 18: Comment out the OpChainRoute -->
        
        <OpChainRoute chainKey="CUST_ASSOCIATION.pre" />
        <!-- Begin BZ24098 -->
        <Op class="caw.pos.customer.CawAddCustToTransactionOp" />
        <!-- End BZ24098 -->
        <Op class="dtv.pos.customer.AddCustToTransactionOp" />
        <!-- <OpChainRoute chainKey="CUST_ASSOCIATION.LOYALTY" /> -->
        <Op class="dtv.pos.pricing.discount.ValidateDiscountsOnCustomerChangeOp" />
        <Op class="dtv.pos.register.layaway.account.DelinquentLayawaySearchOp" />
        <Op class="dtv.pos.register.specorder.account.ReceivedSpecOrderSearchOp" />
        <!-- <Op class="dtv.pos.workorder.account.WorkOrderRequiresAttentionOp" />--><!-- BZ29157/BZ29139/BZ28986 Removed OP here. Because it is unnecessary -->
        <!-- This heavy-handed operation really does not belong here. Let's see if
        removing it causes any
        problems. If it does, those problems should be
        fixed at the source and not
        hidden by this operation. -->
        <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
        <OpChainRoute chainKey="CUST_ASSOCIATION.post" />
        <!-- Begin BZ28265 -->
        <!-- <OpChainRoute chainKey="CAW_CARD_SERVICE_SUBMIT" />
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED" /> BZ61159 remove this opponent-->
        <!-- End BZ28265 -->
        <Op class="caw.pos.customer.CawDisplayCustomerVerificationOp"/><!-- BZ37305 -->
        <Op class="caw.pos.common.CawRefreshPinpadScreenOp" /><!-- BZ48120: PinPad clear screen -->
        <OpChainRoute chainKey="CAW_AGIS_PITCHES_FORM" /><!-- BZ61159 -->
    </OpChain>
    
    <!-- Begin BZ23052 -->
    <OpChain name="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED">
        <Op class="caw.pos.advance.prompting.CawProcessCatalystOp" longRunning="true"/>
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_MESSAGE_INPUT" />
        <!-- Begin BZ23564 -->
        <Op class="caw.pos.advance.prompting.CawProcessCatalystIsCallBackOp" longRunning="true"/>
        <!-- End BZ23564 -->
    </OpChain>
    
    <OpChain name="CAW_PROCESS_CATALYST_MESSAGE_INPUT">
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_MESSAGE_REPSONSE"/>
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_INPUT_REPSONSE"/>
    </OpChain>
    
    <OpChain name="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_MESSAGE_REPSONSE" >
        <!-- Begin BZ31813 -->
        <Op class="caw.pos.advance.prompting.CawProcessCatalystMessagePromptHTMLOp" contextKey="INFORMATION_MESSAGE">
          <Parameter name="formKey" value="0" />
        </Op>
        <Op class="caw.pos.advance.prompting.CawProcessCatalystMessagePromptHTMLOp" contextKey="WARNING_MESSAGE">
          <Parameter name="formKey" value="1" />
        </Op>
        <Op class="caw.pos.advance.prompting.CawProcessCatalystMessagePromptHTMLOp" contextKey="CRITICAL_MESSAGE">
          <Parameter name="formKey" value="2" />
        </Op>
        <!-- End BZ31813 -->
    </OpChain>
    
    <OpChain name="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_INPUT_REPSONSE" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <Op class="caw.pos.advance.prompting.CawProcessInputPromptOp" longRunning="true"/>
        <Op class="caw.pos.customer.CawRefreshCustMembershipOp" />
        <Op class="caw.pos.advance.prompting.CawProcessMultiSelectPromptOp" />
    </OpChain>
    
    <OpChain name="CAW_PROCESS_CATALYST_DIRECTIVE_REPSONSE" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <Op class="caw.pos.advance.prompting.CawProcessDirectiveOp" />
        <!-- <OpChainRoute chainKey="CAW_CUSTOMER_VALIDATE_MEMBERSHIP" /> BZ24354 --> <!-- BZ23958 -->
        <!-- <Op class="caw.pos.advance.prompting.CawProcessRemoveItemFailedOp" /> BZ24354 --><!-- BZ24356 -->
        <Op class="caw.pos.advance.prompting.CawProcessDirectivesAddItemOp" longRunning="true"/>
        <Op class="caw.pos.register.CawRemoveCurrentItemValueKeysOp" /><!-- BZ 24463 -->
        <Op class="caw.pos.customer.CawRefreshCustMembershipOp" />
        <!-- <OpChainRoute chainKey="CAW_REFRESH_ITEM_PRICE" /> BZ24354--><!-- BZ 24219 -->
    </OpChain>
  
    <!-- Begin BZ26419 and BZ26715 -->
    <OpChain name="CAW_REFRESH_ITEM_PRICE" signal="TransactionModified">
        <Op class="caw.pos.register.CawGSCRefreshItemPriceOp" longRunning="true"/>
    </OpChain>
    <!-- End BZ26419 and BZ26715 -->
    
    <!-- Tendering related chains -->
	<!-- BEGIN BZ48401 -->
    <OpChain name="PRE_TENDERING">
        <!-- BEGIN BZ61159 -->
        <OpChainRoute>
          <Choice chainKey="CAW_AGIS_PITCHES_CASH_AND_CARRY" condition="caw.pos.agis.op.CawAGISPitchesCashAndCarryConditions" />
          <Choice chainKey="CAW_AGIS_PITCHES_LAST_CHANCE" condition="caw.pos.agis.op.CawAGISPitchesLastChanceConditions" />
        </OpChainRoute>
        <!-- END BZ61159 -->
        <OpChainRoute chainKey="CAW_CALCULATE_ORDER_DELIVERY_TAX" /> <!-- BZ37396 -->
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <ValidationOp validationsBean="cawAttachCustomerToSaleRules" /><!-- BZ25674 -->
        <ValidationOp validationsBean="cawReturnWarrantyItemPrivileges" /><!-- BZ30269 -->
        <PromptOp class="caw.pos.advance.prompting.CawWillSavedAmountPromptOp" /><!-- BZ24594 -->
        <OpChainRoute chainKey="CAW_CARD_SERVICE_STATUS" />
        <!-- BEGIN BZ51471 -->
        <!-- <OpChainRoute chainKey="CAW_APPLY_LOYALTY_PROMOTIONS" condition="caw.pos.cheetah.CawApplyPromoRewardsCondition"/> -->
        <OpChainRoute chainKey="CAW_APPLY_LOYALTY_REWARD" condition="caw.pos.cheetah.CawApplyPromoRewardsCondition" />
        <OpChainRoute chainKey="SIGNAL_TRANSACTION_MODIFIED" /> <!-- BZ52130 -->
        <!-- END BZ51471 -->
        <!-- <OpChainRoute chainKey="CAW_PROCESS_CATALYST_TRANSACTION_TOTAL" /> BZ61159 remove this opponent-->
        <OpChainRoute chainKey="CAW_DISPLAY_GOODSAMVISA_PRESCREEN" />
        <!-- End BZ28265 -->
        <!-- End BZ25435 -->

        <ValidationOp validationsBean="amountDueRules" />
        <ValidationOp class="dtv.pos.register.returns.ValidateBlindReturnsAmountOp" validationsBean="returnBlindAmountRules" />
        <OpChainRoute chainKey="PRE_TENDERING.pre" />
        <OpChainRoute chainKey="CHARITY" />
        <!-- Start 183622 -->
        <Op class="dtv.pos.common.TransactionPropertyPromptOp">
          <Parameter name="TransactionState" value="PRE_TENDER" />
        </Op>
        <!-- End 183622 -->
        <PromptOp class="dtv.pos.util.crypto.NagAboutBadEncryptionOp" />
        <OpChainRoute chainKey="PRE_TENDERING.1" />
        <OpChainRoute chainKey="PRE_TENDERING.2" /> <!-- This additional hook can be helpful for supporting fiscal printers -->
        <OpChainRoute chainKey="PRE_TENDERING.3" />
        <OpChainRoute chainKey="REFUND_ORIG_CREDIT_CARD_TENDER" condition="dtv.pos.tender.check.RefundToOrigCreditCardCondition" />
        <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
        <OpChainRoute chainKey="PRE_TENDERING.post" />
        <!-- <Op class="caw.tenderauth.impl.eigen.op.CawGoodSamVisaPreScreenOp"/> BZ-23265 -->
        <Op class="caw.pos.tender.CawCheckPretenderingOp" /><!-- BZ29743 -->
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
	</OpChain>
	<!-- END BZ48401 -->
  
    <OpChain name="SALE_TENDER" rollbackChainKey="ROLLBACK_TENDER_PROMPT" rollbackLevel="50">
        <OpChainRoute chainKey="CAW_DISPLAY_INFO_TAB_MESSAGE" /><!-- BZ27339 -->
        <!-- this operation REQUIRES this context to be active so
             that if it needs to route a credit card event,
              it will be routed correctly -->
        <Op class="dtv.pos.tender.ProcessSavedTenderInputOp" contextKey="CAW_SALE_TENDER" />
        <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
        <!-- Begin BZ23506 -->
        <Op class="caw.pos.register.CawPromptTenderMenuOp">
          <Parameter name="MenuKey" value="SALE::TENDER_OPTIONS" />
        </Op>
        <!-- End BZ23506 -->
    </OpChain>
    
    <OpChain name="REFUND_TENDER" rollbackChainKey="ROLLBACK_TENDER_PROMPT" rollbackLevel="50">
        <Op class="caw.pos.workorder.payment.CawRefreshDepositAmountDueOp" /><!-- BZ27264 -->
        <!--ContextKey dtype="String">REFUND_TENDER</ContextKey-->
        <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
              <Parameter name="FILENAME" value="_instructionalTenderReturnMsg" />
        </Op>
        <!-- this operation REQUIRES this context to be active so
             that if it needs to route a credit card event,
             it will be routed correctly -->
        <Op class="dtv.pos.tender.ProcessSavedTenderInputOp" contextKey="REFUND_TENDER" />
        <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
        <!-- reasserting for this last op, because it is what gets rerun -->
        <!-- Begin BZ23506 -->
        <Op class="caw.pos.register.CawPromptTenderMenuOp">
          <Parameter name="MenuKey" value="RETURN::TENDER_OPTIONS" />
        </Op>
        <!-- End BZ23506 -->
    </OpChain>
    <OpChain name="CAW_PROCESS_CATALYST_TRANSACTION_TOTAL">
        <Op class="caw.pos.advance.prompting.CawProcessCatalystTransactionTotalOp" longRunning="true"/>
        <!-- <Op class="caw.tenderauth.impl.eigen.op.CawGoodSamVisaPreScreenOp" longRunning="true"/> --><!-- BZ23943/BZ28265 -->
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_MESSAGE_INPUT"/>
        <!-- <OpChainRoute chainKey="CAW_PROCESS_CATALYST_DIRECTIVE_REPSONSE"/> -->
        <!-- Begin BZ23564 -->
        <Op class="caw.pos.advance.prompting.CawProcessCatalystIsCallBackOp" longRunning="true"/>
        <!-- End BZ23564 -->
        <!-- Begin BZ23541 -->
        <PromptOp class="caw.pos.advance.prompting.CawProcessDirectiveVoidTransactionOp"/><!-- BZ23052 -->
        <!-- Begin BZ23958 -->
        <!-- <OpChainRoute chainKey="CAW_CUSTOMER_VALIDATE_MEMBERSHIP" /> BZ24354 -->
        <!-- End BZ23958 -->
        <!-- <Op class="caw.pos.advance.prompting.CawProcessRemoveItemFailedOp" /> BZ24354--> <!-- BZ24356 -->
        <Op class="caw.pos.advance.prompting.CawProcessDirectivesAddItemOp" longRunning="true"/>
        <Op class="caw.pos.advance.prompting.CawProcessDirectiveVoidItemOp" longRunning="true"/>
        <!-- End BZ23541 -->
        <Op class="caw.pos.advance.prompting.CawProcessGSFreeItemValidOp" longRunning="true" /><!-- BZ59669 -->
        <!-- Begin BZ24424 -->
        <Op class="caw.pos.advance.prompting.CawProcessResendCatalyst4Op" longRunning="true"/>
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_MESSAGE_REPSONSE" />
        <!-- End BZ24424 -->
        
        <OpChainRoute chainKey="CAW_ROUND_UP_TRANSACTION" condition="caw.pos.advance.prompting.CawProcessRoundUpTransactionCondition"/> <!-- BZ-38980 -->
    </OpChain>
    
    <!-- Begin BZ-38980 -->
    <OpChain name="CAW_ROUND_UP_TRANSACTION">
        <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED_INPUT_REPSONSE"/>
        <Op class="caw.pos.advance.prompting.CawProcessCatalystIsCallBackOp" longRunning="true"/>
        <Op class="caw.pos.advance.prompting.CawProcessDirectivesAddItemOp" longRunning="true"/>
        <Op class="caw.pos.advance.prompting.CawProcessDirectiveVoidItemOp" longRunning="true"/>
    </OpChain>
    <!-- End BZ-38980 -->
    
    <!-- Begin BZ23958 -->
    <OpChain name="CAW_CUSTOMER_VALIDATE_MEMBERSHIP">
        <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
          <Parameter name="FILENAME" value="_instructionalMembershipValidateMsg" />
        </Op>
        <PromptOp class="caw.pos.advance.prompting.CawProcessActiveJoinGoodSamPromptOp" longRunning="true" />
        <Op class="caw.pos.advance.prompting.CawProcessActiveJoinGoodSamResendOp" longRunning="true"/><!-- BZ24324 -->
        <PromptOp class="caw.pos.advance.prompting.CawProcessNotifyJoinGoodSamPromptOp" longRunning="true" />
        <Op class="caw.pos.advance.prompting.CawProcessSaveJoinGoodSamOp"/> <!-- BZ24385 -->
    </OpChain>
    <!-- End BZ23958 -->
     <OpChain name="CHECK_SALE_COMPLETE">
        <!-- <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CREDIT_CARD_REQUIRED"/> BZ61159 remove this opponent-->
        <Op class="caw.pos.workorder.payment.CawRefreshDepositAmountDueOp" /><!-- BZ27192 -->
        <Op class="caw.pos.register.CawCheckSaleCompleteOp" /> <!-- BZ26207 Work Order Session -->
    </OpChain>
    
    <OpChain name="CAW_PROCESS_CATALYST_CREDIT_CARD_REQUIRED">
        <Op class="caw.pos.advance.prompting.CawProcessDirectiveCreditCardRequired" longRunning="true"/>
    </OpChain>
    <!-- End BZ23052 -->


    <OpChain name="ADD_NEW_CUST_ASSOC" signal="TransactionModified">
        <Op class="caw.pos.customer.CawCreateCustomerOp" breakpoint="true">
            <Parameter name="AddCustomerToTran" value="true" />
        </Op>
    </OpChain>
    
    <!-- Begin BZ23340 -->
    <OpChain name="CREATE_CUSTOMER">
        <!-- Begin BZ26396 -->
        <Op class="dtv.pos.customer.InitializeNewCustomerOp" />
        <OpChainRoute chainKey="CUSTOMER.REVIEW_INFORMATION_CONSENT" />
        <!-- End BZ26396 -->
        <Op class="caw.pos.customer.CawCreateCustomerOp" breakpoint="true">
            <Parameter name="IgnoreCurrentValues" value="true" />
        </Op>
    </OpChain>
    <!-- End BZ23340 -->
     
    <OpChain name="CUSTOMER_MAINTENANCE_EDIT">
        <Op class="caw.pos.customer.CawEditCustomerOp" breakpoint="true" />
    </OpChain>
    <OpChain name="CUST_ASSOCIATION_EDIT">
        <!-- BZ28501 Removed source code here <Op class="caw.pos.customer.membership.CawGetMembershipInfoOp" />--><!-- BZ27339 -->
        <Op class="caw.pos.customer.CawEditCustomerOp" breakpoint="true">
            <Parameter name="AddCustomerToTran" value="true" />
        </Op>
    </OpChain>
    <OpChain name="VIEW_CUSTOMER_IN_TRANSACTION">
        <Op class="caw.pos.customer.CawViewTransactionCustomerOp"
            breakpoint="true" />
    </OpChain>
    <!-- Start Commissioned Associates List Prompt Section -->
    <!-- BEGIN BZ23300 -->
    <OpChain name="COMMISSIONED_ASSOC_LIST">
         <PromptOp class="dtv.pos.commission.PromptCommAssocListOp" /> 
    </OpChain>
    <!-- END BZ23300 -->
    <!-- BEGIN PAYMENT -->
    <OpChain name="INITIALIZE_FACTORIES">
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <Op class="caw.tenderauth.impl.eigen.op.CawInitializeFactoriesOp" />
     </OpChain>
     <!-- END PAYMENT -->
    <OpChain name="VALIDATE_REGISTER_STARTUP">
        <OpChainRoute chainKey="VALIDATE_REGISTER_STARTUP_START.local" />
        <Op class="dtv.pos.assistance.access.ValidateEmployeeRestrictedAccessOp" />
        <Op class="dtv.pos.systemcycle.access.SynchStateJournalOp" />
        <Op class="dtv.pos.systemcycle.access.RetailLocationOpenAccessCheckOp" />
        <Op class="dtv.pos.systemcycle.access.WorkstationOpenAccessCheckOp" />
        <!-- Begin BZ-23149
        <Op class="dtv.pos.timeclock.ValidateNeedToClockInOp" />
        End BZ-23149 -->
        <WorkerOp workersBean="saveSystemTimeWorkers" />
        <PromptOp class="dtv.pos.register.StoreCloseWarningOp" key="WORKSTATION_WARNING" />
        <PromptOp class="dtv.pos.register.StoreCloseGraceOp" key="WORKSTATION_GRACE" />
        <PromptOp class="dtv.pos.register.StoreCloseGraceExpiredOp" key="WORKSTATION_GRACE_EXPIRED" />
        <Op class="dtv.pos.systemcycle.access.EndOfDayTimeCheckOp" />
        <OpChainRoute chainKey="VALIDATE_REGISTER_STARTUP_FINISH.local" />
    </OpChain>
    
    <OpChain name="VALIDATE_REGISTER_STARTUP_REGISTER_OPTION">
        <Op class="dtv.pos.assistance.access.ValidateEmployeeRestrictedAccessOp" />
        <Op class="dtv.pos.systemcycle.access.SynchStateJournalOp" />
        <!-- Begin BZ-23149
        <Op class="dtv.pos.timeclock.ValidateNeedToClockInOp" />
        End BZ-23149 -->
    </OpChain>

    <!-- CAW: Start Coupon Tender -->
    <OpChain name="ADD_BLIND_COUPON_TENDER">
        <PromptOp class="caw.pos.promotion.coupon.CawPromptCouponOp" validationsBean="cawCouponIdRules" />
        <Op class="dtv.pos.coupon.AddCouponOp" />
    </OpChain>
    
    <OpChain name="TENDER_COUPON" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <Op class="dtv.pos.coupon.CreateCouponTenderOp">
            <Parameter name="TenderStatus" value="Tender" />
            <Parameter name="TenderCategory" value="COUPON" />
        </Op>
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="caw.pos.promotion.coupon.CawPromptConfirmCouponAmountOp" /><!-- CAW: BZ 23302 -->
        <PromptOp class="caw.pos.promotion.coupon.CawPromptCouponTenderAmtOp" validationsBean="cawCouponAmountRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
    </OpChain>
    
    <OpChain name="SALE_COMPLETE_FINISH" signal="TransactionComplete">
        <!-- Begin BZ26978 -->
        <Op class="caw.pos.register.CawPrintGiftCardReceiptOp" />
        <!-- End BZ26978 -->
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.pre" />
        <PromptOp class="dtv.pos.coupon.PromptReturnUnusedCouponsToCustomerOp" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.pre.1" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.local" />
        <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ25306 -->
        <!-- Inventory must be processed before the transaction is persisted!! -->
        <!-- <WorkerOp workersBean="saleCompleteInventoryWorkers" /> --> <!-- BZ64483 -->
        <WorkerOp workersBean="completeSaleTransWorkers" />
        <Op class="dtv.pos.common.TransactionPropertyPromptOp">
          <Parameter name="TransactionState" value="POST_TENDER" />
        </Op>
        <Op class="dtv.pos.tender.creditcard.PrepareImprintCreditCardOp" />
        <Op class="dtv.pos.customer.account.op.AddCustomerAccountRcptSourcesOp" />
        <Op class="dtv.pos.register.giftreceipt.GroupGiftReceiptsOp" />
        <Op class="dtv.pos.register.giftreceipt.AddMultipleGiftReceiptsOp" />
        <Op class="dtv.pos.register.giftreceipt.AddGiftRcptSourcesOp" />
        <WorkerOp workersBean="calculateTlogSequenceWorkers" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.1" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.order.1" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.registry.1" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.digitalCart.1" />
        <Op class="dtv.pos.customer.wishlist.op.SellWishListItemsOp" />
        <WorkerOp workersBean="saleCompleteCustomerAccountWorkers" />
        <Op class="dtv.pos.hardware.op.BuildSaleRcptsOp" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.2" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.order.2" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.3" />
        <WorkerOp workersBean="calculateCreditTenderPropertiesWorkers" />
        <WorkerOp workersBean="buildReturnedItemJournalWorkers" />
        <OpChainRoute chainKey="CREATE_WARRANTY_ACTIVITY" />
        <WorkerOp workersBean="updateRainCheckRedemptionStatusWorkers" />
        <Op class="dtv.pos.hardware.op.OpenCashDrawerOp" />
        <WorkerOp workersBean="updateCashDrawerIdWorkers" />
        <WorkerOp workersBean="persistTransAndObjWorkers" />
        <WorkerOp workersBean="persistSystemTotalWorkers" />
        <OpChainRoute chainKey="SALE_COMPLETE_FINISH.FISCAL.AFTER_TRAN_SAVE" />
        <Op class="dtv.pos.customer.view.ClearCustomerMessageViewOp" />
        <WorkerOp workersBean="persistVoucherHistoryWorkers" />
        <!-- Flash sales update sales -->
        <WorkerOp workersBean="populateFlashSalesTablesWorkers" />
        <WorkerOp workersBean="refreshSalesGoalStatusWorkers" />
        <!-- Generate documents -->
        <Op class="dtv.pos.hardware.op.BuildTenderFrankingsOp" />
        <!-- Begin BZ24217 -->
        <Op class="caw.pos.hardware.op.CawFrankTendersOp" />
        <!-- <Op class="dtv.pos.hardware.op.FrankTendersOp" /> -->
        <!-- End BZ24217 -->
        <WorkerOp workersBean="emailRcptsWorkers" />
        <Op class="caw.pos.hardware.op.CawPrintRcptsOp" /> <!-- BZ35513 -->
        <OpChainRoute chainKey="PRINT_DOCUMENTS" />
        <OpChainRoute chainKey="PRINT_WARRANTIES" />
        <WorkerOp workersBean="saveRcptsWorkers" />
        <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
        <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
        <PromptOp class="dtv.pos.hardware.op.DisplayChangeDueOp" validationsBean="cashDrawerCloseRules" breakpoint="true" />
        <Op class="dtv.pos.till.NotifyTenderMaxValueInTillOp" />
        <Op class="dtv.pos.till.NotifyTenderMinValueInTillOp" />
        <OpChainRoute chainKey="RESET_REGISTER" />
        <PromptOp class="dtv.pos.tender.creditcard.PromptImprintCreditCardOp" />
        <PromptOp class="dtv.tenderretail.PromptImprintNonSAFCreditCardOp" />
        <!-- Begin BZ23469 -->
        <!-- <Op class="dtv.pos.tender.creditcard.PromptSignRcptMsgOp" /> -->
        <!-- End BZ23469 -->
        <WorkerOp workersBean="updateSAFQueueWorkers" />
        <Op class="caw.pos.promotion.coupon.CawProcessReserveCouponOp" longRunning="true"/><!-- Reserve coupon after tendering -->
        <!-- Begin BZ24323 -->
        <Op class="caw.pos.promotion.coupon.CawUpdateCouponSerializedNumberOp" longRunning="true"/>
        <!-- End BZ24323 -->
        <!-- Begin BZ24150 -->
        <Op class="caw.pos.promotion.coupon.CawCouponSerializedReserveAndResetOp" longRunning="true"/>
        <!-- End BZ24150 -->
        <!-- Begin BZ-26629 -->
        <!-- <Op class="caw.pos.pricing.discount.CawSaveCouponCodeOp" longRunning="true"/> --><!-- BZ31525 -->
        <!--End BZ-26629 -->
        <Op class="caw.pos.common.CawClearGlobalVariablesOp" /><!-- BZ 24264 -->
        <OpChainRoute chainKey="RESET_AFTER_TRANS" chainType="START" />
      </OpChain>

    <OpChain name="CHANGE_TENDER_AMOUNT" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <PromptOp class="dtv.pos.tender.modifytender.PromptTendersToChangeOp" />
        <!-- Add validationRule to can't change coupon amount -->
        <PromptOp class="dtv.pos.tender.cashsuggestion.CashSuggestionPromptModifyTenderAmountOp" validationsBean="cawCouponAmountRules" />
        <WorkerOp workersBean="voidChangeTenderWorkers" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
    </OpChain>
    
    <OpChain name="CHECK_FOR_CHANGE" signal="TransactionModified">
        <!-- CAW: Don't issue another card if coupon has remaining money -->
        <PromptOp class="caw.pos.promotion.coupon.CawPromptSelectChangeTenderOp" validationsBean="foreignChangeRules" breakpoint="true" />
        <Op class="dtv.pos.tender.rounding.UpdateRoundingOnChangeOp" />
        <OpChainRoute chainKey="ROUTE_CHANGE" condition="dtv.pos.tender.change.TransactionHasChangeDueCondition" />
    </OpChain>
    
    <OpChain name="VOID_TENDER" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <PromptOp class="dtv.pos.tender.modifytender.PromptTendersToVoidOp">
          <Parameter name="disallowNonVoidableTenders" value="true" />
        </PromptOp>
        <!-- <Op class="caw.tenderauth.impl.eigen.op.CawVoidCouponGSVisaOp"/> --> <!-- BZ23993, BZ29302: removed -->
        <OpChainRoute chainKey="GUEST_LOOKUP" />
        <OpChainRoute chainKey="VOID_ROOM_CHARGE" />
        <Op class="dtv.tenderauth.storedvalue.VoidTenderAuthorizationOp">
          <Parameter name="ContinueOnFailure" value="false" />
        </Op>
        <WorkerOp workersBean="updateTenderVoidWorkers" />
        <Op class="caw.tenderauth.impl.eigen.op.CawVoidCouponGSVisaOp"/> <!-- BZ23993, BZ29302 -->
        <Op class="caw.pos.promotion.coupon.CawVoidCouponTenderLineItemOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
    </OpChain>
    
    <OpChain name="POST_VOID_MAIN" signal="TransactionComplete">
        <OpChainRoute chainKey="POST_VOID_MAIN_START.local" />
        <ValidationOp validationsBean="postVoidRules" longRunning="true" />
        <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="POST_VOID_CONFIRM" />
        <PromptOp class="dtv.pos.ejournal.postvoid.PromptExtendedTransactionOp" />
        <PromptOp class="dtv.pos.ejournal.postvoid.PromptPostVoidReasonOp" />
        <Op class="dtv.pos.ejournal.postvoid.ValidateCustAcctTransForVoidOp" />
        <OpChainRoute chainKey="POST_VOID_MAIN.1.local" />
        <Op class="dtv.pos.ejournal.postvoid.CreatePostVoidTransactionOp" />
        <Op class="dtv.pos.ejournal.postvoid.PostVoidCustomerAccountsOp" />
        <OpChainRoute chainKey="POST_VOID_MAIN.2" />
        <OpChainRoute chainKey="POST_VOID_MAIN.2.local" />
        <OpChainRoute chainKey="PRE_POST_VOID_TENDER_AUTH" condition="dtv.pos.ejournal.postvoid.condition.HasReverseTenderAuth" />
        <Op class="dtv.pos.hardware.op.UseIpCashDrawerPostVoidPromptOp" />
        <PromptOp class="dtv.pos.hardware.op.IpCashDrawerPostVoidScanOp" validationsBean="scanIpCashDrawerRules" breakpoint="true" />
        <OpChainRoute chainKey="POST_VOID_BASE" />
        <OpChainRoute chainKey="POST_VOID_SOLD_VOUCHER" condition="dtv.pos.ejournal.postvoid.condition.HasSoldVouchers" />
        <OpChainRoute chainKey="POST_VOID_ISSUED_VOUCHER" condition="dtv.pos.ejournal.postvoid.condition.HasIssuedVouchers" />
        <OpChainRoute chainKey="POST_VOID_BOUNCE_BACK_COUPON" condition="dtv.pos.ejournal.postvoid.condition.HasIssuedBounceBackCoupons" />
        <WorkerOp workersBean="postVoidInventoryWorkers" />
        <OpChainRoute chainKey="POST_VOID_WARRANTY_ACTIVITY" condition="dtv.pos.ejournal.postvoid.condition.HasWarrantyActivities" />
        <OpChainRoute chainKey="PRE_POST_VOID_STORED_VALUE" condition="dtv.pos.ejournal.postvoid.condition.HasStoredValueAuthorizations" />
        <OpChainRoute chainKey="PRE_POST_VOID_AR_PAYMENT" condition="dtv.pos.ejournal.postvoid.condition.HasAccountReceivableAuthorizations" />
        <WorkerOp workersBean="ejBuildReturnedItemJournalWorkers" />
        <Op class="dtv.pos.customer.award.VoidAwardsFromPostVoidTransactionOp" />
        <Op class="dtv.pos.customer.loyalty.VoidLoyaltyPurchaseFromPostVoidTransactionOp">
          <Parameter name="ShowLoyaltyNotification" value="true" />
        </Op>
        <Op class="dtv.pos.coupon.VoidAuthorizeCouponsFromPostVoidTransactionOp" />
        <Op class="caw.pos.promotion.coupon.CawProcessResetCouponOp" /><!-- CAW: send reset request for all used coupons -->
        <Op class="dtv.pos.houseaccount.op.PostVoidChargeAcctHistoryOp" />
        <!-- Start 183574 -->
        <Op class="dtv.pos.hardware.op.OpenCashDrawerForPostVoidsOp" />
        <!-- End 183574 -->
        <WorkerOp workersBean="updateCashDrawerIdWorkers" />
        <WorkerOp workersBean="persistPostVoidWorkers" />
        <Op class="dtv.pos.common.PersistObjectsOp" />
        <Op class="dtv.pos.tender.voucher.PersistVoucherPostVoidHistoryOp" />
        <Op class="dtv.pos.hardware.op.BuildTenderFrankingsOnSelectedTransactionOp" />
        <Op class="dtv.pos.hardware.op.FrankTendersOp" />
        <OpChainRoute chainKey="PRINT_RECEIPTS" />
        <!-- Start 183574 -->
        <PromptOp class="dtv.pos.hardware.op.WaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
        <!-- End 183574 -->
        <!-- Flash sales update for post void  -->
        <!-- Moved this to a chain so it can be easily overriden without having to copy the
          entire post void chain -->
        <OpChainRoute chainKey="POST_VOID_POPULATE_FLASH_SALES" />
        <WorkerOp workersBean="updateSAFQueueForPostVoidsWorkers" />
        <Op class="dtv.pos.common.ClearStationModelOp" />
        <OpChainRoute chainKey="POST_VOID_MAIN_FINISH.local" />
        <WorkerOp workersBean="clearActiveCashDrawerWorkers" />
      </OpChain>
    <!-- CAW: End Coupon Tender -->

      <!-- Begin EMV -->
      <OpChain name="PROMPT_CREDIT_CARD">
        <Op class="caw.tender.impl.mira.op.CawCreditCardInfoOp" validationsBean="creditCardInfoRules" />
      </OpChain>
      <!-- End EMV -->
      
      <!-- START GIFT CARD FLOW -->
    <!-- Active gift card -->
    <OpChain name="SALE_VOUCHER_FINISH">
        <!-- BZ27627 removed CawRefreshMSRDeviceOp and CawCheckIsMCROpChainOp  -->
        <!-- <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberItemRules">
          <Parameter name="LineItemType" value="ITEM" />
        </PromptOp> 
        <PromptOp class="dtv.pos.register.nonphysical.PromptVoucherAmtOp" validationsBean="voucherItemPriceRules" /> BZ25958 removed out -->
        <!-- Begin BZ25958  -->
        <OpChainRoute chainKey="CAW_SALE_XPAY_BALANCE_INQUIRY_MCR" />
        <OpChainRoute>
            <Choice chainKey="CAW_SALE_XPAY_GIFT_CARD_ISSUE" condition="caw.tenderauth.storedvalue.CawGatherVoucherInfoConditionOp" />
            <Choice chainKey="CAW_SALE_XPAY_GIFT_CARD_RELOAD" condition="!caw.tenderauth.storedvalue.CawGatherVoucherInfoConditionOp" />
        </OpChainRoute>
        <!-- End BZ25958  -->
        
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <OpChainRoute chainKey="SALE_VOUCHER_VALIDATE" />
        <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
        <Op class="dtv.pos.register.AddItemToSaleTranOp" />
        <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
        <OpChainRoute chainKey="SIGNAL_TRANSACTION_MODIFIED" />
        <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" />
        <OpChainRoute chainKey="SALE_TAXING" />
        <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
    </OpChain>
    
    <!-- Reload Gift Card using MCR -->
    <OpChain name="SALE_VOUCHER_FINISH_MCR">
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
        <PromptOp class="dtv.pos.tender.voucher.PromptVoucherNumberOp" validationsBean="voucherNumberItemRules">
          <Parameter name="LineItemType" value="ITEM" />
        </PromptOp>
        <PromptOp class="caw.pos.register.nonphysical.CawPromptVoucherAmtOp" validationsBean="voucherItemPriceRules" />
        <Op class="caw.pos.register.nonphysical.CawCreateVoucherSaleLineItemOp">
          <Parameter name="SaleItemType" value="SALE" />
        </Op>
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <OpChainRoute chainKey="SALE_VOUCHER_VALIDATE" />
        <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
        <Op class="dtv.pos.register.AddItemToSaleTranOp" />
        <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
        <OpChainRoute chainKey="SIGNAL_TRANSACTION_MODIFIED" />
        <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" />
        <OpChainRoute chainKey="SALE_TAXING" />
        <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
    </OpChain>
    
    <!-- Issue, Reload gift card -->
    <OpChain name="SALE_VOUCHER_AUTHORIZE">
        <Op class="caw.tenderauth.impl.eigen.op.CawGiftCardAuthorizeOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
    </OpChain>
    
    <!-- Void item gift card -->
    <OpChain name="VOID_ITEM" signal="TransactionModified">
        <OpChainRoute chainKey="VOID_ITEM.pre" />
        <PromptOp class="dtv.pos.pricing.discount.ConfirmGroupDiscountItemVoidOp" key="GROUP_DISCOUNT_ITEM_REMOVE_CONFIRM" />
        <PromptOp class="dtv.pos.register.PromptVoidLineItemReasonCodeOp" />

        <Op class="caw.tenderauth.storedvalue.CawVoidAuthorizationOp">
          <Parameter name="ContinueOnFailure" value="false" />
        </Op>
        <Op class="dtv.tenderauth.impl.op.VoidARAuthorizationOp">
          <Parameter name="ContinueOnFailure" value="false" />
        </Op>
        <WorkerOp workersBean="updateVoidItemWorkers" />
        <Op class="dtv.pos.pricing.discount.VoidGroupDiscountOp">
          <Parameter name="ChainKey" value="VOID_DISCOUNT_MAIN" />
        </Op>
        <Op class="caw.pos.register.returns.CawUpdateVoidVerifiedReturnItemOp" /> <!-- BZ63225 -->
        <Op class="dtv.pos.customer.award.AutoVoidAwardDiscountsOp" />
        <Op class="caw.pos.cheetah.CawRevertLoyaltyFlagForFreeGS" /> <!-- BZ59418 -->
        <OpChainRoute chainKey="UNASSIGN_LOYALTY_SALE" />
        <Op class="caw.pos.agis.op.CawAGISPitchesUpdateModelOp"/>
        <Op class="caw.pos.agis.op.CawAGISPitchesRemoveMembershipItemPitchesOp" /> <!-- BZ62216 -->
        <OpChainRoute chainKey="CAW_AGIS_REVERT_PRICE" condition="caw.pos.agis.op.CawAGISVoidItemUpdateRunCondition"/><!-- BZ61159 -->
        <!-- <OpChainRoute chainKey="VOID_ITEM.post" /> -->
    </OpChain>
    
    <!-- BEGIN BZ61159 -->
    <OpChain name="CAW_AGIS_REVERT_PRICE" signal="TransactionModified">
    	<Op class="caw.pos.agis.op.CawAGISCustomerGroupUpdateOp"/>
    	<Op class="caw.pos.customer.CawRefreshCustMembershipOp"/>
    	<Op class="caw.pos.register.sale.CawMemberPriceOverrideVoidLinesOp" /><!-- BZ25992 -->
    	<Op class="caw.pos.register.sale.CawMemberPriceOverrideRefreshUnitPriceOp" />
    	<Op class="caw.pos.register.sale.CawMemberPriceOverrideVoidPriceOp" />
    	<Op class="caw.pos.register.sale.CawMemberPriceOverrideUnVoidPriceOp" />
    	<!-- BZ26431: check and remove no regular price item(s) after un-used Member Price Override -->
    	<PromptOp class="caw.pos.register.sale.CawRemoveNoRegularPriceItem" />
    	<!-- End BZ26431-->
    </OpChain>
    <!-- END BZ61159 -->
    
    <!-- Gift card Balance Inquiry -->
    <OpChain name="XPAY_BALANCE_INQUIRY">
        <Op class="caw.pos.util.CawCheckIsNotMCROpChainOp" />
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="INQUIRE_BALANCE" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <PromptOp class="dtv.tenderauth.storedvalue.PromptVoucherForBalanceOp" key="GIFT_CARD_SERIAL_NEEDED_BALANCE" validationsBean="voucherNumberRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" />
        <Op class="caw.tenderauth.storedvalue.CawAuthorizeBalanceOp" />
        <PromptOp class="caw.tenderauth.storedvalue.CawDisplayBalanceOp" />
        <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
        <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
        <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
        <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
<!--         <Op class="caw.tenderauth.impl.verifone.op.CawCloseSessionForGCOnlyOp" /> --><!-- BZ 23501 -->
      </OpChain>
      
      <!-- Balance Inquiry using MCR, not use PinPad -->
      <OpChain name="XPAY_BALANCE_INQUIRY_MCR">
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="INQUIRE_BALANCE" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <PromptOp class="dtv.tenderauth.storedvalue.PromptVoucherForBalanceOp" key="GIFT_CARD_SERIAL_NEEDED_BALANCE" validationsBean="voucherNumberRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" />
        <Op class="caw.tenderauth.storedvalue.CawAuthorizeBalanceWithoutLoginOp" />
        <PromptOp class="caw.tenderauth.storedvalue.CawDisplayBalanceOp" />
        <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
        <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
        <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
        <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
      </OpChain>
      
      <!-- Cancel sale gift card transaction -->
      <OpChain name="CANCEL_STORED_VALUE">
        <OpChainRoute chainKey="CANCEL_STORED_VALUE.pre" />
        <Op class="caw.tenderauth.storedvalue.CawVoidAuthorizationOp">
          <Parameter name="ContinueOnFailure" value="false" />
        </Op>
      </OpChain>
      
      <!-- Post void gift card transaction -->
      <OpChain name="POST_VOID_STORED_VALUE">
        <Op class="caw.tenderauth.storedvalue.CawVoidAuthorizationOp">
          <Parameter name="ContinueOnFailure" value="false" />
        </Op>
      </OpChain>
      
      <!-- Tender, Refund with gift card -->
      <OpChain name="STANDARD_TENDER_VOUCHER" signal="TransactionModified">
        <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp" />
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberTenderRules">
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <Op class="dtv.pos.tender.voucher.CreateVoucherTenderLineItemOp" />
        <ValidationOp validationsBean="tenderAvailabilityRules" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherTenderAmtOp" validationsBean="cawVoucherTenderAmountRules" />
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <Op class="caw.pos.util.CawCheckIsNotMCROpChainOp" />
        <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" /><!-- BZ26978 -->
        <OpChainRoute chainKey="CAPTURE_SALE_TENDER_SIGNATURE" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
      </OpChain>
      
      <!-- Tender, Refund with gift card using MCR-->
      <OpChain name="STANDARD_TENDER_VOUCHER_MCR" signal="TransactionModified">
        <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp" /> <!-- BZ25958: moved here -->
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
<!--         <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp" /> BZ25958: removed out -->
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberTenderRules"><!-- BZ26978 -->
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <Op class="dtv.pos.tender.voucher.CreateVoucherTenderLineItemOp" />
        <ValidationOp validationsBean="tenderAvailabilityRules" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherTenderAmtOp" validationsBean="cawVoucherTenderAmountRules" />
<!--         <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" /> -->
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        
        <!-- Begin BZ27344 -->
        <Op class="caw.tenderauth.impl.eigen.op.CawClearPinpadItemModelQueueOp" />
        <!-- End BZ27344 -->
        
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" /><!-- BZ26978 -->
        <OpChainRoute chainKey="CAPTURE_SALE_TENDER_SIGNATURE" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
      </OpChain>
      
      <!-- Back office Tender exchange gift card -->
      <OpChain name="STANDARD_INCOMING_TENDER_EXCHANGE_VOUCHER_TENDER">
        <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp">
          <Parameter name="TenderStatus" value="Tender" />
          <Parameter name="VoucherActivityCodeType" value="REDEEMED" />
        </Op>
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberTenderRules">
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <Op class="caw.pos.tender.voucher.CawCreateVoucherTenderLineItemOp" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="dtv.pos.tender.exchange.PromptIncomingVoucherTenderExchangeAmtOp" validationsBean="tenderExchangeIncomingAmountRules" />
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <Op class="caw.tenderauth.storedvalue.CawTenderExchangeAuthorizeCardOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
        <PromptOp class="dtv.pos.tender.exchange.PromptWhetherMoreIncomingTendersOp" />
      </OpChain>
      
      <OpChain name="OUTGOING_TENDER_EXCHANGE_VOUCHER_TENDER">
        <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp">
          <Parameter name="TenderStatus" value="Change" />
          <Parameter name="VoucherActivityCodeType" value="ISSUED" />
        </Op>
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberItemRules"> <!-- BZ28902 -->
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <Op class="caw.pos.tender.voucher.CawCreateVoucherTenderLineItemOp" />
        <Op class="caw.pos.tender.validation.CawIsTenderExchangeAuthorize" /> <!-- BZ27629 -->
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="dtv.pos.tender.exchange.PromptOutgoingVoucherTenderExchangeAmtOp" key="ENTER_VOUCHER_AMOUNT" validationsBean="tenderExchangeOutgoingAmountRules" />
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <Op class="caw.pos.util.CawCheckIsNotMCROpChainOp" />
        <Op class="caw.tenderauth.storedvalue.CawTenderExchangeAuthorizeCardOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
      </OpChain>
      
      <!-- Back office Tender exchange gift card using MCR-->
      <OpChain name="OUTGOING_TENDER_EXCHANGE_VOUCHER_TENDER_MCR">
        <!-- <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp">
          <Parameter name="TenderStatus" value="Change" />
          <Parameter name="VoucherActivityCodeType" value="ISSUED" />
        </Op> -->
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <PromptOp class="dtv.pos.tender.voucher.PromptVoucherNumberOp">
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <Op class="caw.pos.tender.voucher.CawCreateVoucherTenderLineItemOp" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="dtv.pos.tender.exchange.PromptOutgoingVoucherTenderExchangeAmtOp" key="ENTER_VOUCHER_AMOUNT" validationsBean="tenderExchangeOutgoingAmountRules" />
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
        <Op class="caw.tenderauth.storedvalue.CawTenderExchangeAuthorizeCardOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
      </OpChain>
      
      <!-- CASH OUT in Return flows -->
      <OpChain name="VOUCHER_RETURN_FROM_ITEM.base">
        <Op class="dtv.pos.register.nonphysical.GatherVoucherSaleItemInfoOp">
          <Parameter name="VoucherActivityCodeType" value="CASHOUT" />
        </Op>
<!--         <PromptOp class="dtv.pos.register.nonphysical.PromptReturnVoucherAmtOp" validationsBean="itemPriceRules" /> -->
        <PromptOp class="dtv.pos.tender.voucher.PromptVoucherNumberOp" validationsBean="returnVoucherNumberItemRules">
          <Parameter name="LineItemType" value="ITEM" />
        </PromptOp>
        <Op class="dtv.pos.register.nonphysical.CreateVoucherSaleLineItemOp">
          <Parameter name="SaleItemType" value="RETURN" />
        </Op>
        <ValidationOp class="dtv.pos.register.returns.ValidateTotalReturnPriceNewItemOp" validationsBean="returnNewItemPriceRules" />
        <Op class="dtv.pos.register.returns.verification.CompleteUnverifiedBlindReturnOp" />
        <OpChainRoute chainKey="RETURN_VOUCHER_FINISH" chainType="START" />
      </OpChain>
      
      <!-- CASH OUT in Return flows -->
      <OpChain name="RETURN_VOUCHER_AUTHORIZE">
        <!-- apply any pending prompted amount -->
        <Op class="dtv.pos.register.VoidAllDiscountsOp" />
        <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
        <Op class="caw.tenderauth.storedvalue.CawRefundCashOutAuthorizeCardOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <!-- same op after the authorization in case was authorized for a different amount -->
        <PromptOp class="dtv.pos.register.nonphysical.PromptReturnVoucherAmtOp" validationsBean="itemPriceRules" />
        <Op class="dtv.pos.register.VoidAllDiscountsOp" />
        <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
      </OpChain>
      
      <!-- CASH OUT in Return flows -->
      <OpChain name="CAW_NOTIFY_CASHOUT_MSG_OP">
        <Op class="caw.tenderauth.storedvalue.CawRefundCashOutDisplayPromptOp" /><!-- BZ 24051 -->
      </OpChain>
      
      <OpChain name="MENU_TRAVERSAL_FORWARD">
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <Op class="dtv.pos.framework.op.ForceMenuSelectionOp" breakpoint="true" />
      </OpChain>
      
      <OpChain name="BACK_OFFICE_MAIN_MENU" contextKey="BACK_OFFICE_MAIN_MENU" rollbackLevel="10" rollbackChainKey="EXIT_BACK_OFFICE">
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <OpChainRoute chainKey="UPDATE_PROMPTS_ROLLBACK" condition="dtv.pos.register.condition.RegisterNotInTrainingModeRunCondition" />
        <Op class="dtv.pos.security.op.StopAutoLogoutTimerOp" />
        <Op class="dtv.pos.framework.op.DoNothingOp" contextKey="BACK_OFFICE_MAIN_MENU" breakpoint="true" />
      </OpChain>
      <!-- END GIFT CARD AUTHORIZATION FLOWS -->
      
    <!-- Begin BZ-23265, 23563 , BZ25761-->
    <OpChain name="CAW_GOOD_SAM_CREDIT">
        <!-- <PromptOp class="caw.tenderauth.impl.eigen.op.CawConfirmCustomerInfoErrorPromptOp"/> --><!-- BZ24187 -->
        <Op class="caw.pos.common.CawRefreshPinpadScreenOp" /> <!-- BZ29383 -->
        <Op class="caw.pos.customer.checkinginfo.CawCheckingPhoneNumberOp" /> <!-- BZ29514 -->
        <PromptOp class="caw.tenderauth.impl.eigen.goodsam.op.CawConfirmCustomerInfoPromptOp" longRunning="true" /><!-- BZ 23563 -->
        <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamInstantApplyOp" longRunning="true" /> <!-- BZ25761 -->
    </OpChain>
    <!-- End BZ-23265, 23563, BZ25761 -->
    
    <!-- Begin BZ23458, BZ23670, BZ23710 -->
    <!-- Pre-start purchase used firearm -->
    <OpChain name="PURCHASE_USED_FIREARM">
        <Op class="caw.pos.register.returns.CawSetPurchaseUsedFirearm" />
        <OpChainRoute chainKey="NEW_RETURN" chainType="START"/>
    </OpChain>
    
    <OpChain name="RETURN_ITEM_START" contextKey="RETURN" rollbackChainKey="BACKTO_SALE_ITEM" rollbackLevel="20">
        <!-- <Op class="caw.pos.register.returns.CawClearReturnWebOrdersOp"/> --><!-- BZ25206, BZ25262 -->
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <!-- Begin BZ23657 -->
        <Op class="caw.pos.advance.prompting.CawProcessDirectivesAddItemOp" longRunning="true"/>
        <!-- End BZ23657 -->
        <PromptOp class="caw.pos.register.returns.CawPromptReturnWithReceiptOp" /> <!-- If the purchase used firearm, go straight return no receipt.-->
       
    </OpChain>
    
    <OpChain name="RETURN_INFORMATION_CHAIN">
        <OpChainRoute chainKey="RETURN_INFORMATION_CHAIN.local.pre" />
        <PromptOp class="dtv.pos.kits.returns.PromptReturnKitOp" />
        <!-- BEGIN 41810 -->
        <PromptOp class="caw.pos.register.returns.CawDeferFinancialValidationOp">
          <Parameter name="TransType" value="RETURN" />
        </PromptOp>
        <!-- END 41810 -->
        <PromptOp class="caw.pos.register.returns.CawPromptReturnReasonCodeOp" /> <!-- Prompt only Purchase Used Firearm reason if item return is PUF. -->
        <Op class="dtv.pos.register.returns.CreateInventoryLocationModifierOp" />
        <PromptOp class="dtv.pos.register.returns.PromptScanGiftRcptPriceOp" validationsBean="encodedItemPriceRules" />
        <PromptOp class="dtv.pos.register.returns.PromptReturnItemPriceOp" validationsBean="returnItemPriceValRules" />
        <Op class="dtv.pos.register.returns.UseCurrentItemPriceOp" />
        <PromptOp class="dtv.pos.register.returns.PromptReturnPriceHistoryOp" />
        <PromptOp class="caw.pos.register.returns.CawSkipPromptLowestReturnPriceInfoOp" />
        <Op class="caw.pos.register.returns.CawRouteReturnPriceOverrideOp" />
        <Op class="dtv.pos.register.returns.GetPriceHistoryPriceByRuleOp" />
        <ValidationOp class="dtv.pos.register.returns.ValidateTotalReturnPriceNewItemOp" validationsBean="returnNewItemPriceRules" />
    </OpChain>
    
    <OpChain name="SALE_ITEM_START" contextKey="SALE" rollbackChainKey="ROLLBACK_TRANS_PROMPT" rollbackLevel="10">
        <Op class="caw.pos.hardware.op.CawDisableMSRDeviceOp" /><!-- BZ 24177 -->
        <Op class="caw.pos.workorder.payment.CawRefreshDepositAmountDueOp" /> <!-- BZ27256 -->
        <Op class="caw.pos.customer.CawIsBackCustSearchFormOp" /><!-- BZ 24414 -->
        <Op class="caw.pos.register.returns.CawClearPurchaseUsedFirearmOp" />
        <Op class="caw.pos.register.returns.CawReturnWebOrdersDisplayButtonOp" /><!-- BZ25207  -->
        <!-- Begin BZ23052 -->
        <!-- <OpChainRoute chainKey="CAW_PROCESS_CATALYST_DIRECTIVE_REPSONSE"/> BZ61159 remove this opponent--> 
        <!-- End BZ23052 -->
        <OpChainRoute chainKey="CAW_DISPLAY_INFO_TAB_MESSAGE" /><!-- BZ27339 -->
        <Op class="dtv.pos.hardware.op.ItemCustDisplayOp" />
        <PromptOp class="caw.pos.register.sale.CawPromptItemScanOp" validationsBean="itemIdRules" contextKey="SALE" breakpoint="true" /><!-- BZ-24275 -->
        <ValidationOp class="dtv.pos.coupon.LookupCouponFromItemIdOp" validationsBean="couponVerificationRules" />
        <Op class="dtv.pos.document.bounceback.op.LookupBounceBackCouponOp" />
        <ValidationOp class="caw.pos.register.sale.CawCheckItemNotOnFileOp" validationsBean="itemNotOnFileRules" /> <!-- BZ34226-->
        <ValidationOp validationsBean="sellingIdGroupRules" />
        <PromptOp class="caw.pos.register.returns.CawDeferFinancialValidationOp" >
          <Parameter name="TransType" value="SALE" />
        </PromptOp><!-- BZ33319 -->
        <OpChainRoute chainKey="SALE_ITEM_AFTER_LOOKUP" />
    </OpChain>
    
    <OpChain name="RETURN_BLIND_ITEM">
        <OpChainRoute chainKey="RETURN_ITEM_ID_VALIDATE" />
        <PromptOp class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
        <PromptOp class="caw.pos.register.returns.customerhistory.CawSkipPromptReturnTransByHistoryOp" />
        <Op class="dtv.pos.register.returns.verification.CompleteUnverifiedBlindReturnOp" />
        <Op class="dtv.pos.kits.CreateKitOp" />
         <Op class="dtv.pos.register.KitComponentIteratingOp">
          <Parameter name="ChainKey" value="UNVERIFIED_RETURN_KIT_COMPONENT_SERIAL_NUMBER" />
        </Op>
        <OpChainRoute chainKey="RETURN_INFORMATION_CHAIN" />
        <Op class="dtv.pos.kits.inventory.HandleKitComponentInventoryOp" />
        <Op class="dtv.pos.register.returns.prorate.CalculateProratedReturnPriceOp" />
        <OpChainRoute chainKey="ADD_RETURN_ITEM_TO_TRAN" />
        <PromptOp class="dtv.pos.register.attacheditems.PromptAttachedItemsOp" />
        <Op class="dtv.pos.register.attacheditems.AttachedItemsIteratingOp">
          <Parameter name="chainKey" value="RETURN_BLIND_ITEM" />
        </Op>
        <OpChainRoute chainKey="NOTIFY_ATTACHED_ITEMS" />
        <OpChainRoute chainKey="RETURN_ATTACHED_WARRANTY" />
        <Op class="caw.pos.register.returns.CawCreateWebOrderPropertiesLineItemOp" /><!-- BZ 25068 -->
    </OpChain>
    
  <!-- BEGIN BZ46111 -->
  <OpChain name="VIEW_ORIGINAL_TRANSACTION" >
    <PromptOp class="caw.pos.register.returns.verification.CawVerifiedReturnItemListSelectionOp" breakpoint="true" validationsBean="returnListSelectionRules"/> <!-- BZ34226 -->
    <PromptOp class="caw.pos.register.returns.CawDeferFinancialValidationOp" >
      <Parameter name="TransType" value="RETURN" />
    </PromptOp><!-- BZ33319 -->
    <PromptOp class="caw.pos.register.returns.CawPromptVerifiedReturnReasonCodeOp" /> <!-- BZ23670 -->
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /> <!-- BZ32710 -->
    <Op class="caw.pos.register.CawAddMembershipScanReturnOp" /><!-- BZ 24945 -->
    <Op class="dtv.pos.register.returns.verification.VerifiedReturnIteratingOp">
      <Parameter name="ChainKey" value="VERIFIED_RETURN_ITEM_IMPL.pre" />
    </Op>
    <OpChainRoute chainKey="VALIDATE_WO_DEPOSIT" condition="caw.pos.workorder.condition.CawWorkOrderReturnSearchRunCondition" /> <!-- BZ63225 -->
  </OpChain>
  <!-- END BZ46111 -->
    
    <OpChain name="RETURN_VOUCHER_FINISH" signal="TransactionModified">
        <PromptOp class="caw.pos.register.returns.CawPromptReturnReasonCodeOp" /> <!-- BZ23710 -->
        <OpChainRoute chainKey="ADD_RETURN_ITEM_TO_TRAN" />
        <OpChainRoute chainKey="RETURN_VOUCHER_AUTHORIZE.pre" />
    </OpChain>
    
    <OpChain name="RETURN_WARRANTY_FINISH" signal="TransactionModified">
        <PromptOp class="caw.pos.register.returns.CawPromptReturnReasonCodeOp" /> <!-- BZ23710 -->
        <OpChainRoute chainKey="ADD_RETURN_ITEM_TO_TRAN" />
        <OpChainRoute chainKey="RETURN_WARRANTY_SETUP" />
        <OpChainRoute chainKey="ADD_WARRANTIES" />
        <OpChainRoute chainKey="UPDATE_WARRANTIES" />
    </OpChain>
    
    <OpChain name="RETURN_NON_PHYSICAL_FINISH" signal="TransactionModified">
        <PromptOp class="caw.pos.register.returns.CawPromptReturnReasonCodeOp" /> <!-- BZ23710 -->
        <OpChainRoute chainKey="ADD_RETURN_ITEM_TO_TRAN" />
    </OpChain>
    <!-- End BZ23458, BZ23670, BZ23710 -->
    
    <!-- Begin BZ-23356 -->
    <OpChain name="TENDER_CREDIT_CARD" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <!-- <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawApplyGSDealOp" /> --> <!-- BZ29302, BZ29743: removed -->
        <!-- <Op class="dtv.pos.tender.CreateTenderLineItemOp"> --> <!-- Replaced by BZ31568 -->
        <Op class="caw.pos.tender.CawCreateTenderLineItemOp"> <!-- BZ31568 -->
          <Parameter name="TenderStatus" value="Tender" />
          <Parameter name="TenderCategory" value="CREDIT_CARD" />
        </Op>
        <OpChainRoute chainKey="TENDER_CREDIT_CARD.pre" />
        <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
        <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
        <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
        <!-- <PromptOp class="caw.pos.tender.CawCreditCardPromptTenderAmtOp" validationsBean="tenderAmountRules" /> --> <!-- BZ29683, BZ29743: removed -->
        <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="tenderAmountRules" /><!-- BZ29743 -->
        <!-- Begin BZ27344 
        When tender with credit we will clear all element in Queue. 
        It mean the Pinpad not add more items.
        -->
        <Op class="caw.tenderauth.impl.eigen.op.CawClearPinpadItemModelQueueOp" />
        <!-- End BZ27344 -->
        
        <Op class="dtv.tenderauth.impl.op.BINSmartLookupOp" />
        <ValidationOp validationsBean="creditPaymentAccountRules" />
        <!-- after PromptCreditDebitOp and CustomerPromptCreditDebitOp we should
             always have a tender ID on the tender line item
        may want to validate how the card was keyed/swiped here -->
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <ValidationOp validationsBean="tenderAvailabilityRules" />
        <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
          <Parameter name="tenderId" value="PRIVATE_LABEL" />
        </PromptOp>
        <PromptOp class="dtv.pos.tender.cid.PromptCidOp" validationsBean="cidRules" />
        <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <PromptOp class="dtv.pos.tender.PromptPostalCodeOp" validationsBean="postalCodeRules" />
        <Op class="caw.tenderauth.impl.eigen.op.CawAuthorizeTenderOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <OpChainRoute chainKey="CAPTURE_SALE_TENDER_SIGNATURE" />
        <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
        <Op class="caw.pos.advance.prompting.CawSetCreditCardRequiredOp" /> <!-- BZ23977 -->
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
      </OpChain>
  <!-- End BZ-23356 -->
  
  <!-- START BZ 23615 -->
  <OpChain name="REFUND_CREDIT_CARD_TENDER_EXCHANGE" signal="TransactionModified">
    <Op class="caw.pos.tender.CawCreateTenderLineItemOp">   <!-- BZ30314 -->
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderCategory" value="CREDIT_CARD" />
    </Op>
    <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
    <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
    <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
    <ValidationOp validationsBean="tenderAvailabilityRules" />
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
      <Parameter name="tenderId" value="PRIVATE_LABEL" />
    </PromptOp>
    <PromptOp class="dtv.pos.tender.exchange.PromptOutgoingTenderExchangeAmountOp" validationsBean="tenderExchangeOutgoingAmountRules"/>

    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
<!--     <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" /> -->
    <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
  </OpChain>
  
  <OpChain name="REFUND_MANUAL_CREDIT_CARD_TENDER_EXCHANGE" signal="TransactionModified">
    <Op class="caw.pos.tender.CawCreateTenderLineItemOp">   <!-- BZ30314 -->
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderCategory" value="CREDIT_CARD" />
    </Op>
    <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
    <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
    <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
    <ValidationOp validationsBean="tenderAvailabilityRules" />
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
      <Parameter name="tenderId" value="PRIVATE_LABEL" />
    </PromptOp>
    <PromptOp class="dtv.pos.tender.exchange.PromptOutgoingTenderExchangeAmountOp" validationsBean="tenderExchangeOutgoingAmountRules"/>
    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="caw.pos.tender.creditcard.CawIsManualInputCreditDebitOp" />
    <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
<!--     <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" /> -->
    <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
  </OpChain>
  <!-- END BZ 23615 -->
  
  <!-- Begin BZ23263 -->
    <OpChain name="TENDER_AR_ACCOUNT" signal="TransactionModified"
        contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <PromptOp class="caw.pos.araccount.validation.CawValidateMultiARThirdPartyTenderOp"/><!-- BZ29124 -->
        <Op class="dtv.pos.tender.CreateTenderLineItemOp">
            <Parameter name="TenderStatus" value="Tender" />
            <Parameter name="TenderId" value="AR_ACCOUNT" />
        </Op>
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <ValidationOp validationsBean="houseAccountAvailableRules" />
        <PromptOp
            class="dtv.pos.houseaccount.op.PromptNoHouseAccountCustAssignedOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <Op class="caw.pos.araccount.CawPromptTenderPurchaseOrderOp" />
        <OpChainRoute chainKey="CAW_TENDER_AMOUNT_OP" />
        <Op class="dtv.pos.houseaccount.op.UpdateARTenderAcctNumberOp" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE"
            chainType="START" />
    </OpChain>
    <OpChain name="CAW_PROMPT_AR_WARNING_OP">
        <PromptOp class="caw.pos.araccount.CawPromptArWarning" />
    </OpChain>
    <!-- Begin BZ24402 -->
    <OpChain name="CAW_TENDER_AMOUNT_OP">
        <PromptOp class="caw.pos.araccount.CawPromptTenderAmtOp"
            validationsBean="tenderAmountARTPRules" />
    </OpChain>
    <!-- End BZ24402 -->
    <!-- CAW: End AR Tender -->
    <!-- Third Party -->
  <OpChain name="TENDER_THIRD_PARTY" signal="TransactionModified" contextKey="SALE"> <!-- BZ24072: change contextKey from SALE_TENDER_EMPTY_MENU_OPTION to SALE -->
     <PromptOp class="caw.pos.araccount.CawPromptThirdPartyEBSOfflineOp"/><!-- BZ26500 -->
     <PromptOp class="caw.pos.araccount.validation.CawValidateMultiARThirdPartyTenderOp"/><!-- BZ29124 -->
     <Op class="caw.pos.araccount.CawCustomerSearchThirdParty" required="true" breakpoint="true" longRunning="true">
            <!-- the CustomerSearchOp MUST be the first in the CUST_ASSOCIATION chain
            so that it can see card swipe events that trigger this chain -->
            <Parameter name="RESULTS_PROMPT" value="CUSTOMER_LIST_THIRD_PARTY" />
            <Parameter name="PrimaryOnly" value="true" />
            <Parameter name="EditCustomerChain" value="CUST_ASSOCIATION_EDIT" />
     </Op>
     <PromptOp class="caw.pos.araccount.validation.CawValidateThirdPartyIsArCreditHoldOp"/><!-- BZ36405 -->
     <PromptOp class="caw.pos.araccount.validation.CawValidateThirdPartyAvailableBalanceZeroOp"/> <!-- BZ35326 -->
     <Op class="dtv.pos.tender.CreateTenderLineItemOp">
            <Parameter name="TenderStatus" value="Tender" />
            <Parameter name="TenderId" value="THIRD_PARTY" />
     </Op>
     <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
     <ValidationOp validationsBean="houseAccountAvailableRules" />
     <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
     <Op class="caw.pos.araccount.CawPromptTenderPurchaseOrderOp" />
     <OpChainRoute chainKey="CAW_TENDER_AMOUNT_OP" />
     <Op class="dtv.pos.houseaccount.op.UpdateARTenderAcctNumberOp" />
     <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
     <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
     <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!-- End BZ23263 -->
  <!-- Begin BZ23672 -->
  <OpChain name="NEW_RETURN_ROLLBACK" contextKey="RETURN" rollbackChainKey="BACKTO_SALE_ITEM" rollbackLevel="20">
    <Op class="dtv.pos.register.returns.InitializePreviousReturnInfoOp" />
    <Op class="caw.pos.register.returns.CawPurchaseUsedFirearmRollbackOp" />
    <OpChainRoute chainKey="RETURN_ITEM_START" chainType="START" />
  </OpChain>
  <!-- End BZ23672 -->
  <!-- Begin BZ-23406 -->
           <!-- BEGIN BZ29590 -->
       <!-- Removed due to BZ29302: remove Shopping Pass/New Good Sam tender option-->
           <!-- END BZ29590 -->
  <!-- End BZ-23406 -->
  
  <!-- Begin BZ-23265 , BZ25761-->
  <OpChain name="CAW_GOOD_SAM_CREDIT_MADE_OFFER">
    <Op class="caw.pos.common.CawRefreshPinpadScreenOp" /> <!-- BZ29383 -->
    <Op class="caw.pos.customer.checkinginfo.CawCheckingPhoneNumberOp" /> <!-- BZ29514 -->
    <PromptOp class="caw.tenderauth.impl.eigen.goodsam.op.CawPreScreenConfirmCustomerInfoPromptOp" longRunning="true"/> <!-- BZ29351 -->
    <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamVisaPrescreenApplyOp" longRunning="true" />
  </OpChain>
  <!-- End BZ-23265, BZ25761 -->
  
  <!--  Begin BZ23676,  BZ25761, BZ57844-->
  <OpChain name="CAW_GOOD_SAM_VISA_RESPONSE_APPROVE" signal="TransactionModified">
        <OpChainRoute chainKey="DISPLAY_INFO_TAB_MESSAGE" />
        <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamVisaResponseApprovedOp" longRunning="true" />
        <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamVisaAddLoyaltyItemOp"/>  <!--BZ57844 -->
        <OpChainRoute chainKey="CAW_MEMBERSHIP_ITEM_VALIDATION" condition="caw.pos.advance.prompting.CawMembershipItemCondition" /> <!-- BZ58779 -->
        <OpChainRoute chainKey="SALE_TAXING" condition="caw.tenderauth.impl.eigen.goodsam.condition.CawLoyaltyItemOfferRunCondition" /><!-- BZ58886, BZ59069 -->
  </OpChain>
  <!--  End BZ23676, BZ25761, BZ57844-->
  
  <!-- Begin BZ23646 -->
  <OpChain name="CAW_ITEM_NOT_ON_FILE">
        <Op class="caw.pos.advance.prompting.CawPromptItemNotOnFile" />
  </OpChain>
  <!-- End BZ23646 -->
  
  <!-- Begin BZ23356 -->
  <OpChain name="CAW_PRINT_DECLINED_RECEIPTS">
    <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
    <WorkerOp workersBean="emailRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
    <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
    <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
  </OpChain>
  <!-- End BZ23356 -->
  
  <!-- Begin BZ-23576 -->
    <OpChain name="TENDER_MANUAL_CREDIT_DEBIT_CARD" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
        <!-- <Op class="dtv.pos.tender.CreateTenderLineItemOp"> --> <!-- Replaced by BZ31568 -->
        <Op class="caw.pos.tender.CawCreateTenderLineItemOp"> <!-- BZ31568 -->
          <Parameter name="TenderStatus" value="Tender" />
          <Parameter name="TenderCategory" value="CREDIT_CARD" />
        </Op>
        <OpChainRoute chainKey="TENDER_CREDIT_CARD.pre" />
        <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
        <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
        <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
        <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="tenderAmountRules" />
        
        <!-- Begin BZ27344 
        When tender with Manual Credit, We will clear all element in Queue.
        -->
        <Op class="caw.tenderauth.impl.eigen.op.CawClearPinpadItemModelQueueOp" />
        <!-- End BZ27344 -->
        
        <Op class="dtv.tenderauth.impl.op.BINSmartLookupOp" />
        <ValidationOp validationsBean="creditPaymentAccountRules" />
        <!-- after PromptCreditDebitOp and CustomerPromptCreditDebitOp we should
             always have a tender ID on the tender line item
        may want to validate how the card was keyed/swiped here -->
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <ValidationOp validationsBean="tenderAvailabilityRules" />
        <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
          <Parameter name="tenderId" value="PRIVATE_LABEL" />
        </PromptOp>
        <PromptOp class="dtv.pos.tender.cid.PromptCidOp" validationsBean="cidRules" />
        <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <PromptOp class="dtv.pos.tender.PromptPostalCodeOp" validationsBean="postalCodeRules" />
        <Op class="caw.pos.tender.creditcard.CawIsManualInputCreditDebitOp" />
        <Op class="caw.tenderauth.impl.eigen.op.CawAuthorizeTenderOp" />
        <Op class="dtv.pos.common.PersistTranInProcessOp" />
        <OpChainRoute chainKey="CAPTURE_SALE_TENDER_SIGNATURE" />
        <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
      </OpChain>
  <!-- End BZ-23576 -->
  <!-- Begin BZ23603 -->
  <OpChain name="REFUND_ORIG_CREDIT_CARD_TENDER" signal="TransactionModified">
    <PromptOp class="caw.pos.tender.CawPromptOrigCreditCardsToSelectOp" contextKey="CREDIT_CARD_REFUND" breakpoint="true" /> <!-- BZ63225 -->
    <PromptOp class="dtv.pos.tender.PromptOrigCreditCardAmount" validationsBean="originalCardRefundTenderAmountRules" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="caw.tenderauth.impl.eigen.op.CawAuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    </OpChain>
    <OpChain name="REFUND_CREDIT_CARD" signal="TransactionModified" contextKey="REFUND_TENDER_EMPTY_MENU_OPTION">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderCategory" value="CREDIT_CARD" />
    </Op>
    <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
    <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
    <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
    <ValidationOp validationsBean="tenderAvailabilityRules" />
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
      <Parameter name="tenderId" value="PRIVATE_LABEL" />
    </PromptOp>
    <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="tenderAmountRules" />
    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <!-- <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" /> -->
    <Op class="caw.tenderauth.impl.eigen.op.CawAuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!-- End BZ23603 -->
  
  <!--Begin BZ26873: Added menu -->
  <OpChain name="CAW_REFUND_MANUAL_CREDIT_CARD" signal="TransactionModified" contextKey="REFUND_TENDER_EMPTY_MENU_OPTION">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderCategory" value="CREDIT_CARD" />
    </Op>
    <OpChainRoute chainKey="PROMPT_CREDIT_CARD" />
    <Op class="dtv.pos.tender.creditcard.CustomerPromptCreditDebitOp" />
    <PromptOp class="dtv.pos.tender.creditcard.PromptCreditDebitOp" />
    <ValidationOp validationsBean="tenderAvailabilityRules" />
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.tenderauth.impl.op.PromptPrivateCreditPlanOp">
      <Parameter name="tenderId" value="PRIVATE_LABEL" />
    </PromptOp>
    <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="tenderAmountRules" />
    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="caw.pos.tender.creditcard.CawIsManualInputCreditDebitOp" />
    <Op class="caw.tenderauth.impl.eigen.op.CawAuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!--End BZ26873: Added menu -->
  
  <!-- Begin BZ23758 -->
    <OpChain name="REMOVE_CUST_ASSOC" signal="TransactionModified">
        <Op class="caw.pos.register.sale.CawRevertMemberPriceOverrideOp" /><!-- Begin BZ26314 -->
        <Op class="dtv.pos.register.specorder.PromptRemoveCustWithSpecOrderOp" />
        <Op class="dtv.pos.customer.award.VoidAwardsFromTransactionOp" />
        <Op class="caw.pos.customer.CawRemoveCustFromTransactionOp" />
        <!-- BZ26431: Check and remove no regular price item(s) after removing customer -->
        <PromptOp class="caw.pos.register.sale.CawRemoveNoRegularPriceItem" />
        <!-- End BZ26431-->
        <Op class="caw.pos.common.CawClearGlobalVariablesOp" />
        <Op class="dtv.pos.pricing.discount.ValidateDiscountsOnCustomerChangeOp" />
        <Op class="dtv.pos.customer.wishlist.op.RemoveWishListItemsOfCustomerOp" />
    </OpChain>
  <!-- End BZ23758 -->
  
  <!-- Begin BZ23693 -->
  <OpChain name="TENDER_CHECK" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Tender" />
      <Parameter name="TenderId" value="CHECK" />
    </Op>
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="caw.pos.hardware.op.CawReadMicrOp" longRunning="true"/> <!-- BZ23693 - Fix the Check isn't scan when happen error -->
    <ValidationOp validationsBean="checkNumberRules" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.pos.tender.check.PromptBirthdayOp" validationsBean="birthDateRules" />
    <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="tenderAmountRules" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <!-- <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" /> --> <!-- BZ23581 -->
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  
  <OpChain name="TENDER_CHECK_NO_AUTH" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Tender" />
      <Parameter name="TenderId" value="CHECK" />
    </Op>
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="caw.pos.hardware.op.CawReadMicrOp" longRunning="true"/> <!-- BZ23693 - Fix the Check isn't scan when happen error -->
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.pos.tender.check.PromptBirthdayOp" />
    <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  
  <OpChain name="INCOMING_TENDER_EXCHANGE_CHECK">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Tender" />
      <Parameter name="TenderId" value="CHECK" />
    </Op>
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="caw.pos.hardware.op.CawReadMicrOp" longRunning="true"/> <!-- BZ23693 - Fix the Check isn't scan when happen error -->
    <ValidationOp validationsBean="checkNumberRules" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.pos.tender.check.PromptBirthdayOp" validationsBean="birthDateRules" />
    <PromptOp class="dtv.pos.tender.exchange.PromptIncomingTenderExchangeAmountOp" validationsBean="tenderExchangeIncomingAmountRules" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="dtv.pos.hardware.op.GetPINEntryOp" />
    <Op class="dtv.pos.hardware.op.CaptureSignatureOp" contextKey="TENDER_EXCHANGE_SIGCAP" breakpoint="true" />
    <Op class="dtv.pos.hardware.op.VerifySignatureOp" />
    <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <OpChainRoute chainKey="CALCULATE_TENDER_EXCHANGE_TOTALS" />
    <PromptOp class="dtv.pos.tender.exchange.PromptWhetherMoreIncomingTendersOp" />
  </OpChain>
  <!-- End BZ23693 -->
  <!-- BEGIN BZ24135 -->
  <OpChain name="CLOSING_COUNT_LOGIC" signal="TransactionComplete" contextKey="CLOSE_COUNT">
    <OpChainRoute chainKey="CLOSING_COUNT_LOGIC_START.local" />
    <Op class="dtv.pos.till.count.EndCountOpenCashDrawerOp" />
    <Op class="caw.pos.till.count.CawPromptTillCountOp" breakpoint="true" />
    <Op class="dtv.pos.till.count.PromptClosingDepositAmountsOp">
      <Parameter name="ChainKey" value="PROMPT_CLOSING_DEPOSIT" />
    </Op>
    <OpChainRoute chainKey="CLOSING_COUNT_LOGIC_ENDCOUNT.pre" />
    <Op class="dtv.pos.till.count.CreateTillEndCountObjectsOp" />
    <OpChainRoute chainKey="CLOSING_COUNT_LOGIC_ENDCOUNT.post" />
    <WorkerOp workersBean="persistTransAndObjWorkers" />
    <Op class="dtv.pos.till.UpdateRemoveDrawerFromCurrentWkstnOp" />
    <OpChainRoute chainKey="PRINT_RECEIPTS" />
    <PromptOp class="dtv.pos.hardware.op.WaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
  </OpChain>
  <!-- END BZ24135 -->
  
  <!-- Begin BZ24150 -->
  <OpChain name="ADD_COUPON_LINE_ITEM" signal="TransactionModified">
    <Op class="dtv.pos.coupon.AuthorizeSerializedCouponOp" />
    <!-- BEGIN BZ34370: changed Op to PromptOp -->
    <PromptOp class="caw.pos.promotion.coupon.CawEnterCouponSerialScreenOp" longRunning="true" />
    <!-- END BZ34370 -->
    <Op class="caw.pos.promotion.coupon.CawAddCouponLineItemOp" />
  </OpChain>
  <!-- End BZ24150  -->
  
  <!-- Begin BZ24257 -->
  <OpChain name="PRE_CHANGE_ITEM_PRICE_TOUCH">
    <OpChainRoute chainKey="CAW_IGNORE_PRICE_CHANGE_OP" />
  </OpChain>
  
  <OpChain name="CAW_IGNORE_PRICE_CHANGE_OP">
    <Op class="caw.pos.register.CawIgnorePriceChangeOp"/>
  </OpChain>
  <!-- End BZ24257 -->
  
  <!-- Begin BZ24354 -->
  <OpChain name="SALE_NON_PHYSICAL_FINISH" signal="TransactionModified">
    <Op class="dtv.pos.register.sale.CheckCustomerRequiredOp" />
    <OpChainRoute chainKey="SALE_NON_PHYSICAL_VALIDATE" condition="caw.pos.register.rvpayment.CawRvPaymentPropertiesCondition"/><!-- BEGIN BZ44917 -->
    <OpChainRoute chainKey="SALE_NON_PHYSICAL_AUTHORIZE" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
    
    <OpChainRoute chainKey="CAW_MEMBERSHIP_ITEM_VALIDATION" condition="caw.pos.advance.prompting.CawMembershipItemCondition" /> <!-- BZ-39699 -->
    <Op class="caw.pos.advance.prompting.CawAddDonationItemToSaleTranOp" /> <!-- BZ-39699 -->

   <!--  <Op class="dtv.pos.register.AddItemToSaleTranOp" /> -->
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <WorkerOp workersBean="addTransDiscountsToNewItemWorkers" />
    <OpChainRoute chainKey="SALE_TAXING" />
    <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
    <PromptOp class="dtv.pos.register.attacheditems.PromptAttachedItemsOp" />
    <Op class="dtv.pos.register.attacheditems.AttachedItemsIteratingOp">
      <Parameter name="chainKey" value="SALE_ITEM_AFTER_LOOKUP" />
    </Op>
    <OpChainRoute chainKey="NOTIFY_ATTACHED_ITEMS" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
  </OpChain>
  
  <OpChain name="CAW_MEMBERSHIP_ITEM_VALIDATION">
    <OpChainRoute chainKey="CAW_DISPLAY_INFO_TAB_MESSAGE" /><!-- BZ27339 -->
    <!-- BEGIN PATCH 17: BZ45995 -->
    <OpChainRoute chainKey="CAW_MEMBERSHIP_EMAIL_CAPTURE" condition="caw.pos.advance.prompting.CawMembershipEmailCaptureCondition" />
    <!-- END PATCH 17: BZ45995 -->
    <Op class="caw.pos.advance.prompting.CawManualGoodSamClubPreCheckOp" />
    <OpChainRoute chainKey="PROCESS_MEMBERSHIP_VALIDATE" /><!-- BZ 25488 -->
    <Op class="caw.pos.advance.prompting.CawAddItemToSaleTranOp" />
    <Op class="caw.pos.advance.prompting.CawProcessSaveJoinGoodSamOp" longRunning="true"/> 
    <Op class="caw.pos.customer.CawRefreshCustMembershipOp" longRunning="true"/><!-- BZ 24410 -->
    <OpChainRoute chainKey="CAW_REFRESH_ITEM_PRICE" />
  </OpChain>
  <!-- End BZ24354 -->
  
  <!-- BEGIN PATCH 17: BZ45995 --> 
  <OpChain name="CAW_MEMBERSHIP_EMAIL_CAPTURE">
   <Op class="caw.pos.advance.prompting.CawMembershipEmailCaptureFormOp" />
   <Op class="caw.pos.customer.CawEmailCaptureDisplayCustomerVerificationOp"/>
  </OpChain>
  <!-- END PATCH 17: BZ45995 -->
  
  <!-- Start BZ 25488 -->
  <OpChain name="PROCESS_MEMBERSHIP_VALIDATE">
    <PromptOp class="caw.pos.advance.prompting.CawProcessMembershipItemValidOp" longRunning="true" />
    <PromptOp class="caw.pos.advance.prompting.CawProcessMembershipItemValidMsgOp" longRunning="true" />
  </OpChain>
  <!-- End BZ 25488 -->
  
  <!-- Begin BZ24253 -->
  <OpChain name="REFUND_AR_ACCOUNT" signal="TransactionModified" contextKey="REFUND_TENDER">
        <PromptOp class="caw.pos.araccount.validation.CawValidateMultiARThirdPartyTenderOp"/><!-- BZ29124 -->
        <Op class="dtv.pos.tender.CreateTenderLineItemOp">
            <Parameter name="TenderStatus" value="Refund" />
            <Parameter name="TenderId" value="AR_ACCOUNT" />
        </Op>
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <ValidationOp validationsBean="houseAccountAvailableRules" />
        <PromptOp
            class="dtv.pos.houseaccount.op.PromptNoHouseAccountCustAssignedOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <Op class="caw.pos.araccount.CawPromptTenderPurchaseOrderOp" contextKey="REFUND_TENDER" />
        <OpChainRoute chainKey="CAW_AR_ACCOUNT_TENDER_AMOUNT_OP" contextKey="REFUND_TENDER"/>
        <Op class="dtv.pos.houseaccount.op.UpdateARTenderAcctNumberOp" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE"
            chainType="START" />
  </OpChain>
  <OpChain name="REFUND_THIRD_PARTY" signal="TransactionModified" contextKey="REFUND_TENDER"> <!-- BZ24072: change contextKey from SALE_TENDER_EMPTY_MENU_OPTION to SALE -->
     <PromptOp class="caw.pos.araccount.CawPromptThirdPartyEBSOfflineOp"/><!-- BZ26500 -->
     <PromptOp class="caw.pos.araccount.validation.CawValidateMultiARThirdPartyTenderOp"/><!-- BZ29124 -->
     <Op class="caw.pos.araccount.CawCustomerSearchThirdParty" required="true" breakpoint="true" longRunning="true" contextKey="REFUND_TENDER">
            <!-- the CustomerSearchOp MUST be the first in the CUST_ASSOCIATION chain
            so that it can see card swipe events that trigger this chain -->
            <Parameter name="RESULTS_PROMPT" value="CUSTOMER_LIST_THIRD_PARTY" />
            <Parameter name="PrimaryOnly" value="true" />
            <Parameter name="EditCustomerChain" value="CUST_ASSOCIATION_EDIT" />
     </Op>
     <Op class="dtv.pos.tender.CreateTenderLineItemOp">
            <Parameter name="TenderStatus" value="Refund" />
            <Parameter name="TenderId" value="THIRD_PARTY" />
        </Op>
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <ValidationOp validationsBean="houseAccountAvailableRules" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <Op class="caw.pos.araccount.CawPromptTenderPurchaseOrderOp" contextKey="REFUND_TENDER" />
        <OpChainRoute chainKey="CAW_THIRD_PARTY_TENDER_AMOUNT_OP" contextKey="REFUND_TENDER"/> <!-- BZ61330 -->
        <Op class="dtv.pos.houseaccount.op.UpdateARTenderAcctNumberOp" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE"
            chainType="START" />
  </OpChain>
  <!-- End BZ24253 -->
  
  <!-- Start BZ24605 -->
  <OpChain name="VERIFY_RETURN">
    <PromptOp class="dtv.pos.register.returns.verification.PromptForGiftRcptOp" />
    <Op class="caw.pos.register.returns.verification.CawSetMissingReturnTypeOp" />
    <Op class="dtv.pos.register.returns.verification.VerifyReturnOp" />
  </OpChain>
  <!-- End BZ24605 -->
  <!-- BEGIN BZ63225 -->
  <OpChain name="VALIDATE_WO_DEPOSIT">
    <Op class="caw.pos.workorder.op.CawWorkOrderReturnSearchOp" />
  </OpChain>
  <!-- END BZ63225 -->
  <!-- Begin BZ24877 -->
  <OpChain name="NOTIFICATION_JOIN_GSC">
    <PromptOp class="caw.pos.advance.prompting.CawNotificationJoinGSCPromptOp" />
  </OpChain>
  <!-- End BZ24877 -->
  <!-- Begin BZ24945 -->
  <OpChain name="CAW_PROMPT_AR_RETURN_OFFLINE">
        <PromptOp class="caw.pos.araccount.CawPromptArReturnEBSOffline" />
    </OpChain>
  <!-- End BZ24945 -->
  
  <!-- Start BZ 25113 -->
  <OpChain name="PRE_SALE.1">
    <Op class="caw.tenderauth.impl.eigen.op.CawStartEigenSessionOp" />
  </OpChain>
  
  <OpChain name="RESET_AFTER_NO_TRANS" signal="TransactionCancelled">
    <Op class="dtv.pos.hardware.op.IdleCustomerDisplayOp" required="false" />
    <Op class="dtv.pos.security.op.LogoutOp" />
    <Op class="caw.tenderauth.impl.eigen.op.CawCloseEigenSessionOp" />
    <OpChainRoute chainKey="REGISTER_LOGIN" chainType="START" />
  </OpChain>
  <!-- End BZ 25113 -->
  <!-- Begin BZ23405 -->
  <OpChain name="ADDRESS_LOOKUP">
    <Op class="caw.pos.address.search.CawPromptAddressLookupOp" longRunning="true"/> <!-- BZ-41382 -->
  </OpChain>
  <!-- End BZ23405 -->
  
  <!-- Begin BZ25068 -->
  <OpChain name="CAW_RETURN_WEB_ORDERS" signal="TransactionModified" contextKey="RETURN" >
    <Op class="caw.pos.register.returns.CawReturnWebOrderOp"/>
  </OpChain>
  <!-- End BZ25068 -->
  
  <!-- Begin BZ25280 -->
  <OpChain name="RETURN_ITEM_VALIDATE">
    <PromptOp class="dtv.pos.register.returns.PromptReturnItemSerialNumberOp" validationsBean="returnSerialNumberRules" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" validationsBean="itemDescriptionRules" />
    <!-- BEGIN PATCH 19: BZ46743 -->
    <PromptOp class="caw.pos.register.returns.CawReturnItemPropertyPromptOp" validationsBean="itemPromptPropertyRules" />
    <!-- END PATCH 19: BZ46743 -->
    <PromptOp class="dtv.pos.register.PromptItemQuantityOp" validationsBean="saleItemQuantityRules" />
    <PromptOp class="dtv.pos.register.sale.PromptForItemWeightOp" validationsBean="itemWeightRules" />
    <PromptOp class="caw.pos.register.returns.CawPromptReturnItemPriceIfNeededOp" validationsBean="returnItemPriceValRules" />
    <Op class="dtv.pos.register.returns.CheckReturnStyleLookupOp" />
  </OpChain>
  <!-- End BZ25280 -->
  
  <!-- Begin BZ25972 -->
  <OpChain name="PRE_SERIAL_EXCHANGE_CHAIN" rollbackChainKey="SERIAL_EXCHANGE_ROLLBACK_TRANS_PROMPT" chainType="START">
    <Op class="caw.pos.customer.CawIsBackCustSearchFormOp" />
    <Op class="dtv.pos.common.op.CreateTransactionAsNeededOp">
      <Parameter name="TransactionType" value="SERIAL_EXCHANGE" />
    </Op>
    <Op class="dtv.pos.inventory.serialexchange.PromptExchangeCustomerInfoOp" required="true" />
    <OpChainRoute chainKey="EXCHANGE_SERIAL_NUMBER"/>
  </OpChain>
  <!-- End BZ25972 -->
 
  <!-- Begin BZ25115 -->
  <OpChain name="CAW_MEMBER_PRICE_OVERRIDE" signal="TransactionModified">
    <PromptOp class="caw.pos.register.sale.CawMemberPriceOverrideWarningOp" />
    <Op class="caw.pos.register.sale.CawConvertPriceFromRegularToClubOp" />
    <Op class="caw.pos.register.sale.CawConvertPriceFromClubToRegularOp" />
    <Op class="caw.pos.register.sale.CawMemberPriceOverrideVoidLinesOp" /><!-- BZ25992 -->
    <Op class="caw.pos.register.sale.CawMemberPriceOverrideRefreshUnitPriceOp" />
    <Op class="caw.pos.register.sale.CawMemberPriceOverrideVoidPriceOp" />
    <Op class="caw.pos.register.sale.CawMemberPriceOverrideUnVoidPriceOp" />
    <!-- BZ26431: check and remove no regular price item(s) after un-used Member Price Override -->
    <PromptOp class="caw.pos.register.sale.CawRemoveNoRegularPriceItem" />
    <!-- End BZ26431-->
  </OpChain>
  <!-- End BZ25115 -->
 <OpChain name="SALE_COMPLETE">
    <OpChainRoute chainKey="CAW_SEND_GS_AP_REQUEST" condition="caw.tenderauth.impl.eigen.accountpayment.condition.CawSendAccountPaymentCondition" /> <!-- BZ29406 -->
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ25306 -->
    <OpChainRoute chainKey="SALE_COMPLETE_START" />
    <OpChainRoute chainKey="SALE_COMPLETE_AFTER_START.local.1" />
    <OpChainRoute chainKey="SALE_COMPLETE_AFTER_START.local.2" />
    <OpChainRoute chainKey="SALE_COMPLETE_AFTER_START" />
    <OpChainRoute chainKey="SALE_COMPLETE_BEFORE_FINISH" />
    <OpChainRoute chainKey="SALE_COMPLETE_BEFORE_FINISH.local" />
    <OpChainRoute chainKey="SALE_COMPLETE_ISSUE_DOCUMENT" />
    <OpChainRoute chainKey="SALE_COMPLETE_FINISH" chainType="START" />
  </OpChain>
  <!-- BEGIN BZ29406 -->
  <OpChain name="CAW_SEND_GS_AP_REQUEST">
    <Op class="caw.tenderauth.impl.eigen.accountpayment.op.CawSendAccountPaymentRequestOp" />
  </OpChain>
  
  <OpChain name="CAW_CANCEL_AP_TRANS">
    <OpChainRoute chainKey="CAW_VOID_ALL_TENDERS" />
    <OpChainRoute chainKey="ROLLBACK_TRANS_PROMPT" chainType="START" />
  </OpChain>
  
  <OpChain name="CAW_VOID_ALL_TENDERS">
    <Op class="caw.pos.tender.modifytender.CawVoidAllTendersOp" />
  </OpChain>
  
  <OpChain name="CAW_VOID_TENDER" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
    <OpChainRoute chainKey="GUEST_LOOKUP" />
    <OpChainRoute chainKey="VOID_ROOM_CHARGE" />
    <Op class="dtv.tenderauth.storedvalue.VoidTenderAuthorizationOp">
        <Parameter name="ContinueOnFailure" value="false" />
    </Op>
    <WorkerOp workersBean="updateTenderVoidWorkers" />
  </OpChain>
  <!-- END BZ29406 -->
  
  <!-- Begin BZ25927 -->
  <OpChain name="VALIDATE_BACKOFFICE_STARTUP">
    <ValidationOp validationsBean="cawLoginBackOfficeRules" />
    <Op class="dtv.pos.assistance.access.ValidateEmployeeRestrictedAccessOp" />
    <Op class="dtv.pos.systemcycle.access.SynchStateJournalOp" />
  </OpChain>
  
  <OpChain name="RETAIL_LOCATION_OPEN_FROM_APP">
    <Op class="dtv.pos.hardware.op.PlaySoundOp" />
    <Op class="dtv.pos.common.op.PromptLoginIfNeededOp">
      <Parameter name="FailedPromptKey" value="STORE_OPEN_LOGIN_FAILED" />
      <Parameter name="PasswordPromptKey" value="STORE_OPEN_USER_PWD" />
      <Parameter name="UserIdPromptKey" value="STORE_OPEN_USER_ID" />
      <Parameter name="PrivilegeType" value="LOG_IN_TO_SYSTEM" />
    </Op>
    <ValidationOp validationsBean="cawLoginBackOfficeRules" />
    <Op class="dtv.pos.assistance.access.ValidateEmployeeRestrictedAccessOp" />
    <OpChainRoute chainKey="RETAIL_LOCATION_OPEN" chainType="START" />
  </OpChain>
  
  <OpChain name="WORKSTATION_OPEN_FROM_APP">
    <Op class="dtv.pos.hardware.op.PlaySoundOp" />
    <Op class="dtv.pos.common.op.PromptLoginIfNeededOp">
      <Parameter name="FailedPromptKey" value="WORKSTATION_OPEN_LOGIN_FAILED" />
      <Parameter name="PasswordPromptKey" value="WORKSTATION_OPEN_USER_PWD" />
      <Parameter name="UserIdPromptKey" value="WORKSTATION_OPEN_USER_ID" />
      <Parameter name="PrivilegeType" value="LOG_IN_TO_SYSTEM" />
    </Op>
    <ValidationOp validationsBean="cawLoginBackOfficeRules" />
    <Op class="dtv.pos.assistance.access.ValidateEmployeeRestrictedAccessOp" />
    <Op class="dtv.pos.systemcycle.access.SynchStateJournalOp" />
    <OpChainRoute chainKey="WORKSTATION_OPEN" chainType="START" />
  </OpChain>
  <!-- End BZ25927 -->
  
  <!--Begin BZ25590  -->
  <OpChain name="SALE_ITEM_AFTER_LOOKUP">
    <ValidationOp validationsBean="itemAvailableForSaleRules" />
    <PromptOp class="dtv.pos.item.restriction.PromptForCashierAgeVerificationOp">
      <Parameter name="SaleItemType" value="SALE" />
    </PromptOp>
    <ValidationOp validationsBean="sellingIdGroupRules" />
    <ValidationOp validationsBean="cawValidateItemPriceRules"/> 
    <Op class="dtv.pos.register.CreateSaleLineItemOp" />
    <Op class="caw.pos.register.CawAddSaleLineItemPropertyOp" /><!-- BEGIN BZ44917 -->
    <Op class="caw.pos.register.CawRetrieveUpcLineItemOp" />
    <!-- BEGIN BZ44528 -->
    <PromptOp class="caw.pos.item.CawWonderSignConfirmExistedItemOp" key="CAW_CONFIRM_EXISTED_ORDER_ITEM" >
        <Parameter name="ConfirmItemType" value="SALE" />
    </PromptOp>
    <!-- END BZ44528 -->
    <Op class="dtv.pos.register.sale.CheckStyleLookupOp">
      <Parameter name="SaleItemType" value="SALE" />
    </Op>
    <ValidationOp validationsBean="itemAvailabilityRules" />
    <PromptOp class="dtv.pos.register.sale.PromptForItemWeightOp" validationsBean="itemWeightRules" />
    <PromptOp class="caw.pos.register.CawPromptBirthDateScanOp" /> <!-- BZ34226 -->
    <PromptOp class="caw.pos.register.CawMinimumAgeValidationOp" /> <!-- BZ36993 -->
<!-- <Op class="dtv.pos.register.sale.RouteSaleItemOp" /> -->
    <OpChainRoute>
      <!-- @todo add routing to more chains as more types of items are converted, see RouteSaleItemOp
           Warrantries and house account payments still need to be handled. -->
      <Choice chainKey="SALE_ITEM_FINISH" condition="dtv.pos.register.IsPhysicalItem" />
      <Choice chainKey="SALE_VOUCHER_START">
        <Condition class="dtv.pos.register.IsNonPhysicalItem">
          <Parameter name="ItemType" value="VOUCHER" />
        </Condition>
      </Choice>
      <Choice chainKey="CREDIT_PAYMENT">
        <Condition class="dtv.pos.register.IsNonPhysicalItem">
          <Parameter name="ItemType" value="CREDIT_PAYMENT" />
        </Condition>
      </Choice>
      <Choice chainKey="SALE_WARRANTY">
        <Condition class="dtv.pos.register.IsNonPhysicalItem">
          <Parameter name="ItemType" value="WARRANTY" />
        </Condition>
      </Choice>
      <Choice chainKey="SALE_WARRANTY_GIFT">
        <Condition class="dtv.pos.register.IsNonPhysicalItem">
          <Parameter name="ItemType" value="WARRANTY_GIFT" />
        </Condition>
      </Choice>
      <Choice chainKey="SALE_WARRANTY_RENEW">
        <Condition class="dtv.pos.register.IsNonPhysicalItem">
          <Parameter name="ItemType" value="WARRANTY_RENEWAL" />
        </Condition>
      </Choice>
      <Choice chainKey="SALE_NON_PHYSICAL_FINISH" condition="dtv.pos.register.IsNonPhysicalItem" />
    </OpChainRoute>
    <!-- Begin BZ29625 -->
    <PromptOp class="caw.pos.advance.prompting.CawItemMessagePromptOp"/> -->
    <!-- End BZ29625 -->
    <OpChainRoute chainKey="SALE_ITEM_AFTER_LOOKUP.finish" />
    <Op class="caw.pos.cheetah.CawUpdateLoyaltyFlagForFreeGS" /> <!-- BZ59418 -->
  </OpChain>
  <!--End BZ25590  -->
  <!-- Begin BZ26313 -->
  <OpChain name="REMOVE_CUST_ASSOC_QAS" signal="TransactionModified">
    <Op class="dtv.pos.register.specorder.PromptRemoveCustWithSpecOrderOp" />
    <Op class="dtv.pos.customer.award.VoidAwardsFromTransactionOp" />
    <Op class="dtv.pos.customer.RemoveCustFromTransactionOp" />
    <!-- BZ26431: check and remove no regular item(s) after removing customer -->
    <PromptOp class="caw.pos.register.sale.CawRemoveNoRegularPriceItem" />
    <!-- End BZ26431-->
    <Op class="dtv.pos.pricing.discount.ValidateDiscountsOnCustomerChangeOp" />
    <Op class="caw.pos.customer.CawRemoveWishListItemsOfCustomerOp" />
    <OpChainRoute chainKey="BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  <!-- End BZ26313 -->
  
   <!-- BZ25640 paid out  of used firearm-->
   <OpChain name="PAID_OUT_USED_FIREARM" >
        <!-- UFA to start -->
        <PromptOp class="caw.pos.register.ufa.CawPromptUFAStartOp" breakpoint="true" />
        <OpChainRoute chainKey="PAID_OUT_UFA" chainType="START"/>
  </OpChain>
  <OpChain name="PAID_OUT_UFA">
    <Op class="dtv.pos.register.itemmessages.ClearMsgOp" />
    <OpChainRoute chainKey="PRE_TRANS_TILL_VALIDATION" />
    <Op class="dtv.pos.hardware.op.UseIpCashDrawerAlwaysPromptOp" />
    <PromptOp class="dtv.pos.hardware.op.IpCashDrawerAlwaysScanOp" validationsBean="scanIpCashDrawerRules" breakpoint="true" />
    <Op class="dtv.pos.till.CheckCurrentSessionStatusOp">
      <Parameter name="AcceptedStatus" value="BEGINCOUNT" />
    </Op>
    
    <!-- UFA to scan eTrack ID and do validation of inputs -->
    <PromptOp class="caw.pos.register.ufa.CawPromptUFAScanOp" validationsBean="itemIdRules" breakpoint="true" />
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" />
    <!-- BEGIN BZ26896 -->
    <PromptOp class="caw.pos.register.ufa.CawPromptUFAFundCheckOp" validationsBean="cawFundXferAmountRules" breakpoint="true" />
    <PromptOp class="caw.pos.till.fundxfer.CawPromptFundXferAmountExceededOp" />
    <!-- END BZ26896 -->
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" />
    <OpChainRoute chainKey="PAID_OUT_UFA.complete" chainType="START"/>
  </OpChain>
  <OpChain name="PAID_OUT_UFA.complete"  signal="TransactionComplete" contextKey="TILL">
    <OpChainRoute chainKey="CHECK_TILL_BALANCE" />
    <OpChainRoute chainKey="PAID_OUT.1.local" />
    <Op class="dtv.pos.hardware.op.AlwaysOpenCashDrawerOp" />
    <Op class="dtv.pos.till.fundxfer.CreatePaidOutTransactionOp">
      <Parameter name="persistOnReverse" value="true" />
    </Op>
    <OpChainRoute chainKey="PAID_OUT.2.local" />
    
    <!-- UFA to populate the paid-out transaction -->
    <Op class="caw.pos.register.ufa.CawPopulateUFAPaidOutTransactionOp" />
    
    <WorkerOp workersBean="updateCashDrawerIdWorkers" />
    <WorkerOp workersBean="persistTransAndObjWorkers" />
    <!-- UFA to persist Customer and Used firearm attributes -->
    <OpChainRoute chainKey="PAID_OUT.3.local" />
    <OpChainRoute chainKey="PRINT_RECEIPTS" />

    <PromptOp class="dtv.pos.hardware.op.WaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
    <!-- Flash sales update paid out -->
    <WorkerOp workersBean="populateFlashSalesTablesWorkers" />
    <!-- UFA to return customer association screen -->
    <OpChainRoute chainKey="PAID_OUT_UFA.finish" chainType="START"/>
  </OpChain>
  <OpChain name="PAID_OUT_UFA.finish" >
        <!-- BZ26699: UFA to finish -->
        <OpChainRoute chainKey="RESET_REGISTER"/>
        <Op class="caw.pos.common.CawClearGlobalVariablesOp" />
        <OpChainRoute chainKey="RESET_AFTER_TRANS" chainType="START" />
  </OpChain>
  
  <!-- End BZ25640-->
  <!-- Begin BZ26432 -->
  <OpChain name="CUSTOMER_MAINTENANCE" rollbackLevel="40">
    <Op class="caw.pos.customer.CawBOCustomerSearchOp" required="true" breakpoint="true">
      <Parameter name="RESULTS_PROMPT" value="CUSTOMER_LIST" />
      <Parameter name="PrimaryOnly" value="true" />
      <Parameter name="AddCustomerChain" value="CREATE_CUSTOMER_FROM_SEARCH" />
      <Parameter name="EditCustomerChain" value="CUSTOMER_MAINTENANCE_EDIT" />
      <Parameter name="AlwaysViewCustomer" value="true" />
    </Op>
    <!-- End BZ26432 -->
  </OpChain>
  
  <!-- Begin BZ26314 -->
  <OpChain name="RESET_REGISTER">
    <Op class="caw.pos.register.sale.CawRevertMemberPriceOverrideOp" />
    <Op class="caw.pos.common.CawClearGlobalVariablesOp" /> <!-- BZ29574 -->
    <WorkerOp workersBean="clearActiveCashDrawerWorkers" />
    <Op class="dtv.pos.common.ClearStationModelOp" />
    <Op class="dtv.pos.customer.loyalty.ClearLoyaltyOp" />
    <Op class="dtv.pos.hardware.op.ItemCustDisplayOp" />
    <Op class="dtv.pos.order.ResetOrderMgrOp" />
    <Op class="dtv.pos.hardware.op.IdleCustomerDisplayOp" required="false" />
    <Op class="dtv.pos.customer.view.ClearCustomerMessageViewOp" />
    <OpChainRoute chainKey="RESET_REGISTER.local.post" />
    <Op class="caw.pos.common.CawClearPinPadModelOp" /><!-- BZ48120 -->
  </OpChain>
  <!-- End BZ26314 -->
  
  <!-- Begin BZ26575, BZ42019 -->
  <!-- BEGIN PATCH 18: Comment out the OpChain -->
  <!-- 
  <OpChain name="CAW_ADDRESS_VALIDATION">
    <Op class="caw.pos.address.search.CawCustomerValidAddressOp" />
    /* Begin BZ-41382 */
    <PromptOp class="caw.pos.address.search.CawCustomerAddressNotifyPromptOp" longRunning="true"/>
    <PromptOp class="caw.pos.address.search.CawCustomerAddressConfirmPromptOp" longRunning="true"/>
    <Op class="caw.pos.address.search.CawCutomerMutiAddressLookupOp" longRunning="true"/>
    /* End BZ-41382 */
  </OpChain>
   -->
  <!-- 
  <OpChain name="CAW_CUSTOMER_UPDATE_ADDRESS">
    <Op class="caw.pos.address.search.CawCustomerUpdateAddressOp" longRunning="true"/> /* BZ-41382*/
  </OpChain>
   -->
  <!-- END PATCH 18: Comment out the OpChain -->
  <!-- End BZ26575, BZ42019 -->

  <!-- BEGIN BZ26270 copied from base -->
  <OpChain name="VERIFIED_RETURN_ITEM_IMPL">
    <ValidationOp validationsBean="allowItemVerifiedReturnRules" />
    <ValidationOp class="dtv.pos.register.returns.ValidateReturnItemPriceOp" validationsBean="returnOrigPriceRules" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnItemSerialNumberOp" validationsBean="returnSerialNumberRules" />
    <Op class="dtv.pos.register.KitComponentIteratingOp">
      <Parameter name="ChainKey" value="VERIFIED_RETURN_KIT_COMPONENT_SERIAL_NUMBER" />
    </Op>
    <ValidationOp class="dtv.pos.register.returns.verification.ValidateVoucherAlreadyOnTransOp" validationsBean="returnVoucherOnTransRules" />
    <Op class="dtv.pos.register.returns.MatchSerializedReturnItemOp" />
    <Op class="dtv.pos.register.returns.verification.ValidateReturnItemOp" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" validationsBean="itemDescriptionRules" />
    <PromptOp class="dtv.pos.register.returns.verification.PromptReturnVerificationItemQuantityOp" validationsBean="allowVerifiedReturnInputQtyRules" />
    <PromptOp class="dtv.pos.warranty.returns.PromptReturnWarrantiesOp" validationsBean="returnVerifiedWarrantyRules" />
    <ValidationOp class="dtv.pos.register.returns.verification.ValidateTotalReturnPriceNewVerifiedItemOp" validationsBean="returnNewItemPriceRules" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
    <!-- BEGIN BZ26270 -->
    <Op class="caw.pos.register.returns.verification.CawUpdateVerifiedReturnLineOp" />
    <!-- END BZ26270 -->
    <Op class="dtv.pos.register.returns.verification.UpdateVerifiedReturnVoucherOp" />
    <Op class="dtv.pos.register.returns.verification.RouteReturnVerificationOp" />
    <Op class="dtv.pos.kits.returns.UpdateReturnKitComponentsQtyOp" />
    <Op class="dtv.pos.kits.inventory.HandleKitComponentInventoryOp" />
    <Op class="dtv.pos.register.returns.verification.CompleteReturnVerificationOp" />
  </OpChain>
  <!-- END BZ26270 copied from base-->
  <!-- Begin BZ26837 -->
  <OpChain name="AUTOMATIC_LOGOUT">
    <Op class="caw.pos.customer.CawClearVarriableBackCustOp" />
    <Op class="caw.tenderauth.impl.eigen.op.CawCloseEigenSessionOp" /> <!-- BZ33588 -->
    <Op class="dtv.pos.security.op.RouteAutoLogoutOp" />
    <Op class="dtv.pos.hardware.op.IdleCustomerDisplayOp" />
    <Op class="dtv.pos.framework.op.OpChainRollbackToTopOp" />
  </OpChain>
  <!-- End BZ26837 -->
  
  <!-- Begin BZ25435 -->
  <OpChain name="CAW_CARD_SERVICE_SUBMIT">
    <Op class="caw.pos.card.services.CawCardServiceAPISubmitOp" />
  </OpChain>
  <!-- Begin BZ28265 -->
  <OpChain name="CAW_CARD_SERVICE_STATUS">
    <Op class="caw.pos.card.services.CawCardServiceAPIStatusOp" />
  </OpChain>
  <OpChain name="CAW_DISPLAY_GOODSAMVISA_PRESCREEN">
    <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamVisaPreScreenOp" longRunning="true"/><!-- BZ23943 -->
  </OpChain>
  <!-- End BZ28265 -->
  <!-- End BZ25435 -->
  <!-- Begin BZ26847 -->
  <!-- <OpChain name="CAW_PROMPT_GIFT_CARD_NOT_ACTIVE_RELOAD">
    <PromptOp class="caw.pos.tender.voucher.CawPromptGiftCardNotActiveReturnOp" />
  </OpChain> -->
  <OpChain name="CAW_GIFT_CARD_REFUND_TENDER" rollbackChainKey="ROLLBACK_TENDER_PROMPT" rollbackLevel="50">
    <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
      <Parameter name="FILENAME" value="_instructionalTenderReturnMsg" />
    </Op>
    <Op class="dtv.pos.tender.ProcessSavedTenderInputOp" contextKey="REFUND_TENDER" />
    <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
  </OpChain>
  <!-- End BZ26847 -->
  <!-- BZ26289 Start -->
  <OpChain name="HOUSE_ACCOUNT_PAYMENT" signal="TransactionModified">
    <Op class="caw.pos.houseaccount.op.CawCheckHouseAccountPaymentStatusOp" /> <!-- BZ26289 Added -->
    <PromptOp class="dtv.pos.houseaccount.op.PromptHouseAccountNumberOp" validationsBean="houseAccountNumberRules" />
    <Op class="dtv.pos.houseaccount.op.ValidateCustAsscRequiredForARPaymentOp" />
    <PromptOp class="caw.pos.houseaccount.op.CawPromptAvailableARAcctForCurrentCustOp" longRunning="true" /><!-- BZ27177 -->
    <ValidationOp validationsBean="houseAccountPaymentRules" />
    <!-- BZ26289-BZ26984 removed out <ValidationOp validationsBean="houseAccountBalanceRules" /> -->
    <PromptOp class="dtv.pos.houseaccount.op.PromptARAcctOpenInvoicesOp" />
    <PromptOp class="dtv.pos.houseaccount.op.PromptARUserInfoOp" validationsBean="houseAccountUserNameRules">
      <Parameter name="TYPE" value="PAYMENT" />
    </PromptOp>
    <!-- BZ26289 removed out <PromptOp class="dtv.pos.houseaccount.op.PromptAREligibleUsersOp" longRunning="true" /> -->
    <PromptOp class="dtv.pos.houseaccount.op.PromptAccountReceivablePaymentAmtOp" validationsBean="houseAccountPaymentAmountRules" />
    <Op class="dtv.pos.houseaccount.op.ProcessAccountReceivablePaymentAmtOp" />
    <Op class="dtv.pos.houseaccount.op.CreateAccountReceivablePaymentItemOp" />
    <ValidationOp validationsBean="saleLineSellingIdGroupRules" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
    <!-- BZ26289 removed out
    <PromptOp class="dtv.pos.houseaccount.op.PromptARPaymentStatementDateOp" validationsBean="houseAccountStatementDateRules" />
    <PromptOp class="dtv.pos.houseaccount.op.PromptARPaymentInvoiceNumberOp" validationsBean="houseAccountInvoiceNumberRules" />
    -->
    <Op class="dtv.pos.register.AddItemToSaleTranOp" />
    <Op class="dtv.pos.houseaccount.op.CreateCustAcctModifierOp" />
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <Op class="dtv.pos.houseaccount.op.SetHouseAccountInvoiceDataOp" />
    <OpChainRoute chainKey="SALE_TAXING" />
    <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
      <Parameter name="FILENAME" value="_instructionalMsg" />
    </Op>
    <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="caw.pos.customer.CawDisableArAndThirdPartyTenderOp" /><!-- BZ26289 -->
    <OpChainRoute chainKey="PRE_TENDERING" /><!-- BZ26289 -->
  </OpChain>
  <!-- BZ26289 End -->
  
  <!-- BZ26207 Begin Work Order Session -->
  <OpChain name="CAW_PRE_WORK_ORDER_CHAIN" contextKey="WORK_ORDER" rollbackLevel="30">
    <OpChainRoute chainKey="CAW_DISPLAY_INFO_TAB_MESSAGE" /><!-- BZ27260,BZ27339 -->
    <Op class="dtv.pos.customer.account.op.InitCustAcctTypeOp">
      <Parameter name="TYPE" value="WORK_ORDER" />
    </Op>
    <Op class="caw.pos.workorder.op.CawWorkOrderSearchOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderLookupOp" />
    <OpChainRoute chainKey="CAW_WORK_ORDER_CHAIN" chainType="START" />
  </OpChain>
  
  <OpChain name="CAW_WORK_ORDER_CHAIN" contextKey="WORK_ORDER" rollbackLevel="40">
    <Op class="caw.pos.workorder.op.CawUpdateReadyToPickupStateOp" />
    <Op class="caw.pos.workorder.op.CawDisplayWorkOrderAcctFormOp" />
    <Op class="caw.pos.workorder.op.CawDisplayWorkOrderMessageOp" /><!-- BZ30154 -->
    <Op class="caw.pos.workorder.op.CawWorkOrderOptionsOp" />
  </OpChain>

  <OpChain name="CAW_NEW_WORK_ORDER_CHAIN" contextKey="WORK_ORDER">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /> <!-- BZ29157/BZ29138: This OP is used to disable buttons -->
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp" />
    <Op class="dtv.pos.customer.AddCustToTransactionOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAccountIdOp" />
    <Op class="dtv.pos.workorder.account.CreateWorkOrderAccountOp" />
    <!-- Begin BZ27248 -->
    <Op class="caw.pos.workorder.op.CawWorkOrderWarrantyFilterItemOp" />
    <!-- End BZ27248 -->
    <Op class="caw.pos.workorder.op.CawWorkOrderCheckItemOp" />
    <OpChainRoute chainKey="CAW_WORK_ORDER_ADD_WORK_ITEMS" chainType="START" />
  </OpChain>
  
  <!-- Begin BZ27146 -->
  <OpChain name="CAW_WORK_ORDER_RETRY_LOOKUP">
   <Op class="caw.pos.workorder.op.CawWorkOrderLookupOp" />
   <OpChainRoute chainKey="CAW_NEW_WORK_ORDER_CHAIN" chainType="START" />
  </OpChain>
  <!-- End BZ27146 -->

  <OpChain name="CAW_WORK_ORDER_ADD_WORK_ITEMS" contextKey="WORK_ORDER">
      <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
          <Parameter name="FILENAME" value="_instructionalWorkOrderMsg" />
      </Op>
      <Op class="caw.pos.workorder.op.CawWorkOrderAddWorkItemsOp" />
      <OpChainRoute chainKey="CAW_ADD_NEW_WORK_ORDER_ACCT_FINISH" chainType="START" />
  </OpChain>

  <OpChain name="CAW_ADD_NEW_WORK_ORDER_ACCT_FINISH" contextKey="WORK_ORDER">
    <Op class="caw.pos.workorder.op.CawWorkOrderAddCategoryOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddPriceCodeOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddServiceLocationOp" />
    <Op class="dtv.pos.workorder.account.AddWorkOrderAccountToManagerOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddTaskOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddPartItemsOp" />
    <Op class="dtv.pos.warranty.common.AddWarrantiesToManagerOp" />
    <OpChainRoute chainKey="CAW_WORK_ORDER_CHAIN" chainType="START" />
  </OpChain>
  
  <OpChain name="WORK_ORDER_COMPLETE" signal="TransactionModified">
    <ValidationOp validationsBean="workOrderItemsRules" />
    <ValidationOp validationsBean="totalNumberPartTaskRules" />
    <PromptOp class="dtv.pos.workorder.payment.PromptWorkOrderDepositAmountOp" breakpoint="true" />
    <PromptOp class="caw.pos.workorder.common.CawWorkOrderMaxDepositRules" /> <!-- BZ27005 Added promptop, removed validation rule-->
    <ValidationOp class="caw.pos.workorder.payment.CawValidateWorkOrderDepositOp" /> <!-- BZ27192-->
    <OpChainRoute chainKey="ISSUE_WORK_ORDER_REFUND" />
    <Op class="dtv.pos.workorder.account.CompleteWorkOrderAccountOp" />
  </OpChain>
  <!-- Begin BZ27378 -->
  <OpChain name="CAW_PICKUP_WORK_ORDER" signal="TransactionModified">
    <Op class="caw.pos.workorder.op.CawRetrieveLatestTransaction" />
    <Op class="dtv.pos.workorder.pickup.SetWorkOrderPickupListOp" />
    <Op class="dtv.pos.customer.account.op.UpdateItemStatusPickedOp" />
    <Op class="caw.pos.workorder.pickup.CawAddWorkOrderPickupTenderOp" />
    <Op class="dtv.pos.workorder.pickup.CreatePickupTenderWorkOrderLineItemOp" />
    <Op class="dtv.pos.customer.account.op.CreateCustAcctActivityOp" />
    <Op class="caw.pos.workorder.pickup.CawUpdateSaleTypeOp" />
    <Op class="caw.pos.workorder.pickup.CawUpdateDAOWorkOrderOp" />
    <OpChainRoute chainKey="WO_BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  
  <OpChain name="CAW_CANCEL_WORK_ORDER" signal="TransactionModified">
    <PromptOp class="dtv.pos.workorder.account.PromptCancelWorkOrderAcctConfirmationOp" />
    <PromptOp class="caw.pos.register.returns.CawPromptVerifiedReturnReasonCodeOp" />
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /> <!-- BZ32436 -->
    <Op class="caw.pos.workorder.account.CawWorkOrderRetrieveAccount" />
    <Op class="caw.pos.workorder.op.CawRetrieveLatestTransaction" />
    <Op class="dtv.pos.workorder.account.CancelWorkOrderAccountOp" />
    <OpChainRoute chainKey="ISSUE_WORK_ORDER_REFUND" />
    <Op class="caw.pos.customer.account.op.CawAddCancelledAccountToPersistablesBagOp" />  <!-- BZ27256 -->
    <Op class="caw.pos.workorder.op.CawRemoveWorkOrderLineItemsOp" />
    <Op class="caw.pos.workorder.item.CawSaveWOItemAttributesOp" /> <!-- BZ27712: save work order item attributes as property -->
    <OpChainRoute chainKey="PRE_TENDERING" chainType="START" /><!-- BZ27287-->
  </OpChain>
  <!-- End BZ27378 -->
  <!-- Begin BZ27193, BZ27264 -->
  <OpChain name="CAW_PICKUP_WORK_ORDER_NO_DEPOSIT" signal="TransactionModified">
    <Op class="caw.pos.workorder.op.CawUpdateNewToReadyToPickupStateOp" />
    <Op class="dtv.pos.workorder.pickup.SetWorkOrderPickupListOp" />
    <Op class="dtv.pos.customer.account.op.UpdateItemStatusPickedOp" />
    <!-- Begin BZ27258 -->
    <ValidationOp class="caw.pos.workorder.payment.CawValidateWOCompletedWithoutDepositOp" />
    <!-- End BZ27258 -->
    <Op class="dtv.pos.workorder.pickup.CreatePickupTenderWorkOrderLineItemOp" />
    <Op class="dtv.pos.customer.account.op.CreateCustAcctActivityOp" />
    <Op class="caw.pos.workorder.pickup.CawUpdateSaleTypeOp" />
    <OpChainRoute chainKey="WO_BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  <!-- End BZ27193, BZ27264 -->
  
  <OpChain name="WO_BACKTO_SALE_ITEM" signal="TransactionModified">
    <OpChainRoute chainKey="BACKTO_SALE_ITEM_START.local" />
    <Op class="dtv.pos.charity.VoidDonationLineItemOp" />
    <OpChainRoute chainKey="WO_SALE_ITEM_START" chainType="START" />
  </OpChain>
  
  <OpChain name="WO_SALE_ITEM_START" contextKey="WORK_ORDER_COMPLETE" rollbackChainKey="ROLLBACK_TRANS_PROMPT"
    rollbackLevel="10">
    <OpChainRoute chainKey="CAW_DISPLAY_INFO_TAB_MESSAGE" /><!-- BZ27339 -->
    <Op class="dtv.pos.hardware.op.ItemCustDisplayOp" />
    <PromptOp class="dtv.pos.register.sale.PromptItemScanOp" validationsBean="itemIdRules" contextKey="WORK_ORDER_COMPLETE" breakpoint="true" />
    <ValidationOp class="dtv.pos.coupon.LookupCouponFromItemIdOp" validationsBean="couponVerificationRules" />
    <Op class="dtv.pos.document.bounceback.op.LookupBounceBackCouponOp" />
    <ValidationOp class="caw.pos.register.sale.CawCheckItemNotOnFileOp" validationsBean="itemNotOnFileRules" />  <!-- BZ34226-->
    <ValidationOp validationsBean="sellingIdGroupRules" />
    <OpChainRoute chainKey="SALE_ITEM_AFTER_LOOKUP" />
  </OpChain>
  
  <OpChain name="WO_SALE_TENDER" rollbackChainKey="ROLLBACK_TENDER_PROMPT" rollbackLevel="50">
    <Op class="caw.pos.workorder.payment.CawRefreshDepositAmountDueOp" /><!-- BZ27264 -->
    <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
      <Parameter name="FILENAME" value="_instructionalTenderMsg" />
    </Op>
    <!-- this operation REQUIRES this context to be active so
         that if it needs to route a credit card event,
          it will be routed correctly -->
    <Op class="dtv.pos.tender.ProcessSavedTenderInputOp" contextKey="WO_TENDER" />
    <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
    <Op class="caw.pos.register.CawPromptTenderMenuOp"> <!-- BZ31521 -->
      <Parameter name="MenuKey" value="SALE::TENDER_OPTIONS" />
    </Op>
  </OpChain>
  
  <OpChain name="WO_VOID_LINE_ITEMS" signal="TransactionModified">
    <Op class="caw.pos.workorder.op.CawRemoveWorkOrderLineItemsOp" />
    <OpChainRoute chainKey="CAW_PRE_WORK_ORDER_CHAIN" chainType="START" />
  </OpChain>
  
  <OpChain name="ROLLBACK_TRANS_FINISH" signal="TransactionCancelled">
    <Op class="caw.pos.workorder.op.CawUpdateDepositStatusOp" />
    <OpChainRoute chainKey="ROLLBACK_TRANS_FINISH_IMPL" />
    <OpChainRoute chainKey="ROLLBACK_TRANS_FINISH.local" />
    <OpChainRoute chainKey="RESET_REGISTER" />
    <OpChainRoute chainKey="RESET_AFTER_TRANS" chainType="START" />
  </OpChain>
  
  <OpChain name="ISSUE_WORK_ORDER_REFUND">
    <Op class="caw.pos.workorder.op.CawCreateWorkOrderRefundItemOp" />
  </OpChain>
  <!-- Begin BZ27068 -->
  <!-- Removed -->
  <!-- End BZ27068 -->
  <!-- BZ26207 End Work Order Session -->
  
  <!-- BEGIN BZ26896 copied from base-->
  <!-- paid out  -->
  <OpChain name="PAID_OUT" signal="TransactionComplete" contextKey="TILL">
    <Op class="dtv.pos.register.itemmessages.ClearMsgOp" />
    <OpChainRoute chainKey="PRE_TRANS_TILL_VALIDATION" />
    <Op class="dtv.pos.hardware.op.UseIpCashDrawerAlwaysPromptOp" />
    <PromptOp class="dtv.pos.hardware.op.IpCashDrawerAlwaysScanOp" validationsBean="scanIpCashDrawerRules" breakpoint="true" />
    <Op class="dtv.pos.till.CheckCurrentSessionStatusOp">
      <Parameter name="AcceptedStatus" value="BEGINCOUNT" />
    </Op>
    <PromptOp class="dtv.pos.till.fundxfer.PromptPaidOutReasonCodeOp" breakpoint="true" />
    <!-- BEGIN BZ26896 -->
    <PromptOp class="dtv.pos.till.fundxfer.PromptFundXferAmountOp" breakpoint="true" validationsBean="cawFundXferAmountRules">
      <Parameter name="PromptKey" value="ENTER_FUND_TRANSFER_AMOUNT" />
    </PromptOp> 
    <PromptOp class="caw.pos.till.fundxfer.CawPromptFundXferAmountExceededOp" />
    <!-- END BZ26896 -->
    <OpChainRoute chainKey="CHECK_TILL_BALANCE" />
    <OpChainRoute chainKey="PAID_OUT.1.local" />
    <Op class="dtv.pos.hardware.op.AlwaysOpenCashDrawerOp" />
    <Op class="dtv.pos.till.fundxfer.CreatePaidOutTransactionOp">
      <Parameter name="persistOnReverse" value="true" />
    </Op>
    <OpChainRoute chainKey="PAID_OUT.2.local" />
    <Op class="dtv.pos.till.fundxfer.PopulatePaidOutTransactionOp" />
    <WorkerOp workersBean="updateCashDrawerIdWorkers" />
    <WorkerOp workersBean="persistTransAndObjWorkers" />
    <OpChainRoute chainKey="PAID_OUT.3.local" />
    <OpChainRoute chainKey="PRINT_RECEIPTS" />
    <PromptOp class="dtv.pos.hardware.op.WaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
    <!-- Flash sales update paid out -->
    <WorkerOp workersBean="populateFlashSalesTablesWorkers" />
    <WorkerOp workersBean="clearActiveCashDrawerWorkers" />
  </OpChain>
  <!-- END BZ26896 -->
  <!-- Begin BZ26879 -->
  <OpChain name="ADD_WARRANTIES_TO_HISTORY_TRANS_ITEM">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp" />
    <Op class="caw.pos.warranty.info.CawPromptLineToCoverFromHistoryTransOp" />
    <OpChainRoute chainKey="SELECT_WARRANTY_PLANS" />
  </OpChain>
  <!-- End BZ26879 -->

  <!-- Begin BZ26629 -->
  <OpChain name="LINE_ITEM_DISCOUNT" signal="TransactionModified">
    <ValidationOp validationsBean="itemInTransRules" />
    <PromptOp class="dtv.pos.register.GetSelectedSaleLineOp" validationsBean="saleItemModifyRules" />
    <ValidationOp validationsBean="discountRules" />
    <Op class="dtv.pos.hardware.op.ForceCurrentLineDisplayOp" />
    <PromptOp class="caw.pos.pricing.discount.CawPromptDiscountReasonOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptForAmountPercentOp" validationsBean="cawLineItemDiscountRules" /> <!-- BZ26851 -->
    <PromptOp class="dtv.pos.pricing.discount.PromptDiscountThresholdExceededOp" />
    <PromptOp class="dtv.pos.pricing.discount.ValidateDiscountCompatibilityOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptDiscountSerialNumberOp" validationsBean="nonNullSerialNumberRules" />
    <Op class="dtv.pos.pricing.discount.AddPriceModifierToTransactionOp" />
    <Op class="dtv.pos.pricing.discount.PlayDiscountSoundOp" />
    <PromptOp class="dtv.pos.pricing.discount.DisplayDiscountPromptOp" />
    <Op class="dtv.pos.sendsale.op.RouteSendSaleLineItemDiscOp" />
  </OpChain>
  
  <OpChain name="TRANSACTION_DISCOUNT" signal="TransactionModified">
    <ValidationOp validationsBean="transactionDiscountRules" />
    <PromptOp class="caw.pos.pricing.discount.CawPromptDiscountReasonOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptForAmountPercentOp" validationsBean="cawTransactionDiscountRules" /> <!-- BZ26851 -->
    <OpChainRoute chainKey="TRANSACTION_DISCOUNT_APPLY" />
  </OpChain>
  <!-- End BZ26629 -->

  <!-- Begin BZ26972 -->
  <OpChain name="ISSUE_GIFT_RECEIPT_PRINT_SELECTION">
    <!-- used by back office -->
    <ValidationOp validationsBean="reprintTransactionGiftReceiptRules" />
    <PromptOp class="dtv.pos.ejournal.giftrcpt.PromptForGiftReceiptItemsOp" validationsBean="giftReceiptLimitsRules">
      <Parameter name="ClearSelections" value="true" />
    </PromptOp>
    <Op class="dtv.pos.ejournal.giftrcpt.GroupGiftReceiptsOp" />
    <Op class="dtv.pos.ejournal.giftrcpt.AddMultipleGiftReceiptsOp" />
    <Op class="caw.pos.register.giftreceipt.CawAddGiftRcptSourcesOp"> <!-- BZ26972 -->
      <Parameter name="ReplaceExistingReceipts" value="true" />
    </Op>
    <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
    <Op class="dtv.pos.common.PersistObjectsOp" />
    <WorkerOp workersBean="emailRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
    <Op class="dtv.pos.register.giftreceipt.GiftReceiptClearSelectedItemsOp" />
    <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
    <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
  </OpChain>
  <OpChain name="GIFT_RECEIPT_REISSUE_SELECTION">
    <PromptOp class="dtv.pos.ejournal.PromptTransactionIdOp" validationsBean="transactionExistsRule" />
    <PromptOp class="dtv.pos.ejournal.giftrcpt.PromptForGiftReceiptItemsOp" validationsBean="giftReceiptLimitsRules">
      <Parameter name="ClearSelections" value="true" />
    </PromptOp>
    <Op class="dtv.pos.ejournal.giftrcpt.GroupGiftReceiptsOp" />
    <Op class="dtv.pos.ejournal.giftrcpt.AddMultipleGiftReceiptsOp" />
    <Op class="caw.pos.register.giftreceipt.CawAddGiftRcptSourcesOp"> <!-- BZ26972 -->
      <Parameter name="ReplaceExistingReceipts" value="true" />
    </Op>
    <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
    <WorkerOp workersBean="emailRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
    <Op class="dtv.pos.register.giftreceipt.GiftReceiptClearSelectedItemsOp" />
    <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
    <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
  </OpChain>
  <!-- End BZ26972 -->
  <!-- BZ26971 start -->
  <OpChain name="ROLLBACK_TENDER_PROMPT">
    <PromptOp class="caw.pos.tender.CawPromptRollbackTenderOp" />
  </OpChain>
  <!-- BZ26971 end -->

  <!-- Begin BZ25958 copied from XPAY_BALANCE_INQUIRY_MCR-->
  <OpChain name="CAW_SALE_XPAY_BALANCE_INQUIRY_MCR">
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" />
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="INQUIRE_BALANCE" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        
        <PromptOp class="caw.tenderauth.storedvalue.CawPromptVoucherForBalanceOp" key="GIFT_CARD_SERIAL_NEEDED_BALANCE" validationsBean="voucherNumberRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" />
        <Op class="caw.tenderauth.impl.eigen.op.CawSaleBalanceInquiryAuthorizeCardOp" />
        <Op class="caw.pos.util.CawCheckIsRegisterStateOp" /> <!-- BZ54208 -->
        <PromptOp class="caw.tenderauth.storedvalue.CawSaleDisplayBalanceOp" />
        <Op class="caw.tenderauth.storedvalue.CawGiftCardInActiveOp" />
        
  </OpChain>
  
  <OpChain name="CAW_SALE_XPAY_GIFT_CARD_ISSUE">
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="ISSUED" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <PromptOp class="dtv.pos.register.nonphysical.PromptVoucherAmtOp" validationsBean="voucherItemPriceRules" />
        
        <!-- Begin BZ27757 -->
        <Op class="caw.pos.register.nonphysical.CawCreateVoucherSaleLineItemOp">
          <Parameter name="SaleItemType" value="SALE" />
        </Op>
        <!-- End BZ27757 -->
        
  </OpChain>
  
  <OpChain name="CAW_SALE_XPAY_GIFT_CARD_RELOAD">
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="RELOAD" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <PromptOp class="dtv.pos.register.nonphysical.PromptVoucherAmtOp" validationsBean="cawVoucherItemPriceRules" />
        
        <!-- Begin BZ27757 -->
        <Op class="caw.pos.register.nonphysical.CawCreateVoucherGCReloadLineItemOp">
          <Parameter name="SaleItemType" value="SALE" />
        </Op>
        
  </OpChain>
  
  <OpChain name="CAW_PRINT_GIFT_CARD_RELOAD_BALANCE_RECEIPTS">
        <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
        <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
        <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
        <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
        <PromptOp class="caw.tenderauth.storedvalue.CawSaleDisplayBalanceOp" />
  </OpChain>
  
   <!-- Begin check balance to sale chain -->
  <OpChain name="CAW_BALANCE_INQUIRY_COME_REG_OPTION_INITIAL" signal="TransactionModified">
    <Op class="caw.tenderauth.impl.eigen.op.CawBalanceInquiryInitialStateOp" />
  </OpChain>
  
  <OpChain name="CAW_BALANCE_TO_SALE_VOUCHER_START" signal="TransactionModified">
    <PromptOp class="caw.pos.register.nonphysical.CawPromptSelectVoucherItemOp" /> <!-- BZ25958 -->
    <ValidationOp validationsBean="voucherTypeItemRules" />
    <OpChainRoute chainKey="CAW_BALANCE_TO_SALE_VOUCHER_FINISH" />
  </OpChain>
    
  <OpChain name="CAW_BALANCE_TO_SALE_VOUCHER_FINISH">
      <!-- BZ27627 remove caw.pos.hardware.op.CawRefreshMSRDeviceOp -->
      <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="RELOAD" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
      </Op>
      <PromptOp class="dtv.pos.register.nonphysical.PromptVoucherAmtOp" validationsBean="cawVoucherItemPriceRules" />
      
      <!-- Begin BZ27757 -->
      <Op class="caw.pos.register.nonphysical.CawCreateVoucherGCReloadLineItemOp">
          <Parameter name="SaleItemType" value="SALE" />
      </Op>
      <!-- End BZ27757 -->

      <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
      <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
      <OpChainRoute chainKey="SALE_VOUCHER_VALIDATE" />
      <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
      <Op class="dtv.pos.register.AddItemToSaleTranOp" />
      <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
      <OpChainRoute chainKey="SIGNAL_TRANSACTION_MODIFIED" />
      <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" />
      <OpChainRoute chainKey="SALE_TAXING" />
      <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
      <Op class="dtv.pos.common.PersistTranInProcessOp" />
      <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
  </OpChain>
  <!-- End check balance to sale chain -->
  <!-- Start Return Tender Gift Card chain -->
  <OpChain name="CAW_RETURN_STANDARD_TENDER_VOUCHER" signal="TransactionModified">
        <Op class="dtv.pos.tender.voucher.GatherVoucherTenderInformationOp" />
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" /><!-- BZ 24177 -->
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherNumberOp" validationsBean="voucherNumberTenderRules">
          <Parameter name="LineItemType" value="TENDER" />
        </PromptOp>
        <OpChainRoute chainKey="CAW_RETURN_XPAY_BALANCE_INQUIRY_MCR"/>
        <OpChainRoute>
            <Choice chainKey="CAW_RETURN_XPAY_GIFT_CARD_ISSUE" condition="caw.tenderauth.storedvalue.CawGatherVoucherInfoConditionOp" />
            <Choice chainKey="CAW_RETURN_XPAY_GIFT_CARD_RELOAD" condition="!caw.tenderauth.storedvalue.CawGatherVoucherInfoConditionOp" />
        </OpChainRoute>
        <Op class="caw.pos.tender.voucher.CawCreateVoucherTenderLineItemOp" />
        <ValidationOp validationsBean="tenderAvailabilityRules" />
        <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
        <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
        <PromptOp class="caw.pos.tender.voucher.CawPromptVoucherTenderAmtOp" validationsBean="cawVoucherTenderAmountRules" />
        <PromptOp class="dtv.pos.tender.cid.PromptGiftCardCidOp" validationsBean="cidRules" />
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" validationsBean="voucherPinRules" />
        <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
        <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
        <Op class="caw.pos.util.CawCheckIsNotMCROpChainOp" />
        <OpChainRoute chainKey="SALE_VOUCHER_AUTHORIZE" /><!-- BZ26978 -->
        <OpChainRoute chainKey="CAPTURE_SALE_TENDER_SIGNATURE" />
        <OpChainRoute chainKey="CAW_GIFT_CARD_REFUND_TENDER" />
        <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <OpChain name="CAW_RETURN_XPAY_GIFT_CARD_ISSUE">
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="ISSUED" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <!-- BEGIN BZ32517 -->
        <PromptOp class="caw.pos.register.nonphysical.CawPromptReturnSelectVoucherItemOp" />
        <ValidationOp validationsBean="voucherTypeItemRules" />
        <!-- END BZ32517 -->
  </OpChain>
  <OpChain name="CAW_RETURN_XPAY_GIFT_CARD_RELOAD">
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="RELOAD" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
  </OpChain>
  <OpChain name="CAW_RETURN_XPAY_BALANCE_INQUIRY_MCR">
        <Op class="caw.pos.hardware.op.CawRefreshMSRDeviceOp" longRunning="true" />
        <Op class="caw.pos.util.CawCheckIsMCROpChainOp" />
        <Op class="dtv.tenderauth.storedvalue.GatherVoucherInfoOp">
          <Parameter name="VoucherActivityCodeType" value="INQUIRE_BALANCE" />
          <Parameter name="VoucherType" value="XPAY_GIFT_CARD" />
        </Op>
        <PromptOp class="dtv.tenderauth.storedvalue.PromptForPINOp" />
        <Op class="caw.tenderauth.impl.eigen.op.CawSaleBalanceInquiryAuthorizeCardOp" />
        <PromptOp class="caw.tenderauth.storedvalue.CawSaleDisplayBalanceOp" />
  </OpChain>
  <!-- End Return Tender Gift Card chain -->
  <!-- End BZ25958 -->
  <!-- Begin BZ26978 -->
  <OpChain name="TRANSACTION_COMPLETE" signal="TransactionComplete">
   <Op class="caw.pos.register.CawPrintGiftCardReceiptOp" />
    <WorkerOp workersBean="completeTransactionWorkers" />
    <Op class="dtv.pos.tender.creditcard.PrepareImprintCreditCardOp" />
    <Op class="dtv.pos.hardware.op.BuildTenderFrankingsOp" />
    <Op class="dtv.pos.hardware.op.FrankTendersOp" />
    <Op class="dtv.pos.hardware.op.OpenCashDrawerOp" />
    <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
    <WorkerOp workersBean="updateCashDrawerIdWorkers" />
    <WorkerOp workersBean="persistTransAndObjWorkers" />
    <WorkerOp workersBean="emailRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
    <WorkerOp workersBean="saveRcptsWorkers" />
    <WorkerOp workersBean="persistSystemTotalWorkers" />
    <WorkerOp workersBean="persistVoucherHistoryWorkers" />
    <PromptOp class="dtv.pos.hardware.op.WaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
    <Op class="dtv.pos.till.NotifyTenderMaxValueInTillOp" />
    <Op class="dtv.pos.till.NotifyTenderMinValueInTillOp" />
    <OpChainRoute chainKey="RESET_REGISTER" />
    <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
    <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
  </OpChain>
  <!-- End BZ26978 -->
  
  <!-- Begin BZ27192 -->
  <OpChain name="CAW_ADD_WORK_ORDER_DEPOSIT_ITEM" signal="TransactionModified">
    <ValidationOp validationsBean="workOrderSellingIdGroupRules" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
    <Op class="dtv.pos.register.AddItemToSaleTranOp" />
    <Op class="dtv.pos.customer.account.op.AddCustomerAccountModifierOp" />
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <WorkerOp workersBean="addTransDiscountsToNewItemWorkers" />
    <!-- <OpChainRoute chainKey="SALE_TAXING" /> -->
    <Op class="dtv.pos.workorder.item.CreateWorkOrderDetailOp" />
    <Op class="dtv.pos.customer.account.op.CreateCustAcctActivityOp" />
    <OpChainRoute chainKey="CAW_REFRESH_REGISTER_WORK_ORDER_DATA" />
  </OpChain>
  
  <OpChain name="CAW_REFRESH_REGISTER_WORK_ORDER_DATA">
    <Op class="caw.pos.workorder.op.CawDisplayWorkOrderAcctFormOp" />
  </OpChain>
  <!-- End BZ27192 -->
  <!-- Begin BZ27243 -->
  <OpChain name="CAW_WORK_ORDER_DEPOSIT_PRE_TENDER" signal="TransactionModified">
    <Op class="dtv.pos.workorder.validation.ValidateNewWorkOrderAccountPreTenderOp" />
    <OpChainRoute chainKey="CAW_WORK_ORDER_DEPOSIT_COMPLETE" />
    <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
    <OpChainRoute chainKey="PRE_TENDERING" chainType="START" />
  </OpChain>
  
  <OpChain name="CAW_WORK_ORDER_DEPOSIT_COMPLETE" signal="TransactionModified">
    <ValidationOp validationsBean="workOrderItemsRules" />
    <ValidationOp validationsBean="totalNumberPartTaskRules" />
    <PromptOp class="dtv.pos.workorder.payment.PromptWorkOrderDepositAmountOp" breakpoint="true" />
    <PromptOp class="caw.pos.workorder.common.CawWorkOrderMaxDepositRules" /> 
    <ValidationOp class="caw.pos.workorder.payment.CawValidateWorkOrderDepositOp" />
    <Op class="dtv.pos.workorder.account.CompleteWorkOrderAccountOp" />
  </OpChain>
  <!-- End BZ27243 -->

  <!-- Begin BZ27245 copied from base-->
  <OpChain name="ADD_WORK_ORDER_ITEM" signal="TransactionModified">
    <ValidationOp validationsBean="workOrderSellingIdGroupRules" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
    <Op class="dtv.pos.register.AddItemToSaleTranOp" />
    <Op class="caw.pos.workorder.item.CawSaveWOItemAttributesOp" /> <!-- BZ27712: save work order item attributes as property -->
    <Op class="dtv.pos.commission.UpdateCommModifierOp" /><!-- BZ30154 -->
    <Op class="dtv.pos.customer.account.op.AddCustomerAccountModifierOp" />
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <WorkerOp workersBean="addTransDiscountsToNewItemWorkers" />
    <OpChainRoute chainKey="SALE_TAXING" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddDiscountOp" />  <!-- BZ27286 -->
    <Op class="dtv.pos.workorder.item.CreateWorkOrderDetailOp" />
    <Op class="dtv.pos.customer.account.op.CreateCustAcctActivityOp" />
    <!-- Begin BZ27248 -->
     <OpChainRoute chainKey="CAW_WORK_ORDER_ATTACHED_WARRANTY" condition="caw.pos.workorder.op.CawWorkOrderAttachedWarrantyConditionOp"/>
    <!-- End BZ27248 -->
    <!-- Begin BZ29625 -->
    <PromptOp class="caw.pos.advance.prompting.CawItemMessagePromptOp"/> -->
    <!-- End BZ29625 -->
    <OpChainRoute chainKey="CAW_REFRESH_REGISTER_WORK_ORDER_DATA" /><!-- BZ27245 Checked-->
  </OpChain>
  <!-- End BZ27245 -->
  <!-- Begin BZ27286 -->
  <OpChain name="CAW_LINE_ITEM_DISCOUNT">
    <Op class="dtv.pos.hardware.op.ForceCurrentLineDisplayOp" />
    <Op class="dtv.pos.pricing.discount.AddPriceModifierToTransactionOp" />
    <Op class="dtv.pos.pricing.discount.PlayDiscountSoundOp" />
    <PromptOp class="dtv.pos.pricing.discount.DisplayDiscountPromptOp" />
    <Op class="dtv.pos.sendsale.op.RouteSendSaleLineItemDiscOp" />
  </OpChain>
  <!-- End BZ27286 -->
  
  <!-- Begin BZ27248 -->
  <OpChain name="CAW_WORK_ORDER_ATTACHED_WARRANTY">
    <OpChainRoute chainKey="CAW_WORK_ORDDER_SELECT_WARRANTY_PLANS_SETUP" />
    <Op class="dtv.pos.warranty.common.RunCoveredLineItemChainOp">
      <Parameter name="ChainKey" value="CAW_WO_SALE_WARRANTY_FINISH" />
    </Op>
  </OpChain>
  
  <OpChain name="CAW_WORK_ORDDER_SELECT_WARRANTY_PLANS_SETUP">
    <Op class="dtv.pos.warranty.common.SetupWarrantyParamsOp">
      <Parameter name="WARRANTY_TYPE_CODE" value="WARRANTY" />
    </Op>
    <Op class="dtv.pos.warranty.common.SetupWarrantyItemDataOp">
      <Parameter name="CLEAR_ITEM" value="false" />
    </Op>
    <OpChainRoute chainKey="CAW_WO_SELECT_WARRANTY_PLANS" />
  </OpChain>
  
  <OpChain name="CAW_WO_SELECT_WARRANTY_PLANS">
    <Op class="dtv.pos.warranty.common.ForceCoveredItemLineDisplayOp" />
    <Op class="caw.pos.workorder.op.CawWorkOrderAddWarrantyItemOp" />
  </OpChain>
  
  <OpChain name="CAW_WO_SALE_WARRANTY_FINISH" signal="TransactionModified">
    <Op class="dtv.pos.warranty.common.WarrantyItemIteratingOp">
      <Parameter name="ChainKey" value="CAW_WO_SALE_WARRANTY_FINISH_ITERABLE" />
    </Op>
  </OpChain>
  <OpChain name="CAW_WO_SALE_WARRANTY_FINISH_ITERABLE" signal="TransactionModified">
    <Op class="caw.pos.warranty.common.CawCreateWarrantyLineOp"><!-- BZ28271 -->
      <Parameter name="SALE_ITEM_TYPE" value="SALE" />
      <Parameter name="RETURN_MODE" value="false" />
      <Parameter name="FORCE_ZERO_EXT_PRICE" value="false" />
      <Parameter name="SALE_LINE_ITEM_TYPE_CODE" value="WORK_ORDER" /><!-- BZ28271 -->
    </Op>
    <Op class="dtv.pos.warranty.common.SetupWarrantyLineAsCurrentOp" />
    <Op class="dtv.pos.warranty.common.RunWarrantyItemChainOp">
      <Parameter name="ChainKey" value="CAW_WO_SALE_WARRANTY_FINISH_IMPL" />
    </Op>
  </OpChain>
  <OpChain name="CAW_WO_SALE_WARRANTY_FINISH_IMPL">
    <Op class="dtv.pos.register.AddItemToSaleTranOp" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" /><!-- BZ30084 -->
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" /><!-- BZ29884 -->
    <Op class="dtv.pos.commission.UpdateCommModifierOp" /><!-- BZ30154 -->
    <OpChainRoute chainKey="SALE_TAXING" /> <!-- BZ29288 -->
    <OpChainRoute chainKey="CAW_WO_CREATE_WARRANTY" /><!-- BZ29879 -->
    <Op class="dtv.pos.workorder.item.CreateWorkOrderDetailOp" />
    <Op class="dtv.pos.customer.account.op.CreateCustAcctActivityOp" />
  </OpChain>
  
  <!-- End BZ27248 -->

  <!-- BEGIN BZ29879 -->
  <OpChain name="CAW_WO_CREATE_WARRANTY">
    <Op class="dtv.pos.warranty.common.AddCoverageAssociationOp" />
    <Op class="dtv.pos.warranty.common.CreateWarrantyOp" /><!-- BZ29884 -->
    <OpChainRoute chainKey="CAW_WO_ADD_WARRANTIES" />
    <OpChainRoute chainKey="CAW_WO_UPDATE_WARRANTIES" />
  </OpChain>
  <OpChain name="CAW_WO_ADD_WARRANTIES">
    <Op class="dtv.pos.warranty.common.AddWarrantyModifierOp" />
    <Op class="dtv.pos.warranty.common.AddWarrantyLineListenerOp" />
    <Op class="dtv.pos.warranty.common.AddWarrantiesToManagerOp" />
  </OpChain>
  <OpChain name="CAW_WO_UPDATE_WARRANTIES">
    <Op class="dtv.pos.warranty.change.UpdateWarrantyLineOp" />
    <Op class="dtv.pos.warranty.change.UpdateWarrantiesOp" />
    <Op class="dtv.pos.warranty.change.UpdateWarrantyLineQtyOp" />
  </OpChain>
  <!-- END BZ29879 -->
  
  <!-- Begin BZ27294 -->
  <OpChain name="CAW_WORK_ORDER_REFUND_TENDER" rollbackChainKey="ROLLBACK_TENDER_PROMPT" rollbackLevel="50">
    <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
      <Parameter name="FILENAME" value="_instructionalTenderReturnMsg" />
    </Op>
    <Op class="dtv.pos.hardware.op.SubtotalCustomerDisplayOp" />
    <Op class="caw.pos.register.CawPromptTenderMenuOp">
      <Parameter name="MenuKey" value="CAW_WORK_ORDER_RETURN::TENDER_OPTIONS" />
    </Op>
  </OpChain>
  <!-- End BZ27294 -->
  <!-- Begin BZ27586 -->
  <OpChain name="ROLLBACK_TRANS_FINISH_IMPL">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp"/>
    <WorkerOp workersBean="calculateTlogSequenceWorkers" />
    <Op class="dtv.pos.customer.award.VoidAwardsFromTransactionOp" />
    <Op class="dtv.pos.customer.loyalty.VoidLoyaltyPurchaseFromTransactionOp" />
    <Op class="dtv.pos.coupon.VoidAuthorizedCouponsOp" />
    <WorkerOp workersBean="completeCancelTransWorkers" />
    <WorkerOp workersBean="persistTransAndObjWorkers" />
    <Op class="dtv.pos.hardware.op.BuildRcptsOp" />
    <WorkerOp workersBean="emailRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.PrintRcptsOp" />
    <WorkerOp workersBean="saveRcptsWorkers" />
    <Op class="dtv.pos.hardware.op.WaitForRcptPrintOp" required="false" />
    <OpChainRoute chainKey="PRINT_FISCAL_RECEIPTS.local" />
  </OpChain>
  <!-- End BZ27586 -->
  <!-- BZ27670 start -->
  <OpChain name="SECURITY_AUTHENTICATE">
    <Op class="dtv.pos.hardware.biometric.fingerprint.op.EnableFingerprintReaderIdentityOp" />
    <OpChainRoute>
      <Choice chainKey="SECURITY_AUTHENTICATE_BY_PROMPT" condition="dtv.pos.security.ShowUserIdAndPasswordAsPromptsCondition" />
      <Choice chainKey="SECURITY_AUTHENTICATE_BY_FORM" />
    </OpChainRoute>
    <Op class="dtv.pos.security.op.AuthenticateUserOp" />
    <PromptOp class="dtv.pos.security.op.ForcePasswordChangeOp" />
    <PromptOp class="caw.pos.security.op.CawNotifyBadAuthenticationOp" />
  </OpChain>
  <!-- BZ27670 end -->

  <!-- Begin BZ27339 -->
  <OpChain name="CAW_CUSTOMER_MEMBERSHIP_TAB_MSG">
    <Op class="caw.pos.customer.membership.CawCustomerMembershipInfoOp" />
  </OpChain>
  <OpChain name="CAW_DISPLAY_INFO_TAB_MESSAGE">
    <OpChainRoute>
      <Choice chainKey="EXCHANGE_TRNSACTION_TOTAL_LESS_THAN_ZERO_MSG" condition="dtv.pos.register.sale.condition.IsExchangeTransactionTotalLessThanZero" />
      <Choice chainKey="TRANSACTION_TOTAL_IS_GREATER_THAN_CONFIGURED_AMOUNT_MSG" condition="dtv.pos.register.sale.condition.IsTotalGreaterThanConfiguredAmount" />
      <Choice chainKey="USER_INPUT_IS_DISABLED_MSG" condition="dtv.pos.register.condition.IsInputDisabled" />
      <Choice chainKey="DISPLAY_REGULAR_MSG" condition="caw.pos.customer.membership.CawHasCutomerCondition" /><!-- BZ27339 -->
      <Choice chainKey="CAW_CUSTOMER_MEMBERSHIP_TAB_MSG" /><!-- BZ27339 -->
    </OpChainRoute>
  </OpChain>
  <OpChain name="DISPLAY_RETURN_INFO_TAB_MESSAGE">
    <OpChainRoute>
      <Choice chainKey="EXCHANGE_TRNSACTION_TOTAL_LESS_THAN_ZERO_MSG" condition="dtv.pos.register.sale.condition.IsExchangeTransactionTotalLessThanZero" />
      <Choice chainKey="TRANSACTION_TOTAL_IS_GREATER_THAN_CONFIGURED_AMOUNT_MSG" condition="dtv.pos.register.sale.condition.IsTotalGreaterThanConfiguredAmount" />
      <Choice chainKey="CAW_CUSTOMER_MEMBERSHIP_TAB_MSG" />
    </OpChainRoute>
  </OpChain>
  <!-- End BZ27339 -->
  
  <!-- Begin BZ25761 Session, BZ29333: revert to old Customer Maintenance Form -->
  <OpChain name="CAW_GOOD_SAM_CUSTOMER_MAINTENANCE_EDIT">
    <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawGoodSamFlagOp" />
    <OpChainRoute chainKey="CUST_ASSOCIATION_EDIT" />
  </OpChain>
  <!-- End BZ25761 Session, BZ29333 -->
  
  <!-- BEGIN BZ25762 -->
  <OpChain name="CAW_GOOD_SAM_ACCOUNT_LOOKUP">
    <Op class="caw.pos.common.CawRefreshPinpadScreenOp" /> <!-- BZ29383 -->
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawBeginGSAccountLookup" />
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawGSAccountLookupOp" longRunning="true" />
    <!-- Begin BZ29372 -->
    <OpChainRoute chainKey="CAW_GOOD_SAM_ACCOUNT_LOOKUP_CONFIRM" />
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawAccountLookupValidationOp" />
    <!-- END BZ29372 -->
  </OpChain>
  
  <!-- Begin BZ29372 -->
  <OpChain name="CAW_GOOD_SAM_ACCOUNT_LOOKUP_CONFIRM">
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawGSAccountConfirmOp" />
  </OpChain>
  <!-- END BZ29372 -->
  
  <OpChain name="CAW_GOOD_SAM_ACCOUNT_NOT_FOUND">
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawGSAccountNotFoundOp" />
  </OpChain>
  <!-- END BZ25762 -->
  
  <!-- BEGIN BZ27973 -->
  <OpChain name="CAW_GOOD_SAM_ACCOUNT_PAYMENT" signal="TransactionModified">
    <Op class="caw.pos.common.CawRefreshPinpadScreenOp" /> <!-- BZ29383 -->
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawBeginGSAccountLookup" />
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawCustomerCardPresentConfirmOp" />
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawAccountGSInfoOp" />
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawAccountPaymentAmountOp" validationsBean="cawAccountPaymentCheckAmountRules"/><!-- BZ29443 -->
    <Op class="caw.tenderauth.impl.eigen.accountpayment.op.CawAddAccountPaymentItemOp" />
    <OpChainRoute chainKey="SALE_ITEM_ADD" />
  </OpChain>
  
  <OpChain name="CAW_GS_CARD_NOT_PRESENT" signal="TransactionModified">
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawAccountPaymentLookupOp" />
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawAccountGSInfoOp" />
    <PromptOp class="caw.tenderauth.impl.eigen.accountpayment.op.CawAccountPaymentAmountOp" validationsBean="cawAccountPaymentCheckAmountRules" /><!-- BZ29443 -->
    <Op class="caw.tenderauth.impl.eigen.accountpayment.op.CawAddAccountPaymentItemOp" />
    <OpChainRoute chainKey="SALE_ITEM_ADD" />
  </OpChain>
  <!-- END BZ27973 -->
  
  <!-- BEGIN BZ29134 -->
  <OpChain name="CAW_GOOD_SAM_THREE_FAILED_ATTEMPTS_SSN">
    <Op class="caw.tenderauth.impl.eigen.accountlookup.op.CawGSAccountThreeFailedAttemptsSSNOp" />
  </OpChain>
  <!-- END BZ29134 -->
  
  <!-- BEGIN BZ29590 -->
  <OpChain name="CAW_TENDER_GOOD_SAM_VISA_CARD" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
    <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawApplyGSDealOp" />
    <!-- <Op class="dtv.pos.tender.CreateTenderLineItemOp"> --> <!-- Replaced by BZ31568 -->
    <Op class="caw.pos.tender.CawCreateTenderLineItemOp"> <!-- BZ31568 -->
      <Parameter name="TenderStatus" value="Tender" />
      <Parameter name="TenderId" value="GSVISA" />
    </Op>
    <PromptOp class="caw.pos.tender.CawCreditCardPromptTenderAmtOp" validationsBean="tenderAmountRules" /> <!-- BZ29683 -->
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  
  <OpChain name="CAW_TENDER_GOOD_SAM_PLCC_CARD" signal="TransactionModified" contextKey="SALE_TENDER_EMPTY_MENU_OPTION">
    <Op class="caw.tenderauth.impl.eigen.goodsam.op.CawApplyGSDealOp" />
    <!-- <Op class="dtv.pos.tender.CreateTenderLineItemOp"> --> <!-- Replaced by BZ31568 -->
    <Op class="caw.pos.tender.CawCreateTenderLineItemOp"> <!-- BZ31568 -->
      <Parameter name="TenderStatus" value="Tender" />
      <Parameter name="TenderId" value="GSPLCC" />
    </Op>
    <PromptOp class="caw.pos.tender.CawCreditCardPromptTenderAmtOp" validationsBean="tenderAmountRules" /> <!-- BZ29683 -->
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <Op class="dtv.tenderauth.impl.op.AuthorizeTenderOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
    <Op class="dtv.pos.assistance.NotifyTrainingTenderAuthOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!-- END BZ29590 -->
  <!-- BEGIN BZ29683 -->
  <OpChain name="CAW_VOID_GS_DEAL" signal="TransactionModified">
    <Op class="caw.tenderauth.impl.eigen.op.CawVoidCouponGSVisaOp"/>
  </OpChain>
  <!-- END BZ29683 -->
  <OpChain name="ADD_RETURN_ITEM_TO_TRAN" signal="TransactionModified">
    <Op class="dtv.pos.register.tax.ext.op.SetLineItemTaxSystemLocationOp" />
    <Op class="dtv.pos.register.returns.AddReturnItemToSaleTranOp" />
    <Op class="dtv.pos.register.returns.CopyCrossChannelTransPropertiesOp" />
    <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
    <!-- Begin BZ29625 -->
    <PromptOp class="caw.pos.advance.prompting.CawItemMessagePromptOp"/>
    <!-- End BZ29625 -->
    <Op class="caw.pos.register.returns.verification.CawUpdateReturnPriceModsOp" /> <!-- BZ32239 -->
    <OpChainRoute chainKey="SALE_TAXING" />
    <Op class="dtv.pos.register.returns.verification.UpdateVerifiedReturnTaxOp" />
    <Op class="dtv.pos.register.returns.AddRestockingFeeOp" />
    <Op class="dtv.pos.kits.returns.CopyKitComponentModifiersOp" />
    <Op class="dtv.pos.kits.inventory.HandleKitComponentInventoryOp" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
  </OpChain>
  <!-- BEGIN BZ30267 -->
  <OpChain name="SECURITY_AUTHENTICATE_BY_FORM">
    <Op class="caw.pos.security.op.CawPromptIdPasswordFormOp" />
  </OpChain>
  <!-- END BZ30267 -->
  <!-- BEGIN BZ29291 -->
  <OpChain name="RESUME_TRANSACTION">
    <PromptOp class="caw.pos.register.suspendresume.CawPromptSuspendedTransOp" />
    <ValidationOp validationsBean="resumeTransactionRules" />
    <OpChainRoute chainKey="RESUME_TRANSACTION_IMPL" />
    <Op class="caw.pos.cheetah.CawUpdateLoyaltyFlagForFreeGS" /> <!-- BZ59418 -->
    <!-- BEGIN BZ62036  --> 
    <Op class="caw.pos.agis.op.CawAGISPitchesLoadDataOp"/>
    <Op class="caw.pos.register.suspendresume.CawAGISLoadPitchesFromSuspendOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesFormsOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesReloadForms" />
    <Op class="caw.pos.agis.op.CawAGISPitchesVoidAddedItemOp" />
    <OpChainRoute chainKey="CAW_AGIS_REVERT_PRICE" condition="caw.pos.agis.op.CawAGISVoidItemUpdateRunCondition"/><!-- BZ62148 -->
    <Op class="caw.pos.agis.op.CawAGISPitchesAddItemOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesRemoveMembershipItemPitchesOp" /> <!-- BZ62216, BZ62036 -->
    <Op class="caw.pos.customer.CawRefreshCustMembershipOp" /> <!-- BZ62987 -->
    <!-- END BZ62036 -->
    <OpChainRoute chainKey="BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  <OpChain name="RESUME_TRANSACTION_AIRSIDE">
    <PromptOp class="caw.pos.register.suspendresume.CawPromptSuspendedTransOp" breakpoint="true" />
    <OpChainRoute chainKey="AIRPORT_RESUME_TRANSACTION" condition="dtv.pos.flight.AirsideEnabledCondition" />
    <OpChainRoute chainKey="RESUME_TRANSACTION_IMPL" />
    <Op class="dtv.pos.flight.op.ReBuildAirportTabOp"/>
    <Op class="caw.pos.cheetah.CawUpdateLoyaltyFlagForFreeGS" /> <!-- BZ59418 -->
    <OpChainRoute chainKey="BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  <!-- END BZ29291 -->
  <!-- BEGIN BZ28014 -->
  <OpChain name="CAW_PRE_SALE">
    <Op class="caw.pos.register.CawInitializationDealMap" />
  </OpChain>
  <OpChain name="PRE_SALE_TRANSACTION" contextKey="PRE_SALE" rollbackChainKey="ROLLBACK_TRANS_PROMPT">
    <!-- <OpChainRoute chainKey="CAW_PROCESS_CATALYST_0" condition="caw.pos.advance.prompting.CawProcessCatalystBeginCondition" /> BZ61159 remove this opponent--> <!--  BZ33231 -->
    <OpChainRoute chainKey="CAW_PRE_SALE" />
    <OpChainRoute chainKey="PRE_TRANS_TILL_VALIDATION" />
    <Op class="dtv.pos.register.PreSaleTransactionOp" />
    <Op class="dtv.pos.register.itemmessages.DisplayInstructionsOp">
      <Parameter name="FILENAME" value="_instructionalMsg" />
    </Op>
    <Op class="dtv.pos.register.giftreceipt.GiftReceiptClearSelectedItemsOp" />
    <Op class="dtv.pos.security.op.StartAutoLogoutTimerOp" />
    <ValidationOp validationsBean="isNotInUpdateRequiredPeriodValidations"/>
    <OpChainRoute chainKey="PRE_TRANS_COMMISSIONED_ASSOCIATES" condition="!dtv.pos.commission.CommissionByItem" />
    <WorkerOp workersBean="registerWorkstationActiveWorkers"/>
    <!-- AIRSIDE CHAIN -->
    <OpChainRoute chainKey="AIRPORT_PRE_SALE" condition="dtv.pos.flight.AirsideEnabledCondition"/>
    <Op class="dtv.pos.common.TransactionPropertyPromptOp">
      <Parameter name="TransactionState" value="PRE_SALE" />
      <Parameter name="PromptWithoutSaleLines" value="true" />
    </Op>
    <OpChainRoute chainKey="PRE_SALE.1" />
    <Op class="dtv.pos.customer.RunCustAssociationChainOp" />
    <Op class="dtv.pos.register.HideCustomerInformationPanelOp" />
    <Op class="dtv.pos.register.RouteSalesChainFromConfigOp" contextKey="SALE" />
  </OpChain>
  <!-- END BZ28014 -->
  <!-- BEGIN BZ30922 -->
    <OpChain name="GENERIC_ITEM_LOOKUP">
        <Op class="caw.pos.inventory.lookup.CawItemSearchOp" breakpoint="true" />
        <Op class="caw.pos.inventory.lookup.CawDisplayFoundPriceItemOp" breakpoint="true" />
    </OpChain>
   <!-- END BZ30922 -->
   
   <!-- BEGIN BZ31759 -->
    <OpChain name="GENERIC_ITEM_LOOKUP_NON_INV">
        <Op class="dtv.pos.inventory.lookup.DisplayFoundItemOp" breakpoint="true" />
    </OpChain>
    <!-- END BZ31759 -->

    <!-- BEGIN BZ27535 -->
    <OpChain name="APPLY_CUST_TAX_EXEMPT">
        <PromptOp class="caw.pos.register.tax.CawPromptApplyTransTaxExemptionOp" breakpoint="true" />
        <PromptOp class="caw.pos.register.tax.CawPromptTransTaxExemptionOp" breakpoint="true" />
        <PromptOp class="dtv.pos.register.tax.PromptTaxExemptReasonOp" />
   </OpChain>
   <!-- END BZ27535 -->
   
  <!-- BEGIN BZ33305 -->
  <OpChain name="SELECT_WARRANTY_PLANS">
    <Op class="dtv.pos.warranty.common.ForceCoveredItemLineDisplayOp" />
    <PromptOp class="caw.pos.warranty.info.CawPromptWarrantyPlanOp" breakpoint="true" />
    <OpChainRoute chainKey="ENTER_NEW_WARRANTY_INFO" />
  </OpChain>
  
  <OpChain name="VERIFIED_RETURN_ITEM_IMPL">
    <ValidationOp validationsBean="allowItemVerifiedReturnRules" />
    <ValidationOp class="dtv.pos.register.returns.ValidateReturnItemPriceOp" validationsBean="returnOrigPriceRules" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnItemSerialNumberOp" validationsBean="returnSerialNumberRules" />
    <Op class="dtv.pos.register.KitComponentIteratingOp">
      <Parameter name="ChainKey" value="VERIFIED_RETURN_KIT_COMPONENT_SERIAL_NUMBER" />
    </Op>
    <ValidationOp class="dtv.pos.register.returns.verification.ValidateVoucherAlreadyOnTransOp" validationsBean="returnVoucherOnTransRules" />
    <Op class="dtv.pos.register.returns.MatchSerializedReturnItemOp" />
    <Op class="dtv.pos.register.returns.verification.ValidateReturnItemOp" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" validationsBean="itemDescriptionRules" />
    <PromptOp class="dtv.pos.register.returns.verification.PromptReturnVerificationItemQuantityOp" validationsBean="allowVerifiedReturnInputQtyRules" />
    <PromptOp class="caw.pos.warranty.returns.CawPromptReturnWarrantiesOp" validationsBean="returnVerifiedWarrantyRules" /> <!-- BZ33305 -->
    <ValidationOp class="dtv.pos.register.returns.verification.ValidateTotalReturnPriceNewVerifiedItemOp" validationsBean="returnNewItemPriceRules" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
    <Op class="dtv.pos.register.returns.verification.UpdateVerifiedReturnLineOp" />
    <Op class="dtv.pos.register.returns.verification.UpdateVerifiedReturnVoucherOp" />
    <Op class="dtv.pos.register.returns.verification.RouteReturnVerificationOp" />
    <Op class="dtv.pos.kits.returns.UpdateReturnKitComponentsQtyOp" />
    <Op class="dtv.pos.kits.inventory.HandleKitComponentInventoryOp" />
    <Op class="dtv.pos.register.returns.verification.CompleteReturnVerificationOp" />
  </OpChain>
  <!-- END BZ33305 -->
   
  <!-- BEGIN BZ32142 -->
  <OpChain name="ENTER_NEW_WARRANTY_INFO">
    <Op class="dtv.pos.warranty.info.EnsureWarrantyCustomerAssignedOp" />
    <PromptOp class="dtv.pos.warranty.info.PromptNewWarrantyNumberOp" validationsBean="newWarrantyIdRules" />
    <PromptOp class="dtv.pos.warranty.info.PromptAcceptWarrantyCustomerOp" /> <!-- BZ33586: reverted to base -->
    <Op class="caw.pos.warranty.info.CawAcceptWarrantyCustomerOp"/> <!-- BZ33586: new class to handle 32142 -->
    <Op class="dtv.pos.framework.op.DoNothingOp">
      <Parameter name="RESPONSE" value="COMPLETE" />
    </Op>
  </OpChain>
  <!-- END BZ32142 -->

  <!-- BEGIN BZ33231 -->
  <OpChain name="CAW_PROCESS_CATALYST_0">
    <Op class="caw.pos.advance.prompting.CawProcessCatalystBeginOp" longRunning="true"/>
    <OpChainRoute chainKey="CAW_PROCESS_CATALYST_MESSAGE_INPUT" />
    <Op class="caw.pos.advance.prompting.CawProcessCatalystIsCallBackOp" longRunning="true"/>
  </OpChain>
  <!-- END BZ33231 -->
  
  <!-- Begin BZ33894 --> 
  <OpChain name="EMAIL_RECEIPTS">
    <Op class="dtv.pos.email.receipt.EmailAddressPromptOp" />
    <Op class="caw.pos.email.receipt.CawUpdateCustomerEmailAddressOp" />
    <OpChainRoute chainKey="SALE_COMPLETE" />
  </OpChain>
  <!-- End BZ33894 -->
  
  <!-- Begin BZ34226  -->
  <!-- This chain handles adding the attached items using the standard add item logic with the attached item in scope -->
  <!-- Start Sale Item Finish section -->
  <!-- Start Sale Item Sub-section -->
  <OpChain name="SALE_ITEM_VALIDATE">
    <OpChainRoute chainKey="SALE_ITEM_VALIDATE.local.pre" />
    <OpChainRoute chainKey="SALE_ITEM_VALIDATE.pre" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" validationsBean="itemDescriptionRules" />
    <PromptOp class="caw.pos.register.CawPromptItemQuantityOp" validationsBean="saleItemQuantityRules" />
    <ValidationOp class="dtv.pos.register.ValidateItemQtyWithoutPromptQtyOp" validationsBean="saleItemQtyNoPromptRules" />
    <Op class="dtv.pos.kits.CreateKitOp" />
    <Op class="dtv.pos.inventory.op.InventoryLocationWhileOp">
      <Parameter name="ChainKey" value="SALE_ALLOCATE_QUANTITY" />
    </Op>
    <Op class="dtv.pos.register.modifyitem.UpdateChangedQuantityOp" />
    <PromptOp class="caw.pos.register.CawPromptItemSerialNumberOp" validationsBean="serialNumberSaleRules" />
    <Op class="dtv.pos.register.KitComponentIteratingOp">
      <Parameter name="ChainKey" value="KIT_COMPONENT_SERIAL_NUMBER" />
    </Op>
    <PromptOp class="caw.pos.register.CawItemPropertyPromptOp" validationsBean="itemPromptPropertyRules" />
    <PromptOp class="caw.pos.register.CawPromptItemPriceOp" validationsBean="itemPriceRules" />
    <OpChainRoute chainKey="SALE_ITEM_VALIDATE.post" />
  </OpChain>
  
  <OpChain name="SALE_ITEM_ADD">
    <Op class="dtv.pos.register.AddItemToSaleTranOp" />
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <WorkerOp workersBean="addTransDiscountsToNewItemWorkers" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp" />
    <OpChainRoute chainKey="SALE_TAXING" />
    <OpChainRoute chainKey="DISPLAY_INFO_TAB_MESSAGE" />
    <Op class="dtv.pos.register.itemmessages.DisplayItemMessagesOp" />
    <PromptOp class="caw.pos.register.attacheditems.CawPromptAttachedItemsOp" /> <!-- BZ34226 -->
    <Op class="dtv.pos.register.attacheditems.AttachedItemsIteratingOp">
      <Parameter name="chainKey" value="SALE_ITEM_AFTER_LOOKUP" />
    </Op>
    <OpChainRoute chainKey="NOTIFY_ATTACHED_ITEMS" />
    <Op class="dtv.pos.common.PersistTranInProcessOp" />
  </OpChain>
  
  <OpChain name="SALE_NON_PHYSICAL_VALIDATE">
    <OpChainRoute chainKey="SALE_NON_PHYSICAL_VALIDATE_START.local" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" validationsBean="itemDescriptionRules" />
    <PromptOp class="dtv.pos.register.PromptItemSerialNumberOp" validationsBean="serialNumberSaleExcludingInventoryRules" />
    <PromptOp class="caw.pos.register.CawItemPropertyPromptOp" validationsBean="itemPromptPropertyRules" /> <!-- BZ34226 -->
    <PromptOp class="dtv.pos.register.PromptItemQuantityOp" validationsBean="saleItemQuantityRules" />
    <ValidationOp class="dtv.pos.register.ValidateItemQtyWithoutPromptQtyOp" validationsBean="saleItemQtyNoPromptRules" />
    <PromptOp class="caw.pos.register.CawPromptItemPriceOp" validationsBean="itemPriceRules" /> <!-- BZ34226 -->
    <OpChainRoute chainKey="SALE_NON_PHYSICAL_VALIDATE_FINISH.local" />
  </OpChain>
  <!-- End BZ34226 -->

  <!-- BEGIN BZ35053 -->
  <OpChain name="SALE_VOUCHER_START" signal="TransactionModified">
    <Op class="dtv.pos.register.nonphysical.GatherVoucherSaleItemInfoOp">
      <Parameter name="VoucherActivityCodeType" value="ISSUED" />
    </Op>
    <PromptOp class="caw.pos.register.nonphysical.CawPromptSaleSelectVoucherItemOp" />
    <ValidationOp validationsBean="voucherTypeItemRules" />
    <OpChainRoute chainKey="SALE_VOUCHER_FINISH.pre" />
  </OpChain>
  <!-- END BZ35053 -->

  <!-- BEGIN BZ35549 -->
  <OpChain name="REPRINT_PREPARE_RECEIPTS">
    <Op class="caw.pos.register.reprint.CawGetReprintRcptsOp" />
  </OpChain>
  <!-- END BZ35549 -->
  
  <OpChain name="ORDER_CUST_ASSOCIATION" signal="TransactionModified">
    <Op class="caw.pos.customer.CawCustomerSearchOp" required="true" breakpoint="true"> <!-- BZ37061 -->
      <!-- the CustomerSearchOp MUST be the first in the CUST_ASSOCIATION chain
        so that it can see card swipe events that trigger this chain -->
      <Parameter name="RESULTS_PROMPT" value="CAW.CUSTOMER_LIST_REGISTER" /> <!-- BZ37061 -->
      <Parameter name="PrimaryOnly" value="true" />
      <Parameter name="AddCustomerChain" value="ADD_NEW_CUST_ASSOC" />
      <Parameter name="EditCustomerChain" value="CUST_ASSOCIATION_EDIT" />
    </Op>
    
    <!-- BEGIN PATCH 18: Comment out the OpChainRoute -->
    <!-- 
    <OpChainRoute>
      <Choice chainKey="CAW_ADDRESS_VALIDATION" condition="caw.pos.address.search.CawAddressValidationCondition" />
    </OpChainRoute>
     -->
    <!-- END PATCH 18: Comment out the OpChainRoute -->
    
    <OpChainRoute chainKey="CUSTOMER.REVIEW_INFORMATION_CONSENT" />
    <Op class="dtv.pos.customer.EnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="firstName" />
      <Parameter name="RequiredField" value="lastName" />
      <Parameter name="RequiredField" value="address1" />
      <Parameter name="RequiredField" value="city" />
      <Parameter name="RequiredField" value="state" />
      <Parameter name="RequiredField" value="postalCode" />
      <Parameter name="RequiredField" value="country" />
    </Op>
    <OpChainRoute chainKey="CUST_ASSOCIATION.pre" />
    
    <Op class="caw.pos.customer.CawAddCustToTransactionOp" />
    
    <ValidationOp validationsBean="attachCustomerToSaleRules" />
    <Op class="dtv.pos.customer.AddCustToTransactionOp" />
    <!--  <OpChainRoute chainKey="CUST_ASSOCIATION.LOYALTY" /> -->  <!--  BZ37340  --> 
    <Op class="dtv.pos.pricing.discount.ValidateDiscountsOnCustomerChangeOp" />
    <Op class="dtv.pos.register.layaway.account.DelinquentLayawaySearchOp" />
    <Op class="dtv.pos.register.specorder.account.ReceivedSpecOrderSearchOp" />
    <Op class="dtv.pos.workorder.account.WorkOrderRequiresAttentionOp" />
    <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
    <OpChainRoute chainKey="CUST_ASSOCIATION.post" />
    
    <!-- BEGIN BZ37548 -->
    <!-- <OpChainRoute chainKey="CAW_CARD_SERVICE_SUBMIT" />
    <OpChainRoute chainKey="CAW_PROCESS_CATALYST_CUSTOMER_IDENTIFIED" /> BZ61159 remove this opponent-->
    <Op class="caw.pos.customer.CawDisplayCustomerVerificationOp"/>
    <!-- END BZ37548 -->
    
  </OpChain>
  
  <OpChain name="ORDER_ADD_ITEM" signal="TransactionModified" contextKey="ORDER" rollbackChainKey="ORDER_MAINTENANCE_REGISTER_FINISH" rollbackLevel="30">
    <PromptOp class="caw.pos.order.CawPromptOrderItemScanOp" breakpoint="true" />  <!-- BZ-38378 -->
    <!-- Begin BZ37110 -->
    <ValidationOp class="dtv.pos.coupon.LookupCouponFromItemIdOp" validationsBean="couponVerificationRules" />
    <Op class="dtv.pos.document.bounceback.op.LookupBounceBackCouponOp" />
    <!-- End BZ37110 -->
    <ValidationOp class="dtv.pos.order.CheckItemNotOnFileOp" validationsBean="itemNotOnFileRules" />
    <ValidationOp validationsBean="sellingIdGroupRules" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM_AFTER_LOOKUP" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM_POST" />
  </OpChain>
  
  <!-- Begin BZ37058 -->
  <OpChain name="ORDER_CAW_MANAGE_LOGIN" contextKey="ORDER_CAW_MANAGE_LOGIN_CW">
    <Op class="dtv.pos.common.op.PromptLoginIfNeededOp">
        <Parameter name="FailedPromptKey" value="TILL_MANAGEMENT_LOGIN_FAILED" />
        <Parameter name="UserIdPromptKey" value="LOGIN_USER_ID_ESC" />
        <Parameter name="PrivilegeType" value="CAW_ORDERS_MANAGERMENT" />
    </Op>
    <OpChainRoute chainKey="VALIDATE_REGISTER_STARTUP_REGISTER_OPTION" />
    <PromptOp class="dtv.pos.payroll.op.PromptPayrollNotYetPostMsgOp" />
    <OpChainRoute chainKey="ORDER_CAW_OPTIONS_MAIN_MENU" chainType="START" />
  </OpChain>
  <OpChain name="ORDER_CAW_OPTIONS_MAIN_MENU" contextKey="ORDER_CAW_OPTIONS_MAIN_MENU" rollbackLevel="10">
    <Op class="dtv.pos.security.op.StartAutoLogoutTimerOp" />
    <Op class="dtv.pos.framework.op.ForceMenuSelectionOp" contextKey="ORDER_CAW_OPTIONS_MAIN_MENU" />
  </OpChain>
  <!-- End BZ37058 -->

  <OpChain name="SET_ORDER_DEPOSIT_AMOUNT">
    <PromptOp class="dtv.pos.order.PromptDepositAmountOp" validationsBean="orderDepositRules" />
    <!--  BEGIN BZ37179 -->
    <Op class="caw.pos.order.CawUpdateDepositInfoOp" />
    <!-- END BZ37179 -->
  </OpChain>
   
  <OpChain name="ORDER_CANCEL_ORDER">
    <PromptOp class="dtv.pos.order.PromptFulfillingLocationListOp" />
    <PromptOp class="dtv.pos.order.PromptCancellableItemListOp" validationsBean="orderCancelSelectedItemsRules" />
    <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="ORDER_CONFIRM_CANCEL" />
    <PromptOp class="dtv.pos.order.PromptCancelOrderReasonOp" />
    <Op class="dtv.pos.order.CancelOrderOp" />
    <!-- BEGIN BZ37467 -->
    <Op class="caw.pos.order.CawAddOrderRefundOp" />
    <!-- END BZ37467 -->
    <OpChainRoute chainKey="ORDER_MAINTENANCE_REGISTER_FINISH" chainType="START" />
  </OpChain>
 
  <OpChain name="ORDER_NEW_ORDER" rollbackChainKey="BACKTO_SALE_ITEM" contextKey="ORDER">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp">
      <Parameter name="CHAIN_KEY" value="ORDER_CUST_ASSOCIATION" />
    </Op>
    <Op class="dtv.pos.customer.EnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="firstName" />
      <Parameter name="RequiredField" value="lastName" />
      <Parameter name="RequiredField" value="address1" />
      <Parameter name="RequiredField" value="city" />
      <Parameter name="RequiredField" value="state" />
      <Parameter name="RequiredField" value="postalCode" />
      <Parameter name="RequiredField" value="country" />
    </Op>
    <PromptOp class="dtv.pos.order.PromptOrderTypeOp" />
    <!-- BEGIN BZ37109 -->
    <Op class="caw.pos.order.CawPromptDeliveryInfoOp" breakpoint="true" />
    <!-- END BZ37109 -->
    
    <!-- BEGIN BZ38158 -->
    <Op class="caw.pos.customer.CawEnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="emailAddress" />
    </Op>
    <!-- END BZ38158 -->
    
    <Op class="dtv.pos.order.SetupRegisterOrderMaintenanceOp" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM" chainType="START" />
  </OpChain>
  
  <OpChain name="ORDER_EDIT_DELIVERY_INFO">
    <!-- BEGIN BZ37109 -->
    <Op class="caw.pos.order.CawPromptDeliveryInfoOp" breakpoint="true" />
    <!-- END BZ37109 -->
    <Op class="dtv.pos.order.ChangeDeliveryTaxOp" />
    <Op class="dtv.pos.order.UpdateShippingFeeOp" />
  </OpChain>
  
  <!-- BEGIN BZ37023 -->
  <OpChain name="ORDER_ADD_ITEM_AFTER_LOOKUP" signal="TransactionModified">
    <Op class="dtv.pos.common.PromptStyleLookupOp" />
    <ValidationOp class="dtv.pos.order.ValidateOrderItemsOp" validationsBean="itemAvailableForOrderRules" />
    <ValidationOp class="dtv.pos.order.ValidateOrderItemsOp" validationsBean="orderItemRules" />
    <Op class="dtv.pos.order.CreateOrderSaleLineOp" />
    <Op class="caw.pos.register.CawAddSaleLineItemPropertyOp" /><!-- BZ44528 -->
    <Op class="caw.pos.register.CawRetrieveUpcLineItemOp" /> <!-- BZ38070 -->
    <PromptOp class="dtv.pos.register.MinimumAgeValidationOp" />
    <PromptOp class="dtv.pos.order.PromptOrderItemQuantityOp" validationsBean="orderItemQuantityRules" />
    <Op class="dtv.pos.register.modifyitem.UpdateChangedQuantityOp" />
    <PromptOp class="dtv.pos.register.sale.PromptForItemWeightOp" />
    <PromptOp class="dtv.pos.register.ItemPropertyPromptOp" validationsBean="itemPromptPropertyRules" />
    <PromptOp class="dtv.pos.register.PromptItemDescriptionOp" />
    <PromptOp class="dtv.pos.register.PromptItemPriceOp" />
    <!-- BEGIN BZ44528 -->
    <PromptOp class="caw.pos.item.CawWonderSignConfirmExistedItemOp" key="CAW_CONFIRM_EXISTED_SALE_ITEM" >
        <Parameter name="ConfirmItemType" value="ORDER" />
    </PromptOp>
    <!-- END BZ44528 -->
    <PromptOp class="dtv.pos.order.ConfirmOrderOnHandItemOp" key="ORDER_CONFIRM_ON_HAND_ITEM" />
    <Op class="caw.pos.order.CawLocateItemOp" longRunning="true"><!-- BZ44528 -->
      <Parameter name="ShowListIfOne" value="false" />
    </Op>
    <PromptOp class="dtv.pos.order.PromptConfirmLocationAvailabilityOp" />
    <Op class="dtv.pos.order.CreateOrderLineOp" />
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />
    <Op class="dtv.pos.commission.RouteItemCommissionAssociationOp"/>
    <Op class="dtv.pos.order.CalculateOrderLineTaxOp" />
    <Op class="dtv.pos.order.AddLineToOrderOp" />
  </OpChain>
  <!-- END BZ37023 -->
  
  <!-- BEGIN BZ37382 -->
  <OpChain name="CAW_ORDER_BROKER_PROMPT_SIGNATURE_CAPTURE">
    <PromptOp class="caw.pos.register.CawOrderBrokerSignatureCapturePromptOp" />
  </OpChain>
  <!-- END BZ37382 -->
  
  <OpChain name="PRINT_PICK_SLIP_CHAIN">
    <PromptOp class="dtv.pos.reporting.PromptRunReportOp" />
    <Op class="caw.pos.order.maint.CawCheckForAcceptedOrdersOp" longRunning="true" /> <!-- BZ37750 -->
    <Op class="dtv.pos.reporting.LoadReportOp">
      <Parameter name="reportName" value="PICK_SLIP_REPORT" />
    </Op>
    <Op class="dtv.pos.order.SetPickListReportDataSource" />
    <Op class="dtv.pos.order.FillAndPrintPickSlipReportOp" />
    <OpChainRoute chainKey="ORDER_WORKLIST" chainType="START" />
  </OpChain>

  <!-- BEGIN BZ37753 -->
  <OpChain name="ADD_CUSTOMER_ADDRESS">
    <Op class="caw.pos.customer.CawPromptCustomerAddAddressOp" breakpoint="true"/>
  </OpChain>
  
  <OpChain name="EDIT_CUSTOMER_ADDRESS">
    <Op class="caw.pos.customer.CawPromptCustomerEditAddressOp" breakpoint="true"/>
  </OpChain>
  <!-- END BZ37753 -->
  
  <!-- BEGIN BZ38070 -->
  <OpChain name="ORDER_PICKUP_ITEMS" signal="TransactionModified">
    <PromptOp class="dtv.pos.order.PromptItemsToPickupOp" validationsBean="orderCancelSelectedItemsRules" />
    <Op class="dtv.pos.order.OrderPickupItemIteratingOp">
      <Parameter name="ChainKey" value="ORDER_PICKUP_ITEM_SERIAL_NUMBER" />
    </Op>

    <Op class="caw.pos.register.CawRetrieveUpcLineItemOp" />
    <!-- BEGIN PATCH 16: BZ46879-->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--<Op class="dtv.pos.order.ProcessItemsToPickupOp" />-->
    <!-- End block need to delete when apply patch 16  -->
    
    <!-- BEGIN BZ46743 -->
    <Op class="caw.pos.order.CawProcessVinItemsToPickupOp" breakpoint="true" />
    <!-- END BZ46743 -->
    
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.CawProcessItemsToPickupOp" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16 -->
    <Op class="dtv.pos.order.AddAccountCreditOp" />
    <Op class="dtv.pos.order.ApplyPickupPaymentOp" />
  </OpChain>
  <!-- END BZ38070 -->

  <!-- BEGIN BZ37912 -->
  <OpChain name="ORDER_PRE_TENDERING" signal="TransactionModified">     
    <Op class="dtv.pos.order.DetermineAnyChangesMadeOp" />
    <OpChainRoute chainKey="CAW_SETUP_SHIPPING_METHODS" condition="caw.pos.order.CawOrderValidationCondition"/><!-- BZ45877 -->
    <OpChainRoute chainKey="CAW_CALCULATE_ORDER_DELIVERY_TAX" />
    <OpChainRoute chainKey="SET_ORDER_DEPOSIT_AMOUNT" />
    <Op class="dtv.pos.register.UpdateCurrentTransListOp" />
    <OpChainRoute chainKey="PRE_TENDERING" chainType="START" />
  </OpChain>

  <OpChain name="CAW_SETUP_SHIPPING_METHODS" signal="TransactionModified">
    <Op class="caw.pos.order.CawGetListGroupShippingMethodOp" />
    <Op class="caw.pos.order.CawSetupShipMethodsEachGroupOp" />
    <Op class="caw.pos.order.CawUpdateShippingFeeOp" />
  </OpChain>
  <OpChain name="CAW_ORDER_EBS_OFFLINE" signal="TransactionModified">
    <Op class="caw.pos.order.CawRemovedAllOrderItemsOp" />
  </OpChain> 

  <OpChain name="CAW_PROMPT_SHIPPING_METHODS" signal="TransactionModified">
    <Op class="caw.pos.order.CawPromptShipMethodsEachGroupOp" />
  </OpChain>
  
  <OpChain name="ORDER_CHANGE_ITEM_QUANTITY_IMPL">
    <PromptOp class="dtv.pos.order.PromptItemQuantityChangeOp" validationsBean="orderItemQuantityRules" />
    <Op class="caw.pos.order.CawLocateItemChangeQuantityOp" longRunning="true"><!-- BZ45962 -->
        <Parameter name="ShowListIfOne" value="false" />
    </Op>  
    <Op class="dtv.pos.order.UpdateItemLocationOp" />
    <Op class="dtv.pos.register.modifyitem.UpdateChangedQuantityOp" />
    <Op class="dtv.pos.order.UpdateSetupFeesOp" />
    <Op class="caw.pos.order.CawUpdateShippingFeeOp" />    
  </OpChain>
  
  <OpChain name="ORDER_SETUP_SHIPPING_FEE_UPDATE">
    <Op class="dtv.pos.order.UpdateSetupFeesOp" />
    <Op class="dtv.pos.order.ClearOrderItemOp" />
  </OpChain>
  <!-- END BZ37912 -->
  
  <OpChain name="SALE_COMPLETE_FINISH.order.2">
    <OpChainRoute chainKey="CAW_UPDATE_ORDER_DELIVERY_TAX" /> <!-- BZ37396 -->
    <Op class="caw.pos.order.CawSubmitOrderOp" longRunning="true" /><!-- BZ44528 -->
    <Op class="dtv.pos.order.UpdateFulfilledItemsOp" longRunning="true" />
    <Op class="caw.pos.order.CawUpdateCancelledOrderOp" longRunning="true" />
  </OpChain>
  
   <!-- BEGIN BZ44528: Phase 1 -->
  <OpChain name="PRE_CAW_WONDER_SIGN_CHAIN" contextKey="ORDER">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp" />
    <OpChainRoute chainKey="CAW_WONDER_SIGN_CHAIN" chainType="START" />
  </OpChain>
  <OpChain name="CAW_WONDER_SIGN_CHAIN" contextKey="ORDER">
    <Op class="caw.pos.wondersign.op.CawWonderSignSearchFormOp" breakpoint="true" />
    <Op class="caw.pos.wondersign.op.CawWonderSignCartResultPromptOp" breakpoint="true" />
    <Op class="caw.pos.wondersign.op.CawWonderSignCheckItemPromptOp" />
    <Op class="caw.pos.wondersign.op.CawWonderSignCartDetailPromptOp" breakpoint="true"/>
    <OpChainRoute chainKey="CAW_WONDER_SIGN_NEW_ORDER"/><!-- BZ44528 split patch 14-->
  </OpChain>
  <!-- BEGIN BZ44528: Phase 1 -->
  
  <!-- BEGIN BZ38384 -->
  <OpChain name="ORDER_MAINTENANCE_REGISTER_FINISH" signal="TransactionModified">
    <Op class="caw.pos.order.CawValidateShipMethodHasNotChangedOp" /> <!-- BZ-38384 -->
    <OpChainRoute chainKey="CAW_CALCULATE_ORDER_DELIVERY_TAX" /> <!-- BZ38471 -->
    <Op class="dtv.pos.order.DetermineAnyChangesMadeOp" />
    <OpChainRoute chainKey="SET_ORDER_DEPOSIT_AMOUNT" />
    <OpChainRoute chainKey="BACKTO_SALE_ITEM" chainType="START" />
  </OpChain>
  <!-- END BZ38384 -->
  
  <!-- BEGIN BZ38471,BZ37396 -->
  <OpChain name="CAW_CALCULATE_ORDER_DELIVERY_TAX">
    <Op class="caw.pos.order.CawCalculatetTaxViaTaxAPIOp" />
  </OpChain>
  <OpChain name="CAW_UPDATE_ORDER_DELIVERY_TAX">
    <Op class="caw.pos.order.CawUpdateTaxViaTaxAPIOp" />
  </OpChain>
  <!-- END BZ38471,BZ37396 -->
  
  <!-- Begin BZ-38845 -->
  <OpChain name="CUST_ASSOCIATION.pre">
    <Op class="caw.pos.card.services.CawClearCardServiceVariablesOp" />
  </OpChain>
  
  <OpChain name="ORDER_ACCEPT_ORDER" signal="TransactionComplete">
    <ValidationOp validationsBean="acceptOrderRules" />
    <!-- BEGIN PATCH 16: BZ46798 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--<Op class="dtv.pos.order.maint.ValidateStatusHasNotChangedOp" />-->
    <!-- End block need to delete when apply patch 16  -->
    
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawValidateStatusHasNotChangedOp" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ46798 -->
    
    <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="ORDER_CONFIRM_ACCEPT" />
    
    <!-- BEGIN PATCH 16: BZ42307-->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--
    <Op class="dtv.pos.order.maint.UpdateOrderStatusOp">
      <Parameter name="NewStatus" value="ACCEPTED" />
      <Parameter name="Operation" value="ACCEPT_ORDER" />
    </Op>
    -->
    <!-- End block need to delete when apply patch 16  -->
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawUpdateOrderStatusOp">
      <Parameter name="NewStatus" value="ACCEPTED" />
      <Parameter name="Operation" value="ACCEPT_ORDER" />
    </Op>
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16 -->
    <Op class="caw.pos.order.maint.CawCreateStatusUpdateTransactionOp" /> <!-- BZ40776 -->
    <Op class="dtv.pos.order.maint.AddPickTicketReceiptSourceOp" />
    <Op class="dtv.pos.common.PersistCurrentTransactionOp" />
    <OpChainRoute chainKey="PRINT_RECEIPTS" />
    <Op class="dtv.pos.order.maint.PromptOrderAcceptInstructionsOp" />
  </OpChain>
  
  <OpChain name="ORDER_REJECT_ORDER" signal="TransactionComplete">
    <!-- BEGIN PATCH 16: BZ42307 -->
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <ValidationOp validationsBean="rejectOrderLinesValidationRules" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ42307 -->
    
    <!-- BEGIN PATCH 16: BZ46798 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--<Op class="dtv.pos.order.maint.ValidateStatusHasNotChangedOp" />-->
    <!-- End block need to delete when apply patch 16  -->
    
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawValidateStatusHasNotChangedOp" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ46798 -->
    
    <!-- BEGIN PATCH 16: BZ42307 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--
    <PromptOp class="dtv.pos.order.maint.PromptRejectOrderOp">
	   <Parameter name="PromptKey" value="ORDER_CONFIRM_REJECT" />
	</PromptOp>
	<PromptOp class="dtv.pos.order.maint.PromptRejectOrderReasonOp">
	   <Parameter name="ReasonTypeCode" value="ORDER_REJECT" />
	</PromptOp>
	<Op class="dtv.pos.order.maint.UpdateOrderStatusOp">
	   <Parameter name="NewStatus" value="REJECTED" />
	</Op>
	-->
	<!-- End block need to delete when apply patch 16  -->
	
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->

    <PromptOp class="caw.pos.order.maint.CawPromptRejectOrderOp">
      <Parameter name="OrderPromptKey" value="ORDER_CONFIRM_REJECT" />
      <Parameter name="ItemPromptKey" value="ORDER_ITEMS_CONFIRM_REJECT" />
      <Parameter name="PromptQtyChainKey" value="PROMPT_REJECT_ITEM_QTYS" />
    </PromptOp>
    <PromptOp class="caw.pos.order.maint.CawPromptRejectOrderReasonOp">
      <Parameter name="ReasonTypeCode" value="ORDER_REJECT" />
    </PromptOp>
    <Op class="caw.pos.order.maint.CawUpdateOrderStatusOp">
      <Parameter name="NewStatus" value="REJECTED" />
    </Op>

    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END BZ42307 -->
    <Op class="caw.pos.order.maint.CawCreateStatusUpdateTransactionOp" /> <!-- BZ40776 -->
    <Op class="dtv.pos.common.PersistCurrentTransactionOp" />
    <OpChainRoute chainKey="ORDER_REJECT_RESERVED_ORDER" condition="dtv.pos.order.maint.PreviousOrderLineReserved" />
    <WorkerOp workersBean="closeOrderShippingDocumentWorkers" />
  </OpChain>
  
  <OpChain name="ORDER_RESERVE_ORDER" signal="InventoryOperationsComplete,TransactionComplete" >
     <!-- BEGIN PATCH 16: BZ46798 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--<Op class="dtv.pos.order.maint.ValidateStatusHasNotChangedOp" />-->
    <!-- End block need to delete when apply patch 16  -->
    
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawValidateStatusHasNotChangedOp" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ46798 -->
    
    <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="ORDER_CONFIRM_RESERVE" />
    <!-- BEGIN PATCH 16: BZ42307 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--
    <Op class="dtv.pos.order.maint.UpdateOrderStatusOp">
      <Parameter name="NewStatus" value="RESERVED" />
    </Op> 
    -->
    <!-- End block need to delete when apply patch 16  -->
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawUpdateOrderStatusOp">
      <Parameter name="NewStatus" value="RESERVED" />
    </Op>
     <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ42307 -->
    <Op class="caw.pos.order.maint.CawCreateStatusUpdateTransactionOp" /> <!-- BZ40776 -->
    <Op class="dtv.pos.common.PersistCurrentTransactionOp" />
    <OpChainRoute chainKey="ORDER_RESERVE_ORDER_INVENTORY" />
    <PromptOp class="dtv.pos.order.maint.PromptOrderReserveInstructionsOp" />
    <WorkerOp workersBean="sendReservedOrderEmailWorkers" />
  </OpChain>
  
  <OpChain name="ORDER_UNRESERVE_ORDER" signal="InventoryOperationsComplete,TransactionComplete">
    <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="ORDER_CONFIRM_UNRESERVE" />
    <!-- BEGIN PATCH 16: BZ42307 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--
     <Op class="dtv.pos.order.maint.UpdateOrderStatusOp">
      <Parameter name="NewStatus" value="ACCEPTED" />
      <Parameter name="Operation" value="UNRESERVE_ORDER" />
    </Op>
    -->
    <!-- End block need to delete when apply patch 16  -->
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawUpdateOrderStatusOp">
      <Parameter name="NewStatus" value="ACCEPTED" />
      <Parameter name="Operation" value="UNRESERVE_ORDER" />
    </Op>
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ42307 -->
    <Op class="caw.pos.order.maint.CawCreateStatusUpdateTransactionOp" /> <!-- BZ40776 -->
    <Op class="dtv.pos.common.PersistCurrentTransactionOp" />
    <OpChainRoute chainKey="ORDER_UNRESERVE_ORDER_INVENTORY" />
  </OpChain>
  
  <OpChain name="ORDER_ALLOCATE_ITEMS" signal="InventoryOperationsComplete,TransactionComplete" >
    <!-- BEGIN PATCH 16: BZ46798 -->
    <!-- Begin block need to delete when apply patch 16  -->
    <!--<Op class="dtv.pos.order.maint.ValidateStatusHasNotChangedOp" />-->
    <!-- End block need to delete when apply patch 16  -->
    <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <Op class="caw.pos.order.maint.CawValidateStatusHasNotChangedOp" />
    <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
    <!-- END PATCH 16: BZ46798 -->
    <PromptOp class="dtv.pos.framework.op.PromptYesNoOp" key="ORDER_CONFIRM_ALLOCATE_ITEMS" />
    <Op class="dtv.pos.order.maint.AllocateOrderOp" />
    <Op class="caw.pos.order.maint.CawCreateStatusUpdateTransactionOp" /> <!-- BZ40776 -->
    <WorkerOp workersBean="sendAllocatedOrderEmailWorkers" />
    <Op class="dtv.pos.common.PersistCurrentTransactionOp" />
    <OpChainRoute chainKey="ORDER_ALLOCATE_ITEMS_INVENTORY" />
  </OpChain>
  <!-- End BZ-38845 -->
  <!-- BEGIN BZ41379 -->
  <OpChain name="ORDER_MAINTENANCE_REGISTER_SETUP" contextKey="ORDER" rollbackChainKey="BACKTO_SALE_ITEM">
    <Op class="caw.pos.order.maint.CawCheckForMixedOrdersOp" />
    <Op class="dtv.pos.order.OrderSearchRegisterOp" />
    <Op class="dtv.pos.order.SetupRegisterOrderMaintenanceOp" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM" chainType="START" />
  </OpChain>
  <OpChain name="TAX_TRAN_EXEMPT" signal="TransactionModified">
    <ValidationOp validationsBean="cawTransTaxRules" />
    <Op class="dtv.pos.register.tax.op.SetTaxExemptScope" />
    <Op class="dtv.pos.register.tax.PromptSelectTranTaxOp" />
    <OpChainRoute chainKey="REQUIRED_CUSTOMER_ASSOCIATION" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxExemptionOp" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxExemptReasonOp" breakpoint="true" />
    <Op class="dtv.pos.register.tax.ChangeTranTaxToExemptOp" />
  </OpChain>
  <OpChain name="TAX_TRAN_CHANGE_LOCATION" signal="TransactionModified">
    <ValidationOp validationsBean="cawTransTaxRules" />
    <PromptOp class="dtv.pos.register.tax.PromptPostalCodeOp" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxLocationOp" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxChangeReasonOp" />
    <Op class="dtv.pos.register.tax.ChangeTransTaxGroupRuleOp" />
  </OpChain>
  <OpChain name="TAX_TRAN_CHANGE_AMOUNT" signal="TransactionModified">
    <ValidationOp validationsBean="cawTransTaxRules" />
    <Op class="dtv.pos.register.tax.PromptSelectTranTaxOp" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxAmountOp" validationsBean="taxAmountRules" />
    <PromptOp class="dtv.pos.register.tax.PromptTaxChangeReasonOp" />
    <Op class="dtv.pos.register.tax.ChangeTaxAmountOp" />
  </OpChain>
  <OpChain name="TAX_TRAN_CHANGE_PERCENT" signal="TransactionModified">
    <ValidationOp validationsBean="validateItemsTranChangeTaxRate" />
    <Op class="dtv.pos.register.tax.PromptSelectTranTaxOp" />
    <OpChainRoute chainKey="TAX_CHANGE_PERCENT"/>
    <Op class="dtv.pos.register.tax.ChangeTaxPercentOp" />
  </OpChain>
  <!-- END BZ41379 -->
  
  <OpChain name="VERIFIED_RETURN" signal="TransactionModified" contextKey="VERIFIED_RETURN" rollbackChainKey="BACK_RETURN_ORIG_INFO" rollbackLevel="40">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="DISPLAY_RETURN_INFO_TAB_MESSAGE" />
    <Op class="dtv.pos.kits.returns.UpdateAllKitsComponentsQtyForReturnOp" />
    <Op class="dtv.pos.register.returns.verification.SetOriginalTransactionListUponEntryOp" />
    <!-- BEGIN BZ46111 -->
    <PromptOp class="caw.pos.register.returns.verification.CawWonderSignPromptVerifiedReturnItemScanOp" validationsBean="itemIdRules" contextKey="VERIFIED_RETURN" breakpoint="true" />
    <!-- END BZ46111 -->
    <Op class="dtv.pos.register.returns.verification.SetReturnItemTypeOp"/>
    <Op class="dtv.pos.register.sale.CheckStyleLookupOp">
      <Parameter name="SaleItemType" value="SALE" />
    </Op>
    <Op class="dtv.pos.register.returns.verification.ValidateReturnVerificationItemScanOp" />
    <PromptOp class="caw.pos.register.returns.CawDeferFinancialValidationOp" >
      <Parameter name="TransType" value="RETURN" />
    </PromptOp> <!-- BZ33319 -->
    <PromptOp class="dtv.pos.register.returns.verification.PromptVerifiedReturnReasonCodeOp" />
    <!-- Begin to merge: In order to avoid duplicate Chain name='VERIFIED RETURN' -->
    <PromptOp class="caw.pos.register.returns.CawPromptVerifiedReturnReasonCodeOp" /> <!-- BZ23710 -->
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /> <!-- BZ32710 -->
     <!-- Begin to merge: In order to avoid duplicate Chain name='VERIFIED RETURN' -->
    <Op class="dtv.pos.register.returns.verification.VerifiedReturnIteratingOp">
      <Parameter name="ChainKey" value="VERIFIED_RETURN_ITEM_IMPL.pre" />
    </Op>
    <OpChainRoute chainKey="VALIDATE_WO_DEPOSIT" condition="caw.pos.workorder.condition.CawWorkOrderReturnSearchRunCondition"/> <!-- BZ63225 -->
  </OpChain>
  
  <!-- BEGIN BZ41809 -->
  <OpChain name="UNVERIFIED_RETURN" signal="TransactionModified" contextKey="RETURN" rollbackChainKey="BACK_RETURN_ORIG_INFO" rollbackLevel="30">
    <OpChainRoute chainKey="DISPLAY_RETURN_INFO_TAB_MESSAGE" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnItemScanOp" validationsBean="itemIdRules" breakpoint="true" />
    <Op class="dtv.pos.register.returns.CheckReturnItemNotOnFileOp" />
    <PromptOp class="caw.pos.register.returns.CawDeferFinancialValidationOp">
      <Parameter name="TransType" value="RETURN" />
    </PromptOp> <!-- BZ33319 -->
    <OpChainRoute chainKey="RETURN_UNVERIFIED_ITEM" />
  </OpChain>
  <!-- END BZ41809 -->
  <!-- BEGIN BZ42889 -->
  <OpChain name="CAW_RETURN_OMNI_REFUND" signal="TransactionModified" rollbackChainKey="BACKTO_SALE_ITEM">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderId" value="OMNI_REFUND" />
    </Op>
    <Op class="caw.pos.tender.CawAutoFillTenderAmtop"/>
    <!-- <Op class="dtv.pos.tender.PromptTenderAmtOp"/> -->
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!-- END BZ42889 -->
  
   <!-- BEGIN PATCH 14:BZ44528 -->
  <OpChain name="CAW_WONDER_SIGN_NEW_ORDER" rollbackChainKey="BACKTO_SALE_ITEM" contextKey="ORDER">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp">
      <Parameter name="CHAIN_KEY" value="ORDER_CUST_ASSOCIATION" />
    </Op>
    <Op class="dtv.pos.customer.EnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="firstName" />
      <Parameter name="RequiredField" value="lastName" />
      <Parameter name="RequiredField" value="address1" />
      <Parameter name="RequiredField" value="city" />
      <Parameter name="RequiredField" value="state" />
      <Parameter name="RequiredField" value="postalCode" />
      <Parameter name="RequiredField" value="country" />
    </Op>
    <PromptOp class="caw.pos.order.CawWonderSignPromptOrderTypeOp" />
    <!-- BEGIN BZ37109 -->
    <Op class="caw.pos.order.CawPromptDeliveryInfoOp" breakpoint="true" />
    <!-- END BZ37109 -->
    
    <!-- BEGIN BZ38158 -->
    <Op class="caw.pos.customer.CawEnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="emailAddress" />
    </Op>
    <!-- END BZ38158 -->
    
    <Op class="dtv.pos.order.SetupRegisterOrderMaintenanceOp" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM" chainType="START" />
  </OpChain>
 <!-- END PATCH 14:BZ44528-->
 
  
  <!-- BEGIN PATCH 15 -->
  <!-- BEGIN BZ44917 -->
  <!-- Begin block code for patch 15, it needs to be uncomment when applying patch 15 -->
  <OpChain name="CAW_RV_PAYMENT_SEARCH">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp" />
    <Op class="caw.pos.register.rvpayment.CawRvPaymentSearchOp" breakpoint="true"/>
    <Op class="caw.pos.register.rvpayment.CawRvPaymentSearchListOp" breakpoint="true"/>
    <Op class="caw.pos.register.rvpayment.CawRvPaymentViewDetail" />
    <OpChainRoute chainKey="SALE_ITEM_START" chainType="START" />
  </OpChain>
   <!-- End block code for patch 15, it needs to be uncomment when applying patch 15 -->
  <!-- END BZ44917 -->
  <!-- END PATCH 15 -->

  <!-- BEGIN PATCH 16: BZ42307 -->
  <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->

  <OpChain name="ORDER_MAINTENANCE" rollbackLevel="40" contextKey="ORDER">
    <Op class="caw.pos.order.maint.CawOrderMaintenanceOp" breakpoint="true"/>
  </OpChain>
  <OpChain name="PROMPT_REJECT_ITEM_QTYS">
    <Op class="caw.pos.order.maint.CawPartialUpdateOrderItemIteratingOp">
      <Parameter name="ChainKey" value="PROMPT_REJECT_ITEM_QTY" />
    </Op>
  </OpChain>
  <OpChain name="PROMPT_REJECT_ITEM_QTY">
    <Op class="caw.pos.order.maint.CawPromptPartialUpdateQuantityOp">
      <Parameter name="ActionKey" value="Reject" />
    </Op>
  </OpChain>

  <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
  
  <!-- BEGIN BZ42307, BZ37467 - Partial Cancel -->
  <!-- Begin block code for patch 16, it needs to be uncomment when applying patch 16 -->
 
  <OpChain name="ORDER_CANCEL_ORDER">
    <PromptOp class="dtv.pos.order.PromptFulfillingLocationListOp" />
    <PromptOp class="dtv.pos.order.PromptCancellableItemListOp" validationsBean="orderCancelSelectedItemsRules" breakpoint="true"/>
    
    <PromptOp class="caw.pos.order.maint.CawPromptCancelOrderOp">
      <Parameter name="OrderPromptKey" value="ORDER_CONFIRM_CANCEL" />
      <Parameter name="ItemPromptKey" value="ORDER_ITEMS_CONFIRM_CANCEL" />
      <Parameter name="PromptQtyChainKey" value="PROMPT_CANCEL_ITEM_QTYS" />
    </PromptOp>
    
    <PromptOp class="dtv.pos.order.PromptCancelOrderReasonOp" />
    <Op class="caw.pos.order.CawCancelOrderOp" />
    <Op class="caw.pos.order.CawAddOrderRefundOp" />
    <OpChainRoute chainKey="ORDER_MAINTENANCE_REGISTER_FINISH" chainType="START" />
  </OpChain>
  
  <OpChain name="PROMPT_CANCEL_ITEM_QTYS">
    <Op class="caw.pos.order.maint.CawPartialUpdateOrderItemIteratingOp">
      <Parameter name="ChainKey" value="PROMPT_CANCEL_ITEM_QTY" />
    </Op>
  </OpChain>
  <OpChain name="PROMPT_CANCEL_ITEM_QTY">
    <Op class="caw.pos.order.maint.CawPromptCancelPartialUpdateQuantityOp" >
      <Parameter name="ActionKey" value="Cancel" />
    </Op>
  </OpChain>

  <!-- End block code for patch 16, it needs to be uncomment when applying patch 16 -->
  <!-- END BZ42307 - Partial Cancel -->
  
  <!-- END PATCH 16: BZ42307 -->
  
  <!-- BEGIN PATCH 18 -->
  <!-- BEGIN BZ42019 -->
  <OpChain name="CAW_ADDRESS_VALIDATION_NEURON_EAVS2">
  	<PromptOp class="caw.mailingaddress.CawMailingAddressCountryCheckPromptOp" />
  	<PromptOp class="caw.mailingaddress.CawFailureMailingAddressRemainPromptOp" />
  	<Op class="caw.mailingaddress.CawMailingAddressValidationOp" />
  	<PromptOp class="caw.emailaddress.CawFailureEmailAddressRemainPromptOp" />
  	<Op class="caw.emailaddress.CawEmailValidationOp" />
  </OpChain>
  <!-- END BZ42019 -->
  
  <!-- BEGIN BZ44528 split patch 14-->
  <OpChain name="CAW_WONDER_SIGN_NEW_ORDER" rollbackChainKey="BACKTO_SALE_ITEM" contextKey="ORDER">
    <Op class="dtv.pos.customer.EnsureCustomerAssignedOp">
      <Parameter name="CHAIN_KEY" value="ORDER_CUST_ASSOCIATION" />
    </Op>
    <Op class="dtv.pos.customer.EnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="firstName" />
      <Parameter name="RequiredField" value="lastName" />
      <Parameter name="RequiredField" value="address1" />
      <Parameter name="RequiredField" value="city" />
      <Parameter name="RequiredField" value="state" />
      <Parameter name="RequiredField" value="postalCode" />
      <Parameter name="RequiredField" value="country" />
    </Op>
    <PromptOp class="caw.pos.order.CawWonderSignPromptOrderTypeOp" />
    <!-- BEGIN BZ37109 -->
    <Op class="caw.pos.order.CawPromptDeliveryInfoOp" breakpoint="true" />
    <!-- END BZ37109 -->
    
    <!-- BEGIN BZ38158 -->
    <Op class="caw.pos.customer.CawEnsureExistingCustInfoPresentOp">
      <Parameter name="RequiredField" value="emailAddress" />
    </Op>
    <!-- END BZ38158 -->
    
    <Op class="dtv.pos.order.SetupRegisterOrderMaintenanceOp" />
    <OpChainRoute chainKey="ORDER_ADD_ITEM" chainType="START" />
  </OpChain>
 <!-- END BZ44528 split patch 14-->
 <!-- END PATCH 18 -->
 <!-- BEGIN BZ48179 -->
  <OpChain name="RETAIL_LOCATION_CLOSE" contextKey="RETAIL_LOCATION_CLOSE" signal="TransactionComplete">
    <Op class="dtv.pos.register.itemmessages.DefaultIdleMsgOp" />
    <ValidationOp validationsBean="closeRetailLocationRules" />
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.order.1" />
    <PromptOp class="dtv.pos.systemcycle.close.ValidateNotClockOutEmployeesOp" />
    <PromptOp class="dtv.pos.systemcycle.close.PromptToCloseStoreOp" />
    <PromptOp class="dtv.pos.payroll.op.PromptPayrollNotYetPostYesNoMsgOp" />
    <Op class="dtv.pos.systemcycle.close.ValidateWorkstationsClosedOp" />
    <Op class="dtv.pos.systemcycle.close.ValidateCashdrawersClosedOp" />
    <PromptOp class="dtv.pos.systemcycle.close.ValidateRollingCloseTillsReconciledOp" key="ROLLING_CLOSE_STORE_CLOSE_UNRECONCILED_TILLS" />
    <PromptOp class="dtv.pos.systemcycle.close.ValidateRollingCloseAllDaysEndedOp" key="ROLLING_CLOSE_STORE_CLOSE_DAYS_NOT_ENDED" />
    <PromptOp class="dtv.pos.register.suspendresume.PromptCancelSuspendTransOp" />
    <PromptOp class="dtv.pos.systemcycle.close.PromptCloseMessageOp" />
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.1" />
    <PromptOp class="dtv.pos.systemcycle.questions.PromptCycleQuestionsOp">
      <Parameter name="QuestionType" value="SYSTEM_CLOSE" />
    </PromptOp>
    <Op class="dtv.pos.systemcycle.close.CountStoreBankAtStoreClosingOp" />
    <PromptOp class="dtv.pos.systemcycle.questions.PromptCycleQuestionsOp">
      <Parameter name="QuestionType" value="SYSTEM_CLOSE_DEPOSIT_COMPLETE" />
    </PromptOp>
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.2" />
    <Op class="dtv.pos.systemcycle.close.DisplayFinalSystemCloseMsgOp" />
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" />
    <Op class="dtv.pos.register.suspendresume.CancelAllSuspendTransOp" />
    <Op class="dtv.pos.systemcycle.retaillocation.AutoCloseWorkstationOp" />
    <Op class="dtv.pos.systemcycle.close.AutoClockOutOp" />
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.order.2" />
    <Op class="dtv.pos.payroll.op.WritePayrollLogOp" longRunning="true" />
    <Op class="dtv.pos.systemcycle.close.ProcessPayrollOp" longRunning="true" />
    <Op class="dtv.pos.systemcycle.retaillocation.CreateStoreCloseTransactionOp" />
    <Op class="dtv.tenderauth.impl.xpay.XpayCloseBatchOp" longRunning="true" />
    <OpChainRoute chainKey="PRINT_RECEIPTS" />
    <Op class="dtv.pos.appmanagement.op.SendIpcMessageNotRollingCloseOp">
      <Parameter name="SERVICE" value="xstore" />
      <Parameter name="METHOD" value="BUSINESS_DATE_CHANGED" />
    </Op>
    <OpChainRoute chainKey="REPORT_RUN_CLOSE_GROUP" />
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.local" />
    <OpChainRoute chainKey="RETAIL_LOCATION_CLOSE.local.2" />
    <Op class="dtv.pos.systemcycle.close.ExitAppOnSystemCloseOp" />
    <!-- Clear current transaction when close store -->
    <Op class="caw.pos.common.CawClearCurrentTransactionScopeOp" />
    <OpChainRoute chainKey="RETURN_TO_LOGIN" />
  </OpChain>
  <!-- END BZ48179 -->
  <!-- BEGIN BZ48096 -->
  <OpChain name="BLIND_NON_PHYSICAL_RETURN">
	<Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="UNVERIFIED_NON_PHYSICAL_RETURN" />
  </OpChain>
  
  <OpChain name="UNVERIFIED_NON_PHYSICAL_RETURN">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="RETURN_NON_PHYSICAL_SELECT" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
    <Op class="dtv.pos.register.returns.verification.CompleteUnverifiedBlindReturnOp" />
    <OpChainRoute chainKey="RETURN_NON_PHYSICAL_FINISH" />
  </OpChain>
  
  <OpChain name="UNVERIFIED_VOUCHER_RETURN">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="RETURN_VOUCHER_VALIDATE.pre" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
    <Op class="dtv.pos.register.returns.verification.CompleteUnverifiedBlindReturnOp" />
    <OpChainRoute chainKey="RETURN_VOUCHER_FINISH" chainType="START" />
  </OpChain>
  
  <OpChain name="RETURN_WARRANTY_UNVERIFIED">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="NEW_WARRANTY_SETUP" />
    <PromptOp class="dtv.pos.warranty.info.PromptWarrantyNumberOp" validationsBean="nonNullWarrantyNumberRules" breakpoint="true" />
    <OpChainRoute chainKey="RETURN_WARRANTY_VALIDATE" />
    <Op class="dtv.pos.register.returns.PromptReturnCommAssocOp" />
    <Op class="dtv.pos.register.returns.verification.CompleteUnverifiedBlindReturnOp" />
    <OpChainRoute chainKey="RETURN_WARRANTY_FINISH" />
  </OpChain>
  
  <OpChain name="BLIND_RETURN" signal="TransactionModified" contextKey="RETURN" rollbackChainKey="NEW_RETURN_ROLLBACK" rollbackLevel="30">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="DISPLAY_RETURN_INFO_TAB_MESSAGE" />
    <OpChainRoute chainKey="BLIND_RETURN_VALIDATE.local" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnItemScanOp" validationsBean="itemIdRules" breakpoint="true" />
    <Op class="dtv.pos.register.returns.CheckReturnItemNotOnFileOp" />
    <OpChainRoute chainKey="RETURN_BLIND_ITEM" />
  </OpChain>
  
  <OpChain name="PRE_UNVERIFIED_RETURN" contextKey="RETURN">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <OpChainRoute chainKey="VALIDATE_RETURN_INFO" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnSecurityOp" />
    <PromptOp class="dtv.pos.register.returns.PromptReturnSendSaleOp" />
    <Op class="dtv.pos.register.returns.PromptReturnSendSaleDestinationOp" breakpoint="true" />
    <OpChainRoute chainKey="PRE_UNVERIFIED_RETURN.local" />
    <OpChainRoute chainKey="UNVERIFIED_RETURN" chainType="START" />
  </OpChain>
  
  <OpChain name="RETURN_ITEM_AUTHORIZE" rollbackChainKey="NEW_RETURN_ROLLBACK" rollbackLevel="30">
    <Op class="dtv.pos.common.op.DisablePromptActionsOp" /><!-- BZ48096 -->
    <Op class="dtv.pos.register.returns.PromptOrigReceiptInformationOp">
      <Parameter name="CREDIT_CARD" value="RETURN_BY_CREDIT_CARD" />
      <Parameter name="EXTERNAL_ORDER" value="RETURN_BY_ORDER" />
      <Parameter name="SERIALIZED_ITEM" value="RETURN_BY_SERIALIZED_ITEM" />
      <Parameter name="FISCAL_NUMBER" value="RETURN_BY_FISCAL_NUMBER" />
    </Op>
    <OpChainRoute chainKey="VERIFY_RETURN" />
  </OpChain>
  <!-- END BZ48096 -->
  
   <!-- BEGIN PATCH 19 -->
  <!-- BEGIN BZ46743 -->
  <OpChain name="CAW_VIN_VERIFY">
    <Op class="caw.pos.register.vin.CawPromptVinItemScanOp" />
  </OpChain>
  <!-- BEGIN BZ46743 -->
  
  <!-- BEGIN BZ47550 -->
  <OpChain name="GROUP_DISCOUNT" signal="TransactionModified">
    <ValidationOp validationsBean="itemInTransRules" />
    <PromptOp class="dtv.pos.pricing.discount.PromptForGroupDiscountItemsOp" validationsBean="groupItemSelectionDiscountRules" />
    <PromptOp class="caw.pos.pricing.discount.CawPromptDiscountReasonOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptForAmountPercentOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptDiscountThresholdExceededOp" />
    <Op class="dtv.pos.pricing.discount.ValidateDiscountCompatibilityOp" />
    <PromptOp class="dtv.pos.pricing.discount.PromptDiscountSerialNumberOp" validationsBean="nonNullSerialNumberRules" />
    <Op class="dtv.pos.pricing.discount.AddDiscountLineItemToTransactionOp" />
    <Op class="dtv.pos.pricing.discount.AddGroupDiscountPriceModifiersOp" />
    <Op class="dtv.pos.pricing.discount.PlayDiscountSoundOp" />
    <Op class="dtv.pos.pricing.discount.DisplayDiscountPromptOp" />
    <Op class="dtv.pos.sendsale.op.UpdateTransDiscSendSaleItemsOp" />
  </OpChain>
  <!-- END BZ47550 -->
  
  <!-- BEGIN BZ47123 -->
  <OpChain name="NO_SALE_MANUAL">
    <Op class="dtv.pos.nosale.PerformSilentManualNoSaleTransactionOp" />
    <PromptOp class="caw.pos.hardware.op.CawWaitForCashDrawerCloseOp" validationsBean="cashDrawerCloseRules" />
  </OpChain>
  <!-- END BZ47123 -->
  <!-- END PATCH 19 -->

  <!-- BEGIN BZ61330 -->
  <OpChain name="CAW_THIRD_PARTY_TENDER_AMOUNT_OP">
    <PromptOp class="caw.pos.araccount.CawPromptTenderAmtOp" validationsBean="tenderAmountThirdPartyRules" />
  </OpChain>
  <OpChain name="CAW_AR_ACCOUNT_TENDER_AMOUNT_OP">
    <PromptOp class="caw.pos.araccount.CawPromptTenderAmtOp" validationsBean="tenderAmountARAccountRules" />
  </OpChain>
  <OpChain name="REFUND_LOCAL_CURRENCY" signal="TransactionModified" contextKey="REFUND_TENDER_EMPTY_MENU_OPTION">
    <Op class="dtv.pos.tender.CreateTenderLineItemOp">
      <Parameter name="TenderStatus" value="Refund" />
      <Parameter name="TenderCategory" value="LOCAL_CURRENCY" />
    </Op>
    <PromptOp class="dtv.pos.tender.PromptCustAsscRequiredForTenderOp" />
    <Op class="dtv.pos.tender.check.PromptIdentityVerificationOp" />
    <PromptOp class="dtv.pos.tender.PromptTenderAmtOp" validationsBean="currencyTenderAmountRules" />
    <Op class="dtv.pos.tender.AddTenderToSaleTranOp" />
    <Op class="dtv.pos.tender.rounding.UpdateTransactionRoundedAmountOp" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <OpChain name="CHANGE_REFUND_TENDER_AMOUNT" signal="TransactionModified" contextKey="REFUND_TENDER_EMPTY_MENU_OPTION">
    <PromptOp class="dtv.pos.tender.modifytender.PromptTendersToChangeOp" />
    <PromptOp class="dtv.pos.tender.modifytender.PromptModifyTenderAmountOp" validationsBean="currencyTenderAmountModifyRules" />
    <WorkerOp workersBean="voidChangeTenderWorkers" />
    <OpChainRoute chainKey="CHECK_SALE_COMPLETE" chainType="START" />
  </OpChain>
  <!-- END BZ61330 -->

  <!-- BEGIN BZ61159 -->
  <OpChain name="CAW_AGIS_PITCHES_FORM" signal="TransactionModified" >
    <Op class="caw.pos.agis.op.CawAGISPitchesLoadDataOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesFormsOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesReloadForms" />
    <Op class="caw.pos.agis.op.CawAGISPitchesVoidAddedItemOp" />
    <OpChainRoute chainKey="CAW_AGIS_REVERT_PRICE" condition="caw.pos.agis.op.CawAGISVoidItemUpdateRunCondition"/><!-- BZ62148 -->
    <Op class="caw.pos.agis.op.CawAGISPitchesAddItemOp"/>
    <Op class="caw.pos.agis.op.CawAGISPitchesRemoveMembershipItemPitchesOp" /> <!-- BZ62216 -->
    <Op class="caw.pos.customer.CawRefreshCustMembershipOp" /> <!-- BZ62987 -->
  </OpChain>
  
  <OpChain name="CAW_AGIS_PITCHES_LAST_CHANCE">
    <PromptOp class="caw.pos.agis.op.CawAGISPitchesLastChancePromptOp"/>
  </OpChain>
  
  <OpChain name="CAW_AGIS_PITCHES_CASH_AND_CARRY">
    <PromptOp class="caw.pos.agis.op.CawAGISPitchesCashAndCarryPromptOp"/>
  </OpChain>
  
  <OpChain name="CAW_AGIS_MEMBERSHIP_ITEM_VALIDATION">
    <OpChainRoute chainKey="CAW_AGIS_REFRESH_CUSTOMER"/> <!-- BZ62924 -->
    <Op class="caw.pos.advance.prompting.CawAddItemToSaleTranOp" />  
    <!-- BEGIN BZ62142 -->
    <WorkerOp workersBean="addPriceChangeModifierToLineItemWorkers" />     
    <OpChainRoute chainKey="SIGNAL_TRANSACTION_MODIFIED" />
    <!-- END BZ62142 -->
    <OpChainRoute chainKey="SALE_TAXING" />
  </OpChain>
  <!-- END BZ61159 -->  
  
  <!-- BEGIN BZ62147 -->
  <OpChain name="CAW_AGIS_REFRESH_ITEM_PRICE">
    <PromptOp class="caw.pos.advance.prompting.CawNotificationAgisItemNotOnFilePromptOp" />
    <Op class="caw.pos.advance.prompting.CawProcessSaveJoinGoodSamOp"/> 
    <Op class="caw.pos.customer.CawRefreshCustMembershipOp"/><!-- BZ 24410 -->
    <OpChainRoute chainKey="CAW_REFRESH_ITEM_PRICE" />
  </OpChain>

  <!-- END BZ62147 -->

  <!-- BEGIN BZ62924 -->
  <OpChain name="CAW_AGIS_REFRESH_CUSTOMER">
    <Op class="caw.pos.advance.prompting.CawGoodSamClubPreCheckOp" />
    <Op class="caw.pos.agis.op.CawAGISProcessMembershipItemValidOp"/>
  </OpChain>
  <!-- END BZ62924 -->
  
  <!-- BEGIN BZ69574 -->
  <OpChain name="NOTIFICATION_MANUAL_JOIN_GSC">
    <PromptOp class="caw.pos.advance.prompting.CawNotificationManualJoinGSCPromptOp" />
  </OpChain>
  <!-- END BZ69574 -->
</OpChainSet>